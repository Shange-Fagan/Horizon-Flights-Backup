<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Horizon Flights</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="./js/favicon.ico" type="image/x-icon">
  <!-- Stylesheets and scripts will be included here -->
  <style>
  /* Global Styles */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  overflow: hidden;
  /*font-family: "Syne", sans-serif;*/
}

a, button, input, select, iframe {
  pointer-events: auto;
}

/* Info and Credits */
#info,
#credits {
  position: absolute;
  width: 100%;
  text-align: center;
  /*color: teal;*/
  color: rgba(255, 255, 255, 0.5);
  z-index: 22012;
}

#info {
  bottom: 3.75vh;
  font-size: 0.75rem;
}

#credits {
      bottom: 2vh;
      font-size: 0.75rem; /* Smaller, more discreet font size */
      /*color: rgba(0, 0, 0, 0.4);*/ /* Make the credits less prominent */
    }
 #credits a {
      color: #1e90ff;
      text-decoration: none;
    }

    #credits a:hover {
      text-decoration: underline;
    }
/* Tickers */
#dayTicker,
#nightTicker {
  display: block; /* Show day ticker by default */
      position: fixed;
      top: 0vh;
      color: teal;
      width: 100%;
	height: 60px;
      font-family: Monospace;
       text-align: center;
      z-index: 22011;
    
}
#topLeftLabel {
  position: fixed;
  top: 0;
  left: 0px;
  width: 225px;
  height: 45px;
  clip-path: polygon(0 0, 100% 0, 85% 100%, 0% 100%); /* Creates one slant going up across the right side */
  text-align: center;
  font-family: Arial, sans-serif;
  font-size: 18px;
  font-weight: bold;
  color: white; /* Optional: make it stand out */
  background-color: #00aaff; /* Airbnb's primary color */
  padding: 5px 10px;
  text-align: center;
  justify-items: center;
  justify-content: center;
  display: flex; /* Use flexbox */
  align-items: center;
  padding-right: 35px; /* Adjust the spacing on the left */
  padding-left: 0px; /* Adjust the spacing on the left */
  border-radius: 0px;
  z-index: 22012; /* Ensure it's above other content */
  /*box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* Optional: slight shadow for better visibility */
}
#topLeftLabel span {
  margin-left: 0px; /* Adjust the amount of space to the left */
}

	  #searchTicker{
  display: none; /* Show day ticker by default */
      position: fixed;
      top: 0vh;
      color: teal;
      width: 100%;
	height: 60px;
      font-family: Monospace;
       text-align: center;
      z-index: 22011;
    
}
#trivagoIframeContainer {
  display: none; /* Show day ticker by default */
      position: fixed;
      top: 0vh;
      color: teal;
      width: 100%;
	height: 60px;
      font-family: Monospace;
       text-align: center;
      z-index: 22011;
    
}
	  #mobileTicker {
  display: none; /* Show day ticker by default */
      position: fixed;
      top: 0vh;
      color: teal;
      width: 100%;
      font-family: Monospace;
       text-align: center;
      z-index: 22011;
    
}
	  /* Responsive Ticker for Mobile */
    /*@media (max-width: 768px) {
      #dayTicker, #nightTicker {
        font-size: 10px;
	width: 60px;
        height: 60px;
        top: 0;
      }
    }*/
	  @media (max-width: 768px) {
      #dayTicker, #nightTicker, #header, .theme-switch {
        display: none;
      }
    }
@media (max-width: 768px) {
      #mobileTicker {
        display: block;
      }
    }
	  @media (min-width: 768px) {
      #mobileTicker {
        display: none;
      }
		  @media (max-width: 768px) {
      #mobileTicker {
        font-size: 10px;
	width: 60px;
        height: 60px;
        top: 0;
      }
    }
    }
/* Marker Labels */
/*.marker-label {
  position: absolute;
  object-fit: contain;
  font-family: 'Space Mono', monospace;
  transition: opacity 0.3s;
  background: transparent;
  width: 142px;
  height: 186px;
  border: 4px solid rgb(0, 107, 63);
  border-radius: 10px;
  z-index: 10;
  margin: 0;
  padding: 0;
  display: none; /* Hidden by default */
/*}*/
    
 .marker-label * {
  /* Styles here could affect all child elements, including the iframe */
}
  .marker-label {
  /*width: 300px;
  height: 200px;
  background: white;
  border: 2px solid #006b3f;
  border-radius: 10px;*/
  position: absolute;
  max-width: 300px;
  /*top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);*/
  /*z-index: 10;*/
  display: none; /* Hidden by default */
  pointer-events: auto; /* Ensure pointer events are enabled */
  z-index: 22009; /* Make sure the label is above other elements */
  /*background-color: rgba(255, 255, 255, 0.9);*/ /* Optional background for better visibility */
  /*overflow: hidden;*/ /* Hide any content that overflows */
}
	  
.marker-label.active {
  display: block;
}

/*.marker-label .close-button {
  position: absolute;
  top: 25px;
  left: 20px;
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid lightgray;
  border-radius: 3px;
  color: white;
  font-size: 14px;
  font-weight: bold;
  opacity: 0.25;
  transition: opacity 0.3s;
  cursor: pointer;
  z-index: 11;
}*/
	  /*.marker-label .close-button {
  position: absolute;
  top: 4.5px;
  left: 15px;
  background: rgba(0, 0, 0, 0.5); /* Darker background for visibility */
  /*border: 1px solid lightgray;
  border-radius: 3px;
  color: white;
  font-size: 14px;
  font-weight: bold;
  padding: 5px; */ /* Increase padding for larger click area */
  /*cursor: pointer;
  z-index: 9999;
  opacity: 0.25;
  transition: opacity 0.3s;
}*/
	  /* Close Button Styles */
 /* .close-button {
  position: absolute;
  top: 5px;*/ /* Adjust as needed */ /*
  right: 50px;*/ /* Adjust to your desired position */
  /*background: rgba(0, 0, 0, 0.5);*/
 /* background: rgba(0, 0, 0, 0.0)
  border: none;*/
  /*border-radius: 3px;*/
  /*border-radius: 100px;*/
  /*color: white;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;*/
  /*opacity: 0.25;*/
 /* z-index: 20000;*/ /* Ensure the close button is always on top */
/*}*/
	  .close-button {
  position: absolute;
  top: 5px;
  right: 10px;
  padding: 10px;
  width: 40px;
  height: 40px;
  background-color: rgba(255, 255, 255, 0.5);
  color: rgba(106, 106, 117, 1);;
  font-size: 14px;
  font-weight: bold;
  border: none;
  border-radius: 3px;
  cursor: pointer;
  z-index: 22011; /* Ensure the close button is always on top */  /*display: flex;*/
  display: none;
  justify-content: center;
  align-items: center;
}

/*.close-button:hover {
  background: rgba(0, 0, 0, 0.8); /* Add a hover effect */
/*}*/

.marker-label iframe {
  width: 100%; /* Make iframe take full width */
  height: 329px; /* Adjust height as needed */
  border: none;
  display: block; /* Ensure iframe is a block element */
  /*z-index: 1;*/
}

.close-button:hover {
  opacity: 1;
  color: red; /* Optional color change on hover */
}

/*.marker-label .content {
  margin: 4px;
  width: calc(100% - 8px); // Adjust for margins 
  height: calc(100% - 8px);
}*/

.marker-label iframe {
  /*width: 100%;
  height: 100%;
  border: none;
  display: block;
  position: relative;*/
  /*z-index: 1;*/
  /*width: 100%; */ /* Make iframe take full width */
  /*height: 250px; */ /* Adjust height as needed */
  /*border: none; */ /* Remove iframe border */
  /*display: block;*/ /* Ensure it's a block element */
}
	  /*.marker-label iframe {
    width: 100%;
    height: 100%;
    border: none;
    display: block;
  }*/
    /* Button Style */
    #toggleButton {
      position: absolute;
      right: 15px;
      top: 201px;
      padding: 5px 7px;
      font-size: 12px;
      /*background-color: rgba(255, 255, 255, 0.2);*/
      /*border: 1px solid rgba(255, 255, 255, 0.25);*/
      /*border-radius: 8px;*/
      color: rgba(255, 255, 255, 0.75);
      z-index: 22011;
      cursor: pointer;
	    border: 0px solid #e0e0e0; /* Border similar to Airbnb */
       background-color: rgba(255, 255, 255, 0.15);
  border-radius: 25px; /* Rounded corners for inputs */
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border-radius: 0px 0px 0px 0px;
      width: 125px;
    }
    #addLightsbutton {
      position: absolute;
      right: 15px;
      top: 227px;
      padding: 4px 7px;
      font-size: 12px;
      /*background-color: rgba(255, 255, 255, 0.2);*/
      /*border: 1px solid rgba(255, 255, 255, 0.25);*/
      /*border-radius: 8px;*/
      color: rgba(255, 255, 255, 0.75);
      z-index: 22011;
      cursor: pointer;
	    border: 0px solid #e0e0e0; /* Border similar to Airbnb */
       background-color: rgba(255, 255, 255, 0.15);
  border-radius: 25px; /* Rounded corners for inputs */
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border-radius: 0px 0px 0px 0px;
      width: 125px;
    }
    #addLightsbutton3 {
      position: absolute;
      right: 15px;
      top: 251px;
      padding: 4px 7px;
      font-size: 12px;
      /*background-color: rgba(255, 255, 255, 0.2);*/
      /*border: 1px solid rgba(255, 255, 255, 0.25);*/
      /*border-radius: 8px;*/
      color: rgba(255, 255, 255, 0.75);
      z-index: 22011;
      cursor: pointer;
	    border: 0px solid #e0e0e0; /* Border similar to Airbnb */
       background-color: rgba(255, 255, 255, 0.15);
  border-radius: 25px; /* Rounded corners for inputs */
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border-radius: 0px 0px 0px 0px;
      width: 125px;
    }

    #addLightsbutton:hover {
      background-color: rgba(225, 225, 225, 0.35);
	    border-color: #00aaff; /* Red border on hover for consistency with Airbnb style */
    }
    #addLightsbutton3:hover {
      background-color: rgba(225, 225, 225, 0.35);
	    border-color: #00aaff; /* Red border on hover for consistency with Airbnb style */
    }
    #addLightsbutton2 {
      position: absolute;
      right: 15px;
      top: 299px;
      padding: 4px 7px;
      font-size: 12px;
      /*background-color: rgba(255, 255, 255, 0.2);*/
      /*border: 1px solid rgba(255, 255, 255, 0.25);*/
      /*border-radius: 8px;*/
      color: rgba(255, 255, 255, 0.75);
      z-index: 22011;
      cursor: pointer;
	    border: 0px solid #e0e0e0; /* Border similar to Airbnb */
       background-color: rgba(255, 255, 255, 0.15);
  border-radius: 25px; /* Rounded corners for inputs */
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border-radius: 0px 0px 0px 0px;
      width: 125px;
    }
    #toggleButton3 {
      position: absolute;
      right: 15px;
      top: 275px;
      padding: 4px 7px;
      font-size: 12px;
      /*background-color: rgba(255, 255, 255, 0.2);*/
      /*border: 1px solid rgba(255, 255, 255, 0.25);*/
      /*border-radius: 8px;*/
      color: rgba(255, 255, 255, 0.75);
      z-index: 22011;
      cursor: pointer;
	    border: 0px solid #e0e0e0; /* Border similar to Airbnb */
       background-color: rgba(255, 255, 255, 0.15);
  border-radius: 25px; /* Rounded corners for inputs */
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border-radius: 0px 0px 0px 0px;
      width: 125px;
    }
    #toggleButton3:hover {
      background-color: rgba(225, 225, 225, 0.35);
	    border-color: #00aaff; /* Red border on hover for consistency with Airbnb style */
    }
    #toggleButton4 {
      position: absolute;
      right: 15px;
      top: 323px;
      padding: 4px 7px;
      font-size: 12px;
      /*background-color: rgba(255, 255, 255, 0.2);*/
      /*border: 1px solid rgba(255, 255, 255, 0.25);*/
      /*border-radius: 8px;*/
      color: rgba(255, 255, 255, 0.75);
      z-index: 22011;
      cursor: pointer;
	    border: 0px solid #e0e0e0; /* Border similar to Airbnb */
       background-color: rgba(255, 255, 255, 0.15);
  border-radius: 25px; /* Rounded corners for inputs */
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border-radius: 0px 0px 0px 0px;
      width: 125px;
    }
    #toggleButton4:hover {
      background-color: rgba(225, 225, 225, 0.35);
	    border-color: #00aaff; /* Red border on hover for consistency with Airbnb style */
    }

    #addLightsbutton2:hover {
      background-color: rgba(225, 225, 225, 0.35);
	    border-color: #00aaff; /* Red border on hover for consistency with Airbnb style */
    }
    #toggleChristmastheme {
      position: absolute;
      right: 15px;
      top: 326px;
      height:25px;
      padding: 4px 7px;
      font-size: 12px;
      /*background-color: rgba(255, 255, 255, 0.2);*/
      /*border: 1px solid rgba(255, 255, 255, 0.25);*/
      /*border-radius: 8px;*/
      color: rgba(255, 255, 255, 0.75);
      z-index: 22011;
      cursor: pointer;
	    border: 0px solid #e0e0e0; /* Border similar to Airbnb */
       background-color: rgba(255, 255, 255, 0.15);
  border-radius: 25px; /* Rounded corners for inputs */
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border-radius: 0px 0px 12px 12px;
      width: 100px;
    }
    #cruisesBtn {
      position: absolute;
      right: 15px;
      top: 326px;
      height:25px;
      padding: 4px 7px;
      font-size: 12px;
      /*background-color: rgba(255, 255, 255, 0.2);*/
      /*border: 1px solid rgba(255, 255, 255, 0.25);*/
      /*border-radius: 8px;*/
      color: rgba(255, 255, 255, 0.75);
      z-index: 22011;
      cursor: pointer;
	    border: 0px solid #e0e0e0; /* Border similar to Airbnb */
       background-color: rgba(255, 255, 255, 0.15);
  border-radius: 25px; /* Rounded corners for inputs */
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border-radius: 0px 0px 12px 12px;
      width: 100px;
    }

    #toggleButton:hover {
      background-color: rgba(225, 225, 225, 0.35);
	    border-color: #00aaff; /* Red border on hover for consistency with Airbnb style */
    }
	  /* Airbnb-style Header */
 /* Airbnb-style Header */
/* Airbnb-style Header */
#header {
    position: fixed; /* Fixed to stay at the top while scrolling */
    top: 55px;
    left: 0;
    width: 100%;
    display: flex;
    justify-content: center; /* Center the header content */
    align-items: center;
    background-color: rgba(255, 255, 255, 0.15);
    padding: 9px 0px; /* Reduce padding for a cleaner, compact look */
    /*box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);*/ /* Light shadow for depth */
    z-index: 22011;
    align-items: center;
}

#header2 {
    position: fixed; /* Fixed to stay at the top while scrolling */
    top: 55px;
    left: 0;
    width: 100%;
    display: none;
    justify-content: center; /* Center the header content */
    align-items: center;
    background-color: rgba(255, 255, 255, 0.15);
    padding: 12px 0px; /* Reduce padding for a cleaner, compact look */
    /*box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);*/ /* Light shadow for depth */
    z-index: 22011;
}
#topLeftLabel img {
  width: 32px; /* Adjust size */
  vertical-align: middle; /* Align with text */
}

/* Inputs and dropdowns styling */
/* Styling for the input field (From) */
#from {
  font-size: 16px; /* Slightly smaller font size */
    padding: 10px 15px; /* Padding inside inputs */
    border: 0px solid #ddd; /* Light gray border */
    background-color: rgba(255, 255, 255, 0.15);
    border-radius: 50px; /* Fully rounded corners for inputs */
    border-radius: 25px 0px 0px 25px;
    position: relative;
    right: 136px;
    margin-right: 10px; /* Spacing between input fields */
    width: 222px; /* Slightly smaller width */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
	color: rgba(255, 255, 255, 0.75);
    width: 95px; /* Set width to auto */
    max-width: max-content; /* Ensure it adjusts based on the placeholder or content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
    white-space: nowrap; /* Prevent wrapping */
    cursor: default;
    /*border-right: 1px solid rgba(255, 255, 255, 0.5); /* Grey line on the left side */
  }
  #adults {
  font-size: 16px; /* Slightly smaller font size */
    padding: 10px 15px; /* Padding inside inputs */
    border: 0px solid #ddd; /* Light gray border */
    background-color: rgba(255, 255, 255, 0.15);
    border-radius: 50px; /* Fully rounded corners for inputs */
    margin-right: 14px; /* Spacing between input fields */
    width: 225px; /* Slightly smaller width */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
	color: rgba(255, 255, 255, 0.75);
    width: 85px; /* Set width to auto */
    max-width: max-content; /* Ensure it adjusts based on the placeholder or content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    white-space: nowrap; /* Prevent wrapping */
    cursor: default;
  }

  #no_of_children {
  font-size: 16px; /* Slightly smaller font size */
    padding: 10px 15px; /* Padding inside inputs */
    border: 0px solid #ddd; /* Light gray border */
    background-color: rgba(255, 255, 255, 0.15);
    border-radius: 50px; /* Fully rounded corners for inputs */
    margin-right: 10px; /* Spacing between input fields */
    width: 225px; /* Slightly smaller width */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
	color: rgba(255, 255, 255, 0.75);
    width: 85px; /* Set width to auto */
    max-width: max-content; /* Ensure it adjusts based on the placeholder or content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    white-space: nowrap; /* Prevent wrapping */
    cursor: default;
  }
/* Styling for other inputs (optional) */
#where {
  font-size: 16px; /* Slightly smaller font size */
    padding: 10px 15px; /* Padding inside inputs */
    position: relative;
    right: 146px;
    border: 0px solid #ddd; /* Light gray border */
    background-color: rgba(255, 255, 255, 0.15);
    border-radius: 50px; /* Fully rounded corners for inputs */
    border-radius: 0 25px 25px 0;
    margin-right: 10px; /* Spacing between input fields */
    width: 220px; /* Slightly smaller width */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
	color: rgba(255, 255, 255, 0.75);
    width: 75px; /* Set width to auto */
    max-width: max-content; /* Ensure it adjusts based on the placeholder or content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    white-space: nowrap; /* Prevent wrapping */
    cursor: default;
    /*border-left: 1px solid rgba(255, 255, 255, 0.5); /* Grey line on the left side */
  }
  #cruiseDestinations {
  font-size: 16px; /* Slightly smaller font size */
    padding: 10px 15px; /* Padding inside inputs */
    position: relative;
    right: 146px;
    top: 0px !important;
    border: 0px solid #ddd; /* Light gray border */
    background-color: rgba(255, 255, 255, 0.15);
    border-radius: 50px; /* Fully rounded corners for inputs */
    border-radius: 0 25px 25px 0;
    margin-right: 10px; /* Spacing between input fields */
    width: 220px; /* Slightly smaller width */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
	color: rgba(255, 255, 255, 0.75);
    width: 105px; /* Set width to auto */
    max-width: max-content; /* Ensure it adjusts based on the placeholder or content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    white-space: nowrap; /* Prevent wrapping */
    cursor: default;
    background: none;
background-color: rgba(255,255,255,0.15);
    /*border-left: 1px solid rgba(255, 255, 255, 0.5); /* Grey line on the left side */
  }
  /* Styling for other inputs (optional) */
#checkin {
  display: flex;
  font-size: 16px; /* Slightly smaller font size */
    padding: 10px 15px; /* Padding inside inputs */
    border: 0px solid #ddd; /* Light gray border */
    /*background-color: rgba(255, 255, 255, 0.15);*/
    border-radius: 50px; /* Fully rounded corners for inputs */
    margin-right: 14px; /* Spacing between input fields */
    /*width: 220px;*/ /* Slightly smaller width */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
	/*color: rgba(255, 255, 255, 0.75);*/
    width: 105px; /* Set width to auto */
    /*max-width: max-content;*/ /* Ensure it adjusts based on the placeholder or content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    white-space: nowrap; /* Prevent wrapping */
    cursor: default;
    align-items: center;
justify-content: space-between;
position: relative;
top: 10px;
  }
  #checkout {
    display: flex;
  font-size: 16px; /* Slightly smaller font size */
    padding: 10px 15px; /* Padding inside inputs */
    border: 0px solid #ddd; /* Light gray border */
    /*background-color: rgba(255, 255, 255, 0.15);*/
    border-radius: 50px; /* Fully rounded corners for inputs */
    margin-right: 14px; /* Spacing between input fields */
    /*width: 220px;*/ /* Slightly smaller width */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
	/*color: rgba(255, 255, 255, 0.75);*/
    width: 125px; /* Set width to auto */
    /*max-width: max-content;*/ /* Ensure it adjusts based on the placeholder or content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    white-space: nowrap; /* Prevent wrapping */
    cursor: default;
    align-items: center;
justify-content: space-between;
position: relative;
top: 10px;
  }
  /* Styling for other inputs (optional) */
#price_min, #price_max {
  font-size: 16px; /* Slightly smaller font size */
    padding: 10px 15px; /* Padding inside inputs */
    border: 0px solid #ddd; /* Light gray border */
    background-color: rgba(255, 255, 255, 0.15);
    border-radius: 50px; /* Fully rounded corners for inputs */
    margin-right: 14px; /* Spacing between input fields */
    width: 220px; /* Slightly smaller width */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
	color: rgba(255, 255, 255, 0.75);
    width: 70px; /* Set width to auto */
    max-width: max-content; /* Ensure it adjusts based on the placeholder or content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    white-space: nowrap; /* Prevent wrapping */
    cursor: default;
    right:0px;
    display: flex;
  }
#header input:focus, #header select:focus {
    outline: none;
      box-shadow: 0 0 9px rgb(255, 169, 21) /* Red outline for focus similar to Airbnb */
}
	  #header input:hover, #header select:hover {
      box-shadow: 0 0 9px rgb(255, 169, 21) /* Red outline for focus similar to Airbnb */
}

#header #cabinClassInput:hover, #header #cabinClassLabel:hover {
      box-shadow: 0 0 9px rgb(255, 169, 21) /* Red outline for focus similar to Airbnb */
}
#header button {
    justify-content: center; /* Center the header content */
}
    input:is([type="button"], [type="submit"], [type="reset"]), input[type="file"]::file-selector-button, button {
      align-items: center;
}
.languageSelect-btn {
  padding: px 3px;
  font-size: 16px;
  align-items: flex-start;
  color: rgba(225, 225, 225, 0.75);
  background-color: rgba(225, 225, 225, 0.0);
  border: 0px solid rgba(225, 225, 225, 0.75);
  border-radius: 50px;
  cursor: pointer;
}
#languageSelect {
  width: 124px;
  top: 75px;
  right: 26.3% !important;
  border-radius: 24px;
  height: 35px;
}

/* Button Styling */
#header .airbnb-button {
    background-color: #00aaff; /* Airbnb red color */
    border: none;
    padding: 10px 20px; /* Slightly smaller padding */
    border-radius: 50px; /* Fully rounded button */
    color: white;
    font-size: 16px;
    margin-left: 14px;
    cursor: pointer;
    transition: background-color 0.3s ease;
     transition: background-color 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 8px rgba(0, 115, 187, 0.4), 0 1px 3px rgba(0, 115, 187, 0.12); /* Initial shadow */
    cursor: default;
}
#searchBtn.airbnb-button22:hover {
    background-color: #007BFF; /* Blue background color */
    box-shadow: 0px 4px 10px rgba(0, 123, 255, 0.5); /* Blue box shadow */
    transition: all 0.3s ease; /* Smooth transition */
    animation: pulseShadow3 0.6s ease-in-out infinite alternate; /* Animation on hover */
}
#searchBtn.airbnb-button23:hover {
    background-color: #00CED1; /* Blue background color */
    box-shadow: 0px 4px 10px rgba(0, 123, 255, 0.5); /* Blue box shadow */
    transition: all 0.3s ease; /* Smooth transition */
    animation: pulseShadow3 0.6s ease-in-out infinite alternate; /* Animation on hover */
}


#header .airbnb-button2 {
  display: flex;
  width: 105px;
  margin-left: 17.9px;
  justify-content: center;
  align-items: center;
justify-content: center;
    background-color: #00aaff; /* Airbnb red color */
    border: none;
    padding: 8px 3px; /* Slightly smaller padding */
    border-radius: 50px; /* Fully rounded button */
    border-radius: 25px 0px 0px 25px;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s ease;
     transition: background-color 0.3s ease, box-shadow 0.3s ease;
     box-shadow: 0 4px 8px rgba(0, 115, 187, 0.4), 0 1px 3px rgba(0, 115, 187, 0.12); /* Initial shadow */
    cursor: default;
}
.airbnb-button2 img {
  display: flex;
  margin-left: 0px;
}

/* Dropdown container */
.dropdown {
  position: relative;
  display: inline-block;
}

/* Dropdown content (hidden by default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 150px;
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
  z-index: 1;
  border-radius: 8px;
  overflow: hidden;
}

/* Dropdown links */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-size: 14px;
}

/* Hover effect for links */
.dropdown-content a:hover {
  background-color: #f1f1f1;
}

/* Show the dropdown menu when the button is clicked */
.dropdown.show .dropdown-content {
  display: block;
}
#cabinClassContainer {
  display: none;
  align-items: center;
  justify-content: center;
}
#cabinClassLabel {
  font-size: 16px; /* Slightly smaller font size */
    padding: 10px 15px; /* Padding inside inputs */
    border: 0px solid #ddd; /* Light gray border */
    background-color: rgba(255, 255, 255, 0.15);
    border-radius: 50px; /* Fully rounded corners for inputs */
    margin-right: -10px; /* Spacing between input fields */
    width: 220px; /* Slightly smaller width */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
	color: rgba(255, 255, 255, 0.75);
    width: 83px; /* Set width to auto */
    max-width: max-content; /* Ensure it adjusts based on the placeholder or content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
    white-space: nowrap; /* Prevent wrapping */
    cursor: default;
    border-radius: 25px 0px 0px 25px;
    font-family: system-ui;
    margin-top: 2px;
}

#cabinClassInput {
  font-size: 16px; /* Slightly smaller font size */
    padding: 10px 15px; /* Padding inside inputs */
    border: 0px solid #ddd; /* Light gray border */
    background-color: rgba(255, 255, 255, 0.15);
    border-radius: 50px; /* Fully rounded corners for inputs */
    margin-right: 14px; /* Spacing between input fields */
    width: 220px; /* Slightly smaller width */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
	color: rgba(255, 255, 255, 0.75);
    width: 75px; /* Set width to auto */
    max-width: max-content; /* Ensure it adjusts based on the placeholder or content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    white-space: nowrap; /* Prevent wrapping */
    cursor: default;
    right:0px;
    margin-left: 10.5px;
    border-radius: 0px 25px 25px 0px;
    transition: opacity 0.3s ease, transform 0.3s ease;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
    margin-top: -13px;
    display: flex;
position: static;
}

#likedPostsButton {
  background-color: #00aaff; /* Airbnb red */
  border: none;
  margin-right: 25px;
  width: 40px;
  height: 40px;
  border-radius: 50%; /* Make it a circle */
  border-radius: 0 25px 25px 0;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 8px rgba(0, 115, 187, 0.4), 0 1px 3px rgba(0, 115, 187, 0.12); /* Initial shadow */
  cursor: pointer;
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
}
/* Slide up animation */
.slide-up {
  transform: translateY(-20px); /* Moves up */
  opacity: 0; /* Fades out */
}

/* Slide down animation */
.slide-down {
  transform: translateY(20px); /* Moves down */
  opacity: 0; /* Fades out */
}
#roomsPopup, #no_of_children, #adultsPopup  {
  font-size: 16px; /* Slightly smaller font size */
    padding: 10px 15px; /* Padding inside inputs */
    border: 0px solid #ddd; /* Light gray border */
    background-color: rgba(255, 255, 255, 0.15);
    border-radius: 50px; /* Fully rounded corners for inputs */
    margin-right: 10px; /* Spacing between input fields */
    width: 225px; /* Slightly smaller width */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
	color: rgba(255, 255, 255, 0.75);
    width: 85px; /* Set width to auto */
    max-width: max-content; /* Ensure it adjusts based on the placeholder or content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    white-space: nowrap; /* Prevent wrapping */
    cursor: default;
border: 1px solid #e0e0e0;
}

#likedPostsButton img {
  fill: white;
  align-items: center;
}
/* Popup styling */
.hidden {
  display: none;
}

.popup {
  position: fixed;
  top: 300px;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 500px;
  padding: 20px;
  color: rgba(225, 225, 225, 0.75);
  background: rgba(255, 255, 255, 0.15);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  border-radius: 25px;
  z-index: 1000;
}

.popup-content {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.guest-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.guest-row2 {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.popup-save-btn,
.popup-close-btn {
  margin-top: 10px;
  padding: 5px 10px;
  border: none;
  background-color: #00aaff;
  color: #ffffff;
  border-radius: 5px;
  cursor: pointer;
}
#loginContainer {
  background-color: rgba(255, 255, 255, 0.15);
}
#closeSignupButton {
  color: rgba(255, 255, 255, 1);
  top: 0px;
}
#closeButton2 {
  color: rgba(255, 255, 255, 1);
  top: 0px;
}
.popup-close-btn {
  background-color: #f44a69;
}

/* Guest selector button styling */
.guest-popup-btn {
  position: absolute;
  right: 7px;
  top: 6.5px;
  margin-left: 0px;
  padding: px 3px;
  padding-top: 1px;
  font-size: 16px;
  align-items: flex-start;
  color: rgba(225, 225, 225, 0.75);
  background-color: rgba(225, 225, 225, 0.0);
  border: 1.5px solid rgba(225, 225, 225, 0.75);
  border-radius: 50px;
  cursor: pointer;
}

#languageSelect {
  display: none;
  align-items: center;
  gap: 5px; /* Space between emoji and dropdown */
}

.globe-emoji {
  font-size: 18px; /* Adjust size if needed */
}



#header .airbnb-button:hover {
    background-color: #00aaff; /* Darker red on hover */
    box-shadow: 0 0 12px rgba(0, 115, 255, 0.8), 0 0 4px rgba(0, 115, 255, 0.5); /* Brighter, thinner, blue shadow */
    /*border: 2px solid rgba(0, 115, 255, 0.8);*/ /* Optional: Blue border to make it more pronounced */
animation: pulseShadow3 0.6s ease-in-out infinite alternate; /* Animation on hover */
}
header .airbnb-button22:hover {
    background-color: #00aaff !important;/* Darker red on hover */
    box-shadow: 0 0 12px rgba(0, 115, 255, 0.8), 0 0 4px rgba(0, 115, 255, 0.5); /* Brighter, thinner, blue shadow */
    /*border: 2px solid rgba(0, 115, 255, 0.8);*/ /* Optional: Blue border to make it more pronounced */
animation: pulseShadow3 0.6s ease-in-out infinite alternate; /* Animation on hover */
}
header .airbnb-button23:hover {
    background-color: #00CED1 !important;/* Darker red on hover */
    box-shadow: 0 0 12px rgba(0, 115, 255, 0.8), 0 0 4px rgba(0, 115, 255, 0.5); /* Brighter, thinner, blue shadow */
    /*border: 2px solid rgba(0, 115, 255, 0.8);*/ /* Optional: Blue border to make it more pronounced */
animation: pulseShadow3 0.6s ease-in-out infinite alternate; /* Animation on hover */
}
#header .airbnb-button2:hover {
    background-color: #00aaff; /* Darker red on hover */
    box-shadow: 0 0 12px rgba(0, 255, 38, 0.8), 0 0 4px rgba(0, 255, 21, 0.5); /* Brighter, thinner, blue shadow */
    /*border: 2px solid rgba(0, 115, 255, 0.8);*/ /* Optional: Blue border to make it more pronounced */
animation: pulseShadow3 0.6s ease-in-out infinite alternate; /* Animation on hover */
}
#likedPostsButton:hover {
  background-color: #00aaff; /* Darker red on hover */
  box-shadow: 0 0 12px rgba(255, 255, 255, 0.8), 0 0 4px rgba(255, 255, 255, 0.5); /* Brighter, thinner, blue shadow */
    /*border: 2px solid rgba(0, 115, 255, 0.8);*/ /* Optional: Blue border to make it more pronounced */
animation: pulseShadow3 0.6s ease-in-out infinite alternate; /* Animation on hover */
}
/* Keyframes for box shadow pulse animation */
@keyframes pulseShadow1 {
  0% {
        box-shadow: 0 0 12px rgba(8, 142, 209, 0.8), 0 0 4px rgba(22, 129, 223, 0.5);
    }
    100% {
      box-shadow: 0 0 12px rgb(0, 217, 255, 1), 0 0 4px rgba(5, 194, 232, 0.75); /* Brighter, thinner, blue shadow */
    }
}

@keyframes pulseShadow2 {
  0% {
        box-shadow: 0 0 7px rgb(0, 221, 255), 0 0 4px rgba(22, 200, 223, 0.5);
    }
    100% {
      box-shadow: 0 0 7px rgb(0, 217, 255, 1), 0 0 4px rgba(5, 194, 232, 0.75); /* Brighter, thinner, blue shadow */
    }
}
@keyframes pulseShadow3 {
  0% {
        box-shadow: 0 0 12px rgb(0, 242, 255), 0 0 4px rgba(22, 129, 223, 0.5);
    }
    100% {
      box-shadow: 0 0 12px rgb(0, 217, 255, 1), 0 0 4px rgba(5, 194, 232, 0.75); /* Brighter, thinner, blue shadow */
    }
}

/* Search section layout */
#header .search-section {
    display: flex;
    border-radius: 50px; /* Fully rounded container */
    padding: 10px 15px; /* Reduce padding */
    width: auto; /* Adjust width based on content */
    max-width: 100%; /* Ensure responsiveness */
    flex-wrap: wrap; /* Wrap content if it overflows */
	color: white;
	z-index: 22011; /* Ensure the entire search section is clickable */
}
	  
#header .logo {
    margin-right: auto; /* Push logo to the left */
    font-weight: bold;
    font-size: 24px; /* Slightly bigger logo text */
    color: #00aaff; /* Airbnb logo color */
}

/* Media Queries for Responsiveness */
@media (max-width: 768px) {
    #header {
        flex-direction: column;
        padding: 10px 0; /* Reduce padding for mobile */
    }

    #header input {
        width: 100%; /* Full width on mobile */
        margin-bottom: 10px;
    }

    #header button {
        width: 100%; /* Full width button on mobile */
    }

    #header .search-section {
        flex-direction: column; /* Stack inputs vertically */
        width: 100%;
        margin-top: 10px;
    }
}

/* Placeholder text styling */
#header input::placeholder {
    color: rgba(255, 255, 255, 0.75); /* Light gray placeholder text */
    font-size: 16px; /* Airbnb-style font size */
}
	  /* Styling for Specific Inputs */
input[type="text"]::placeholder,
input[type="date"]::placeholder {
  color: rgba(255, 255, 255, 0.75); /* Light gray placeholder for text and date inputs */
  opacity: 1; /* Ensure full opacity */
}

/* Date input custom styling */
/* Style the input[type="date"] */
input[type="date"] {
  appearance: none; /* Remove default appearance */
  -webkit-appearance: none; /* For Safari */
  padding: 10px;
  background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="rgba(255, 255, 255, 0.75)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>') no-repeat;
  background-position: right 10px center; /* Position the icon */
  background-size: 20px; /* Adjust the size of the icon */
  border: 1px solid #e0e0e0;
  color: rgba(255, 255, 255, 0.75); /* Text color */
  background-color: rgba(255, 255, 255, 0.15); /* Background */
  border-radius: 10px;
}
/* Red hover for date picker */
input[type="date"]:hover, input[type="date"]:focus {
    box-shadow: 0 0 8px rgba(255, 56, 92, 0.8); /* Red outline similar to Airbnb */
    outline: none;
}
input[type="date"]::-webkit-calendar-picker-indicator {
    opacity: 0; /* Hide the default calendar icon */
}
	  input[type="date" i] {
    font-family: monospace;
    padding-inline-start: 1px;
    cursor: default;
    padding: 0px;
    color: rgba(255, 255, 255, 0.75);
}/* Hide default number input arrows */
/* Hide default number input arrows */
input[type="number"]::-webkit-inner-spin-button, 
input[type="number"]::-webkit-outer-spin-button { 
    -webkit-appearance: none; 
    margin: 0; 
}
input[type="date"]::placeholder {
    color: rgba(255, 255, 255, 0.75);
}


/* Older browser support for placeholders */
#header input::-webkit-input-placeholder {
  color: rgba(255, 255, 255, 0.75);
}

#header input::-moz-placeholder {
  color: rgba(255, 255, 255, 0.75);
}

#header input:-ms-input-placeholder {
  color: rgba(255, 255, 255, 0.75);
}

#header input::-ms-input-placeholder {
  color: rgba(255, 255, 255, 0.75);
}

#header input::placeholder {
  color: rgba(255, 255, 255, 0.75);
}

/* Style number input */
input[type="number"] {
    background-color: rgba(255, 255, 255, 0.15); /* Match other inputs' background */
    color: rgba(255, 255, 255, 0.75); /* Text color */
    padding: 10px 15px;
    border: 1px solid #e0e0e0;
    border-radius: 50px; /* Same rounded corners */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Consistent box-shadow */
    width: 50px;
}



/* Custom increment/decrement buttons */
#header .number-input-container button {
    background-color: transparent;
    border: none;
    color: rgba(255, 255, 255, 0.75);
    font-size: 18px;
    cursor: pointer;
    padding: 0 10px;
    transition: color 0.3s ease;
}

#header .number-input-container button:hover {
    color: #00aaff; /* Airbnb red on hover */
}

#header .number-input-container button:focus {
    outline: none;
}



/*#regionPopup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: rgba(255, 255, 255, 0.15);
  padding: 20px;
  border-radius: 10px;
  z-index: 9999;*//* Ensure it appears above the globe */
 /* box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}*/
	  #regionPopup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  /*background-color: rgba(255, 255, 255, 0.85);*//* Increased opacity for readability */
  background-color: rgba(255, 255, 255, 0.15);
  padding: 45px 55px; /* Increase padding for more breathing space */
  border-radius: 15px; /* Slightly more rounded corners */
  z-index: 22012; /* Ensure it appears above all other elements */
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3); /* Deeper shadow for better separation */
  backdrop-filter: blur(10px); /* Apply background blur effect */
  text-align: center; /* Center the text and elements inside the popup */
  max-width: 400px; /* Limit the width for smaller screens */
  width: 100%;
}
#regionPopup h1, #regionPopup h2 {
  color: rgba(255, 255, 255, 0.75);
}
#regionPopup p {
/* color: #333; */
color: rgba(255, 255, 255, 0.75);
margin-bottom: 60px;
margin-top: -15px;
}

	#regionPopup select {
  font-size: 16px;
  padding: 10px;
  top: 120px;
  right: 30px;
  border-radius: 10px;
  border: 1px solid #e0e0e0;
  margin-bottom: 20px; /* Space between select and button */
  width: 82.5%; /* Adjust width to fit better within the container */
  margin-left: 10px; /* Center the select dropdown inside the popup */
  margin-right: 10px; /* Add equal padding to the right */
  box-sizing: border-box; /* Ensure padding and borders are included in the width */
  background-color: rgba(255, 255, 255, 0.15); /* Light background to improve look */
  appearance: none; /* Remove default select arrow styling for a custom look */
  -webkit-appearance: none; /* For WebKit browsers */
		display: block;
}
	  #regionPopup select:focus {
  outline: none; /* Remove the blue outline on focus */
}

#regionPopup select option {
  padding: 10px; /* Add padding to options */
}

#regionPopup button {
  background-color: #00aaff; /* Airbnb red */
  color: white;
  padding: 12px 25px;
  border-radius: 10px;
  border: 0px;
  font-size: 16px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

#regionPopup button:hover {
  background-color: #00aaff; /* Slightly darker red on hover */
}

	  #content {
  display: none;
  flex-direction: row;
}
/* Confirmation Message Styling */
#confirmationMessage {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
	color: rgba(255, 255, 255, 0.75);
  background-color: rgba(255, 255, 255, 0.15);
  padding: 30px;
  border-radius: 15px;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
  z-index: 22011;
  text-align: center;
  max-width: 400px;
  width: 100%;
}

#confirmationMessage h2 {
  color: rgba(255, 255, 255, 0.75);
  margin-bottom: 10px;
}
	  #confirmationMessage p {
  color: rgba(255, 255, 255, 0.75);
	font-family: 'Airbnb Cereal App', 'Helvetica Neue', 'Arial', sans-serif;
}

/* Region Select Button Styling */
/* Region Select Button Styling */
#regionSelectBtn {
  position: absolute;
  top: 175px; /* Adjusted top position under Cheapest button */
  right: 15px;
  padding: 5px 7px; /* Add more padding for a better look */
  border: 0px solid #e0e0e0; /* No visible border */
  border-radius: 25px;
  font-size: 12px; /* Slightly larger font for better readability */
  cursor: pointer;
  transition: background-color 0.3s ease;
  color: rgba(255, 255, 255, 0.75); /* Keep the light gray text color */
  background-color: rgba(255, 255, 255, 0.15); /* Transparent background with slight white tint */
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Shadow for depth */
  z-index: 22011;
  border-radius: 0px 0px 0px 0px;
  width: 125px;
}

#regionSelectBtn:hover {
  background-color: rgba(225, 225, 225, 0.35);
   border-color: #00aaff; /* Red border on hover for consistency with Airbnb style */
}
	  #regionSelectDropdown {
  padding: 4px;
  border-radius: 10px;
  border: 1px solid rgba(0, 0, 0, 0.1);
  background-color: rgba(255, 255, 255, 0.15);
  color: rgba(255, 255, 255, 0.75);
  font-size: 12px;
  width: 80px; /* Adjust width */
  position: absolute; /* Adjust positioning */
  top: 175px; /* Adjust based on your layout */
  right: 142px; /* Adjust based on your layout */
  z-index: 22011; /* Ensure it is visible above other elements */
  display: flex;
  background-position: right 8px;
background-position-x: 90.5%;
background-position-y: 10px;
background-size: 10px;
}
	  
#regionSelectDropdown:hover {
  background-color: rgba(245, 245, 245, 0.35);
}
	  #regionSelectBtn, #submitRegion {
  z-index:22011; /* Ensure these elements are interactive */
}

	  
/* Remove scrollbar from iframes */
iframe::-webkit-scrollbar {
  display: none;
}  #newsOverlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background:none;
    /*background-color: rgba(0, 0, 0, 0.8);*/
    /*display: flex;*/
    display: none;  
    justify-content: center;
    align-items: center;
    z-index: 22013; /* Ensure it's on top of everything */
  }
	  #newsOverlaynighttheme {
    position: absolute;
    top: 90px;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.3);
    /*background-color: rgba(0, 0, 0, 0.8);*/
    /*display: flex;*/
    display: none;  
    justify-content: center;
    align-items: center;
    z-index: 22013; /* Ensure it's on top of everything */
  }
  
  #newsIframe {
    width: 80%;
    height: 80%;
    /*background: rgba(255, 255, 255, 0.5);*/
    background: none;
    z-index: 1; /* Lower than the close button */
  }
	  #newsIframenighttheme {
    width: 80%;
    height: 80%;
    /*background: rgba(255, 255, 255, 0.5);*/
    background: none;
    z-index: 1; /* Lower than the close button */
  }

	  #newsButton {
    position: absolute;
      right: 15px;
      top: 323px;
      padding: 4.5px 7px;
      font-size: 12px;
      /*background-color: rgba(255, 255, 255, 0.2);*/
      /*border: 1px solid rgba(255, 255, 255, 0.25);*/
      /*border-radius: 8px;*/
      color: rgba(255, 255, 255, 0.75);
      z-index: 22012; /* Higher than the iframe */
      cursor: pointer;
	/*z-index: 9999;*/
     /*cursor: pointer;*/
	    border: 0px solid #e0e0e0; /* Border similar to Airbnb */
       background-color: rgba(255, 255, 255, 0.15);
  border-radius: 25px; /* Rounded corners for inputs */
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border-radius: 0px 0px 0px 0px;
      width: 125px;
}

#newsButton:hover {
  background-color: rgba(225, 225, 225, 0.35);
	border-color: #00aaff; /* Red border on hover for consistency with Airbnb style */

}
	  
	  #closeNewsButton {
  position: absolute;
  top: 139px;
  right: 310px;
  padding: 10px;
  width: 40px;
  height: 40px;
  background-color: rgba(255, 255, 255, 0.0);
  color: white;
  font-size: 24px;
  font-weight: bold;
  border: none;
  border-radius: 3px;
  cursor: pointer;
  z-index: 22014;
  /*display: flex;*/
  display: none;
  justify-content: center;
  align-items: center;
}

#closeNewsButton:hover {
  /*background-color: rgba(255, 255, 255, 0.2);*/ /* Optional hover effect */
  color: red; /* Optional color change on hover */
}
	  #loadingIcon {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 22011;
  width: 50px; /* Adjust as needed */
  height: 50px;
	display: none;
}
	  .loading-spinner {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 40px;
  height: 40px;
  border: 4px solid rgba(255, 255, 255, 0.3);
  border-top: 4px solid #fff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

	  #markerContainer {
  position: relative;
  display: inline-block; /* Ensures it wraps tightly around marker label */
}
	
	  /* Style the select dropdown */
/*select {
  position: absolute;
  left: 38px;
  top: 100px;
  padding: 4.5px 7.5px;
  font-size: 12px;*/
  /*background-color: rgba(255, 255, 255, 0.2);*/
 /*border: 1px solid rgba(255, 255, 255, 0.25);**/
 /*border-radius: 8px;*/
  /*color: rgba(255, 255, 255, 0.75);
  z-index: 9999;
  cursor: pointer;
  appearance: none;
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><polygon points="0,0 20,0 10,10" fill="rgba(255, 255, 255, 0.75)"/></svg>');
  background-repeat: no-repeat;
  background-position: right 25px center;
background-size: 10px; *//* Adjust this as needed */
/*overflow: hidden;*/
	/*z-index: 9999;*/
       /*cursor: pointer;*/
	  /*  border: 0px solid #e0e0e0;*/ /* Border similar to Airbnb */
      /* background-color: rgba(255, 255, 255, 0.15);
  border-radius: 25px; *//* Rounded corners for inputs */
	   /* box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}*/
	  select {
  position: absolute;
  right: 15px;
  top: 280px;
  padding: 4.5px 9.5px; /* Add padding for a better look */
  font-size: 12px; /* Increase the font size for better readability */
  color: rgba(255, 255, 255, 0.75); /* Keep the light gray text color */
  background-color: rgba(255, 255, 255, 0.15); /* Transparent background with slight white tint */
  border: 0px solid #e0e0e0; /* Add a border to separate the dropdown */
  border-radius: 25px; /* Rounded corners for the select box */
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Shadow for depth */
  appearance: none; /* Removes the default arrow */
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><polygon points="0,0 20,0 10,10" fill="rgba(255, 255, 255, 0.75)"/></svg>');
  background-repeat: no-repeat;
  background-position: right 15px; /* Moves the arrow 5px to the left */ /* Adjusted to move the arrow down */
  background-size: 15px; /* Adjust the size of the arrow */
  background-position-x: 97.5%;
  cursor: pointer;
  z-index: 22011;
}
div[id^="priceCategorySelect-"] select {
    position: absolute;
    right: 15px;
    top: 10px;
    padding: 4.5px 9.5px;
    font-size: 12px;
    color: rgba(255, 255, 255, 0.75);
    background-color: rgba(255, 255, 255, 0.15);
    border: 0;
    border-radius: 25px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    z-index: 22011;
}
div[id^="airbnbSelector-"] select {
    position: absolute;
    right: 15px;
    top: 10px;
    padding: 4.5px 9.5px;
    font-size: 12px;
    color: rgba(255, 255, 255, 0.75);
    background-color: rgba(255, 255, 255, 0.15);
    border: 0;
    border-radius: 25px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    z-index: 22011;
}
select[id^="airbnbSelector-"] {
    display: none;
    position: absolute;
    top: 350px !important;
    right: 30px !important;
}
select[id^="priceCategorySelect-"] {
    display: none;
    position: absolute;
    top: 380px !important;
    right: 30px !important;
}


	  #airbnbSelector {
      display: none;
  appearance: none; /* Remove default appearance */
  -webkit-appearance: none; /* For Safari */
  position: absolute;
  right: 15px;
  top: 320px;
  padding: 4.5px 9.5px; /* Add padding for a better look */
  font-size: 12px; /* Increase the font size for better readability */
  color: rgba(255, 255, 255, 0.75); /* Keep the light gray text color */
  background-color: rgba(255, 255, 255, 0.15); /* Transparent background with slight white tint */
  border: 0px solid #e0e0e0; /* Add a border to separate the dropdown */
  border-radius: 25px; /* Rounded corners for the select box */
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Shadow for depth */
  appearance: none; /* Removes the default arrow */
  background-size: 11px;
  background-position: right 15px;
  background-position-y: 69%;
  background-position-x: 97%;
  cursor: pointer;
  z-index: 22011;
  width: 198px;
}
	  /* Optional: Ensures the arrow is moved down without changing the default */
select::-ms-expand {
  display: none; /* Hide the arrow in IE/Edge */
}

select:hover {
  border-color: #00aaff; /* Red border on hover for consistency with Airbnb style */
	background-color: rgba(225, 225, 255, 0.35);
}
#airbnbSelector:hover {
  background-color: rgba(225, 225, 225, 0.35);
	border-color: #00aaff; /* Red border on hover for consistency with Airbnb style */

}

select:focus {
  border-color: #00aaff; /* Red border when focused */
  outline: none; /* Remove the default outline */
}

#priceCategorySelect {
  display: none;
  appearance: none; /* Remove default appearance */
  -webkit-appearance: none; /* For Safari */
  position: absolute;
  right: 15px;
  top: 280px;
  padding: 4.5px 9.5px; /* Add padding for a better look */
  font-size: 12px; /* Increase the font size for better readability */
  color: rgba(255, 255, 255, 0.75); /* Keep the light gray text color */
  background-color: rgba(255, 255, 255, 0.15); /* Transparent background with slight white tint */
  border: 0px solid #e0e0e0; /* Add a border to separate the dropdown */
  border-radius: 25px; /* Rounded corners for the select box */
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Shadow for depth */
  appearance: none; /* Removes the default arrow */
  background-size: 11px;
  background-position: right 15px;
  background-position-y: 69%;
  background-position-x: 95%;
  cursor: pointer;
  z-index: 22011;
  width: 133px;
}
#toggleAirbnbPrices {
  position: absolute;
  background-color: rgba(255, 255, 255, 0.0);
  top: 264px; /* Adjusted top position under Cheapest button */
  right: 15px;
  padding: 5px 7px; /* Add more padding for a better look */
  border: 0px solid rgba(255, 255, 255, 0.0); /* No visible border */
  border-radius: 25px;
  font-size: 12px; /* Slightly larger font for better readability */
  cursor: pointer;
  color: rgba(255, 255, 255, 1); /* Keep the light gray text color */
  z-index: 22012;
  
}
/* Style the dropdown options */
select option {
  background-color: white;
  color: #333;
}
#priceCategorySelect:hover {
  background-color: rgba(225, 225, 225, 0.35);
	border-color: #00aaff; /* Red border on hover for consistency with Airbnb style */

}
#clearFiltersBtn {
  position: absolute;
  z-index: 22011;
  display: block;
  /*margin-right: 10px;*/
  right: 15px;
  top:145px;
  padding: 7px 7px;
  background-color: #00aaff; /* Airbnb red */
  color: white;
  border: none;
  /*border-radius: 50px;*/
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
  width: 125px;
  font-size: 12px;
  border-radius: 12px 12px 0px 0px;
}

#clearFiltersBtn:hover {
  /*background-color: #e03a56;*/
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}
#languageSelect select {
  background-position: right 14px;
  background-position-x: 90.5%;
  background-position-y: 14.9px;
background-size: 10px;
}

#regionSelectDropdown select {
  background-position: right 42px;
  background-position-x: 90.5%;
  background-size: 14px;
}

	/* Responsive Design */
    @media (max-width: 768px) {
      /* Adjust the size and placement of the globe on mobile */
      #toggleButton {
        font-size: 10px;
        padding: 3px 7px;
        top: 55px;
      }
	    select {
    padding: 3px 7px;
    top: 75px;    
    font-size: 10px;
    background-color: rgba(255, 255, 255, 0.2);
overflow: hidden;    
  }
	    
	    #newsButton {
        font-size: 10px;
        padding: 3px 7px;
        top: 55px;
      }

      /*#dayTicker, #nightTicker {
        height: 60px;*/ /* Reduce height for mobile */
        /*font-size: 12px;
	width: 100vw;
      }*/
	    #mobileTicker {
        height: 85px; /* Reduce height for mobile */
        font-size: 12px;
	width: 100vw;
      }

      #credits {
        font-size: 0.6rem; /* Make credits even smaller on mobile */
      }
	    #info {
  font-size: 0.6rem;
}
	    footer {
      font-size: 0.4rem;
    }

      /* Adjust globe view on smaller devices by zooming out */
      body {
        overflow: hidden;
      }
}
	
	  /* Footer Styles */
    footer {
      position: fixed;
      bottom: 0;
      width: 100%;
      background-color: transparent;
      /*color: #fff;*/
      color: rgba(255, 255, 255, 0.5);
      text-align: center;
      padding: 5px 0;
      font-size: 0.6rem;
      z-index: 22012;
      /*font-size: 0.9rem;*/
      /*z-index: 9999;*/
    }

    footer a {
      color: #1e90ff;
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }
/* Responsive Footer for Mobile */
    @media (max-width: 768px) {
      footer {
        font-size: 0.4rem;
        padding: 2.5px 0;
      }
    }
/* Divide the screen into two sections */
#container {
  width: 100vw;
  height: 100vh;
	position: relative;
  z-index: 0;  /* Make sure the container is behind the globe-container */
	display: flex;  /* Use flexbox to manage layout */
}

/* Fullscreen globe when the page loads */
	  #globe-container {
  position: relative;  /* Set position to relative or absolute */
  width: 100%;
  height: 100%;
   display: block;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 22010;  /* Ensure it's in front of other elements if necessary */
		  float: right;
}

	  /* UI buttons that must be clickable over the globe */

/* Split the screen when the search button is clicked */
#globe-container.split {
  width: 50%;  /* Shrink to 50% width */
  height: 100vh;  /* Full height */
	
	  pointer-events: auto;  /* Allow interactions */
	float: right;
	position: relative;
}


/* Left container transition */

	/* Left container transition */
#left-container {
	height: 100vh;
    background-color: white;
    color: black;
    font-size: 16px;
    padding: 20px;
    display: none;  /* Hidden initially */
    width: 0;  /* Initially 0 width */
    position: relative;
    transition: width 0.5s ease;  /* Smooth transition for width */
    z-index: 22000;  /* Ensure it's in front of other elements if necessary */
	display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* This will ensure each item takes up equal space */
    gap: 15px; /* Add some spacing between the listings */
    padding: 20px;
    overflow-y: auto; /* Ensure it scrolls if the content overflows */

}	.close-btn {
    position: absolute;
    top: 10px;
    left: 20px; /* Move the button to the left */
    background-color: transparent;
    border: none;
    font-size: 20px;
    color: #000;
    cursor: pointer;
    display: none; /* Hidden initially */
    z-index: 22011; /* Ensure it's on top of other elements */
}

.close-btn:hover {
    color: #00aaff; /* Highlight on hover */
}  /* Style for each post */

/*#globeContainer {*/
  /*position: relative;  *//* Set position to relative or absolute */
  /*width: 100%;
  height: 100%;
  display: block !important;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 22011;*/  /* Ensure it's in front of other elements if necessary */
/*}*/
/*#globeContainer canvas {
  position: absolute;*/
  /*top: 0;
  left: 0;*/
  /*top: 0;
  left: 0;
  right: 0;
  bottom: 0;*/
  /*z-index: 22011;*/  /* Make sure the canvas is above any other elements */
	/*overflow: hidden;*/ /* Ensure the canvas doesnt overflow */
		  /*display: block;
      pointer-events: auto;
      touch-action: auto;
}*/
#globeContainer {
  /*position: relative;*/  /* Set position to relative or absolute */
  width: 100%;
  height: 100%;
   display: block;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 22011;  /* Ensure it's in front of other elements if necessary */
		  float: right;
}
	  #globeContainer canvas {
  /*position: relative;*/
  /*top: 0;
  left: 0;*/
  z-index: 22011;  /* Make sure the canvas is above any other elements */
	overflow: hidden; /* Ensure the canvas doesnt overflow */
		  display: block !important;
}
	  
	  #globeContainer {
    pointer-events: auto; /* Disable globe interactions */
}
	  #globeContainer.disable-interaction {
    pointer-events: none; /* Disable globe interactions */
}
/* Overlay container to hold posts, sits on the left side of the screen */
#overlayContainer {
  position: fixed;
  top: 146px;
  left: 15px;
  width: 46%; /* Adjust width as per your requirement */
  height: 75%;
  padding: 20px;
  border-radius: 15px;
  display: none;
  grid-template-columns: repeat(2, 1fr); /* Two equal columns */
  grid-auto-rows: minmax(300px, auto); /* Set a base row height with flexibility */
  transition: transform 0.3s ease, height 0.3s ease;
  gap: 50px; /* Space between the cards */
  background-color: rgba(255, 255, 255, 0.15); /* Slight transparency */
  overflow-y: auto; /* Enable scrolling if content overflows */
  z-index: 22012; /* On top of the globe container */
  box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3); /* Add shadow on the right side */
  /*box-sizing: border-box;*/
}
#overlayContainer2 {
  position: absolute;
  top: 146px;
  left: 15px;
  width: 49.5%; /* Adjust width as per your requirement */
  height: 79%;
  padding-top: 10px;
  padding-left: 22px;
  border-radius: 15px;
  display: none;
  grid-template-columns: repeat(1, 1fr); /* Two equal columns */
  grid-auto-rows: minmax(200px, auto); /* Set a base row height with flexibility */
  transition: transform 0.3s ease, height 0.3s ease;
  gap: 50px; /* Space between the cards */
  background-color: rgba(255, 255, 255, 0.15); /* Slight transparency */
  overflow-y: auto; /* Enable scrolling if content overflows */
  z-index: 22012; /* On top of the globe container */
  box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3); /* Add shadow on the right side */
  /*box-sizing: border-box;*/
}
#overlayContainer.minimized {
    height: 40px;
    transform: translateY(calc(100vh - 40px));
    cursor: pointer;
  }
  #overlayContainer2.minimized {
    height: 40px;
    transform: translateY(calc(100vh - 40px));
    cursor: pointer;
  }
  .drag-handle {
  width: 100%;
  height: 20px;
  cursor: grab;
  display: block;
  justify-content: center;
  align-items: center;
  background-color: rgba(0, 0, 0, 0.1); /* Make it visible */
  position: relative;
  top: 0;
}

.drag-handle .line {
  width: 40px;
  height: 4px;
  background-color: #ccc;
  margin: 2px 0;
  border-radius: 2px;
}
#dropdownMenu button:hover {
  background: #f0f0f0;
  cursor: pointer;
}

.menu-container {
  position: absolute;
  top: 10px;
  right: 10px;
}

#dropdownMenu {
  display: none;
  position: absolute;
  right: 0;
  background: white;
  border: 1px solid lightgray;
  border-radius: 5px;
  z-index: 1000;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}


/* Styling for individual posts */
/*.post {
  background-color: white;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* Card-like shadow */
  /*overflow: hidden;
  text-align: left; /* Align text to the left */
  /*padding: 10px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 100%; 
}

/* Image for each post */
/*
    .post img {
        width: 300px;
        height: 300px;
        object-fit: cover;
        border-radius: 15px;
    
  width: 100%;
  height: 100%;
  max-height: 200px; /* Control max height of the image */
  /*object-fit: cover; /* Ensure the image fits within the space */
  /*border-radius: 10px; /* Rounded top corners */
  /*margin-bottom: 10px; /* Space below the image */
/*}

/* Title and other text elements */
/*.post h3 {
  font-size: 1.1rem; /* Slightly larger title */
  /*margin: 10px 0;
}

.post p {
  color: #696767;
  font-size: 0.9rem; /* Smaller font size */
/*}

/* Add a guest favorite badge */
/*.post .guest-favorite {
  position: absolute;
  top: 10px;
  left: 10px;
  background-color: #fff;
  padding: 5px 10px;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: bold;
  color: #00aaff; */ /* Airbnb pink color */
  /*box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}*/

/* Rating and other text below the title */
#overlayContainer {
    display: none;
    flex-wrap: wrap; /* Ensure posts flow to the next row if there's no space */
    gap: 17px; /* Space between posts */
    padding: 10px; /* Padding around the container */
    row-gap: 246px;
}
#overlayContainer2 {
    display: none;
    flex-wrap: wrap; /* Ensure posts flow to the next row if there's no space */
    gap: 15px; /* Space between posts */
    /*padding: 10px; /* Padding around the container */
    row-gap: 0px;
}

.post {
    position: relative;
    top: 5px;
    left: 5px;
    width: 300px;
    height: 500px;
    background-color: rgba(255, 255, 255, 0.15);
    color: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    padding: 15px;
    /* display: flex; */
    flex-direction: column;
    align-items: center;
    margin-bottom: 20px;
    justify-self: center;
}

.post img {
    width: 100%; /* Make the image take up the full width of the container */
    height: auto; /* Maintain aspect ratio */
    border-bottom: 1px solid #ddd; /* Separate image from text */
    margin-bottom: 10px; /* Add space below the image */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Optional: Add a shadow for better visuals */

}

.post h3, .post p {
    margin: 5px 0; /* Ensure consistent spacing */
    text-align: center; /* Center text */
}

.post .guest-favorite {
  position: absolute;
  top: 10px;
  left: 10px;
  background-color: white;
  color: #00aaff;
  font-weight: bold;
  font-size: 0.8rem;
  border-radius: 12px;
  padding: 5px 10px;
}

.post .view-link {
  background-color: #00aaff;
  color: white;
  padding: 17px 55px;
  text-align: center;
  border-radius: 20px;
  margin-top: auto;
  text-decoration: none;
  font-size: 16px;
  border-radius: 25px 0px 0px 25px;
  font-family: system-ui;
}

/* Button or link for each post */
/*.post .view-link {
  display: inline-block;
  margin-top: auto;*/ /* Push link to the bottom */
  /*padding: 8px 12px;
  background-color: #00aaff;
  color: white;
  border-radius: 50px;
  text-decoration: none;
  font-size: 0.9rem;
  text-align: center;
}*/

.post .view-link:hover {
  background-color: #00aaff;
}

.like-button {
    margin-top: 10px; /* Space above the button */
    padding: 17px 20px; /* Add padding for better clickability */
    background-color: #00aaff; /* Button background color */
    color: #fff; /* Button text color */
    border: none; /* Remove border */
    border-radius: 5px; /* Round corners */
    cursor: pointer; /* Change cursor to pointer */
    font-size: 16px;
    border-radius: 0 25px 25px 0;
    padding-bottom: 17px;
    padding: top 17px;
}

.like-button:hover {
    background-color: #00aaff; /* Change color on hover */
}
.like-button:hover, .post .view-link:hover {
      box-shadow: 0 0 9px rgb(22, 194, 252) /* Red outline for focus similar to Airbnb */
}
/* Override hover effects when Pink Theme is active */
.pink-theme-active .like-button:hover, 
.pink-theme-active .post .view-link:hover, 
.pink-theme-active .airbnb-button:hover, 
.pink-theme-active .airbnb-button22:hover, 
.pink-theme-active .airbnb-button23:hover, 
.pink-theme-active #loginButton:hover, 
.pink-theme-active #likedPostsButton:hover {
    /*background-color: #FF6CDA !important;*/ /* Light Pink Background */
    box-shadow: 0 0 12px rgba(255, 108, 218, 0.8), 0 0 4px rgba(255, 108, 218, 0.5) !important; /* Pink Glow */
    animation: pulseShadowPink 0.6s ease-in-out infinite alternate !important;
}

.pink-theme-active .like-button, 
.pink-theme-active .post .view-link, 
.pink-theme-active .airbnb-button, 
.pink-theme-active .airbnb-button22, 
.pink-theme-active .airbnb-button23, 
.pink-theme-active #likedPostsButton {
    background-color: #F56ED3 !important; /* Light Pink Background */
}
.hidden {
    display: none;
}

.dropdown-menu {
    position: absolute;
    background: rgba(255, 255, 255, 0.15);
    color: rgba(255, 255, 255, 0.75);
    border-radius: 12px;
    padding: 10px;
    box-shadow: 0 0 12px rgba(0, 0, 0, 0.2);
    top: 30.49%;
    right: 144px;
    display: flex;
    flex-direction: column;
    z-index: 22022;
}
.dropdown-menu2 {
    position: absolute;
    background: rgba(255, 255, 255, 0.15);
    color: rgba(255, 255, 255, 0.75);
    border-radius: 8px;
    padding: 10px;
    box-shadow: 0 0 12px rgba(0, 0, 0, 0.2);
    top:48.59%;
    right: 144px;
    display: flex;
    flex-direction: column;
    z-index: 22022;
}

.dropdown-menu3 {
    position: absolute;
    background: rgba(255, 255, 255, 0.15);
    color: rgba(255, 255, 255, 0.75);
    border-radius: 8px;
    padding: 10px;
    box-shadow: 0 0 12px rgba(0, 0, 0, 0.2);
    top: 260px;
    right: 144px;
    display: flex;
    flex-direction: column;
    z-index: 22022;
}
#applycustomHDRI {
  background-color: rgba(255, 255, 255, 0.15);
border-radius: 25px;
border: 1px solid lightgrey;
color: rgba(255, 255, 255, 0.75);
}
#applycustomHDRI:hover {
  background: rgba(255,255,255,0.4);
}
#customBackgroundMenu select{
    top: 60px;
    right: 14px;
    background-position: right 10px;
    background-position-x: 98.4%;
    background-size: 9px;
}

.background-option {
    background: rgba(255,255,255,0.2);
    color: rgba(255, 255, 255, 0.75);
    border: none;
    border-radius: 10px;
    padding: 8px 12px;
    margin: 5px;
    cursor: pointer;
    transition: 0.3s;
}

.background-option:hover {
  background: rgba(255,255,255,0.4);
}


/* Keyframes for Pink Glow Animation */
@keyframes pulseShadowPink {
  0% {
    box-shadow: 0 0 12px rgba(255, 108, 218, 0.8), 0 0 4px rgba(255, 108, 218, 0.5);
  }
  100% {
    box-shadow: 0 0 12px rgb(255, 108, 218), 0 0 4px rgba(255, 85, 200, 0.75);
  }
}

/* Button or link for each post */
/*.post .view-link {
  display: inline-block;
  margin-top: auto;*/ /* Push link to the bottom */
  /*padding: 8px 12px;
  background-color: #00aaff;
  color: white;
  border-radius: 50px;
  text-decoration: none;
  font-size: 0.9rem;
  text-align: center;
}*/

.post .view-link:hover {
  background-color: #00aaff;
}
/* Scrollbar customization */
#overlayContainer::-webkit-scrollbar {
  width: 10px;
}
#overlayContainer2::-webkit-scrollbar {
  width: 10px;
}

#overlayContainer::-webkit-scrollbar-thumb {
  background-color: rgba(0, 0, 0, 0.5);
  border-radius: 5px;
}
#overlayContainer2::-webkit-scrollbar-thumb {
  background-color: rgba(0, 0, 0, 0.5);
  border-radius: 5px;
}
#left-container::-webkit-scrollbar {
    width: 10px;
}

#left-container::-webkit-scrollbar-thumb {
    background-color: rgba(0, 0, 0, 0.5);
    border-radius: 5px;
}        
#overlayContainer.show {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    z-index: 22012;
}
#overlayContainer2.show {
    display: grid;
    display: flex !important;
    grid-template-columns: repeat(1, 1fr);
    z-index: 22012;
}
#left-container.show {
    width: 50%;  /* Expands to 50% smoothly */
	display: block;
    background-color: white;
    color: black;
    font-size: 16px;
    padding: 20px;
    overflow-y: auto;
    z-index: 20010;  /* Ensure it's in front of other elements if necessary */
}
/* Spinner CSS */
.spinner-container {
    display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
    z-index: 22010;
	position: absolute;
  top: 200px;
    left: 50%;
    transform: translate(-50%, -50%);
    color: rgba(255, 255, 255, 0.75);
}

.spinner {
    border: 4px solid rgba(0, 0, 0, 0.1);
  border-left-color: rgba(255, 255, 255, 0.75);
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
  color: rgba(255, 255, 255, 0.75);
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.spinner-text {
    margin-top: 10px;
    text-align: center;
    color: rgba(255, 255, 255, 0.75);
    font-size: 16px;
}
/* Full-screen opaque overlay */
/* Loading Screen */
.loading-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 99999;
}

.active-loader {
  display: block;
}

.inactive-loader {
  display: none;
}

.hidden {
  width: 100%;
  height: 100%;
  display: none;
}

#instructionsOverlay {
  position: absolute;
  top: 40%;
  left: 0;
  width: 100%;
  background: rgba(0, 0, 0, 0);
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  z-index: 1000;
  pointer-events: none;
}

.instruction-step {
  position: relative;
  width: 200px;
  height: 200px;
  margin-bottom: 20px;
}

.got-it-button {
  background-color: #00aaff; /* Airbnb red */
  color: white;
  padding: 12px 25px;
  border: none;
  border-radius: 10px;
  font-size: 16px;
  cursor: pointer;
  position: relative; /* Important for positioning the ::after element */
  overflow: hidden; /* Prevent the shiny effect from going outside the button */
  transition: background-color 0.3s ease;
}

.got-it-button::after {
  content: '';
  position: absolute;
  top: 0;
  left: -125%; /* Start outside the left boundary */
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.5);
  transform: skewX(-45deg); /* Create diagonal shine */
  transition: left 0.3s ease-out;
}

.got-it-button:hover {
  background-color: #e03a56; /* Slightly darker red on hover */
}

.got-it-button:hover::after {
  left: 100%; /* Move the shiny effect across the button */
}


.instruction-text {
  margin-top: 15px;
  font-size: 18px;
  color: white;
  text-align: center;
  font-family: Arial, sans-serif;
}

.glove-hand {
  width: 80px;
  height: auto;
  animation: handMove 2s infinite ease-in-out;
}

.pulsating-dot {
  position: absolute;
  width: 15px;
  height: 15px;
  background: white;
  border-radius: 50%;
  animation: pulse 1.5s infinite;
}

/* Glove hand animation */
@keyframes handMove {
  0%, 100% {
    transform: translate(0, 0);
  }
  50% {
    transform: translate(10px, 10px);
  }
}

/* Dot pulse animation */
@keyframes pulse {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.5);
    opacity: 0.5;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.toggle-container {
  display: block;
  justify-content: center;
  margin: 0px 0;
}

.toggle-container2 {
  display: flex;
  justify-content: center;
  display: flex;
  margin-left: -75px;
margin-right: -53px;
}

.theme-switch {
  position: absolute;
  display: flex;
  right: 15px;
  width: 80px;
  height: 40px;
  top: 386px;
  z-index: 22011;
}
.theme-switch2 {
  width: 135px;
  height: 40px;
  /*left: 24%; /* Center the toggle horizontally */
  transform: translateX(-50%); /* Adjust to center */
  top: 12px;
  z-index: 22011;
  display:flex;
  flex:1;
}
/* Larger Apple desktops (iMac) */
@media (min-width: 1440px) {
  #overlayContainer .post {
top: -8px !important;
left: -8px !important;
}
  #overlayContainer {
    width: 46%;
    padding-top: 22px !important;
    padding-left: 22px;
    row-gap: 260 !important;
    height: 75%;
    gap: px !important;
    grid-auto-rows: minmax(300px, auto) !important;
  }
  .post .view-link {
    padding: 17px 57px !important;
  }
  .flight-time {
    right: 135px !important;
  }
  #overlayContainer2 {
    width: 44%;
    height: 79%;
  }
  #header {
    justify-content: center; /* Center header for desktops */
    width: 110%;
  }
}

/* Laptops and smaller desktops (MacBook Pro/Air) */
@media (max-width: 1440px) {
  #header {
    justify-content: center; /* Keep right-aligned for laptops */
  }
  #overlayContainer {
    left: 18px !important;
    width: 54%;
  }
}

/* Tablets and smaller laptops (11-13 inches) */
@media (max-width: 1024px) {
  #header {
    justify-content: center;
  }
}

/* Small tablets or phones */
@media (max-width: 768px) {
  #header {
    justify-content: center;
  }
}
.like-button {
            padding: 17px 20px !important;
            padding-bottom: 17px !important;
        }
/* Apply different padding for non-Safari browsers */
@supports not (-webkit-appearance: none) {
    .like-button {
        padding: 16.5px 20px !important;
        padding-bottom: 15.5px !important;
    }
}

/* Apply Safari-specific padding using a media query */
@media not all and (min-resolution:.001dpcm) { 
    @supports (-webkit-appearance: none) { 
        .like-button {
            padding: 17px 20px !important;
            padding-bottom: 17px !important;
        }
    }
}


#cityBtn {
  color: rgba(255, 255, 255, 0.75);
  font-size: 16px;
  font-family: system-ui;
}

#countryBtn {
  margin-top: 10px;
  color: rgba(255, 255, 255, 0.75);
  font-size: 16px;
  font-family: system-ui;
}

.theme-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}
.theme-switch2 input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #0780B3;
  transition: 0.4s;
  border-radius: 40px;
}

.slider2 {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(255, 255, 255, 0.15);
  transition: 0.4s;
  border-radius: 40px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
}
.slider2:focus, .slider2:focus {
    outline: none;
      box-shadow: 0 0 9px rgb(255, 169, 21) /* Red outline for focus similar to Airbnb */
}
.slider2:hover, .slider2:hover {
      box-shadow: 0 0 9px rgb(255, 169, 21) /* Red outline for focus similar to Airbnb */
}

.slider:before {
  position: absolute;
  content: "";
  height: 32px;
  width: 32px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  transition: 0.4s;
  border-radius: 50%;
}

.slider2:before {
  position: absolute;
  content: "";
  height: 32px;
  width: 32px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  transition: 0.4s;
  border-radius: 50%;
}

.theme-switch input:checked + .slider {
  background-color: #00aaff; /* Trivago blue */
}
.theme-switch2 input:checked + .slider2 {
  background-color: rgba(255, 255, 255, 0.15); /* Trivago blue */
}

.theme-switch input:checked + .slider:before {
  transform: translateX(40px);
}

.theme-switch2 input:checked + .slider2:before {
  transform: translateX(94px);
}

#languageSelect {
  width: 124px;
  top: 75px;
  right: 17.6%;
  border-radius: 24px;
  height: 35px;
  background-position: right 14px;
  background-position-x: 90.5%;
  background-size: 14px;
}
.logo-airbnb,
.logo-trivago {
  position: absolute;
  width: 20px;
  height: 20px;
  top: 50%;
  transform: translateY(-50%);
}
.logo-country,
.logo-city {
  position: relative;
  width: 20px;
  height: 20px;
  transform: translateY(-50%);
}
.logo-lng-setting {
  position: absolute;
  width: 7px;
  height: 7px;
}
.logo-airbnb {
  left: 8px;
}
.logo-country {
  left: 8px;
}

.logo-trivago {
  right: 8px;
}
.logo-city {
  right: 0px;
}


.search-bar {
  display: flex;
  justify-content: center;
  padding: 10px;
}

.airbnb-button {
  background-color: #00aaff;
  color: white;
  border: none;
  cursor: pointer;
}
.airbnb-button2 {
  background-color: #00aaff;
  color: white;
  border: none;
  cursor: pointer;
}
#gotItBtn {
    background-color: #00aaff;
  }
.airbnb-button22 {
  background-color: #0780B3; /* Airbnb red color */
    border: none;
    padding: 10px 20px; /* Slightly smaller padding */
    border-radius: 50px; /* Fully rounded button */
    color: white;
    font-size: 16px;
    margin-left: 17.9px;
    cursor: pointer;
    transition: background-color 0.3s ease;
     transition: background-color 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 8px rgba(0, 115, 187, 0.4), 0 1px 3px rgba(0, 115, 187, 0.12); /* Initial shadow */
    cursor: default;
}
.airbnb-button23 {
  background-color: #20B2AA; /* Airbnb red color */
    border: none;
    padding: 10px 20px; /* Slightly smaller padding */
    border-radius: 50px; /* Fully rounded button */
    color: white;
    font-size: 16px;
    margin-left: 17.9px;
    cursor: pointer;
    transition: background-color 0.3s ease;
     transition: background-color 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 8px rgba(0, 115, 187, 0.4), 0 1px 3px rgba(0, 115, 187, 0.12); /* Initial shadow */
    cursor: default;
}
.hidden {
  display: none;
}

/*#loading-overlay.hidden {
  display: none;*/  /* Hidden by default or after hiding */
  /*visibility: hidden;*/  /* Ensure it's not visible */
  /*position: fixed;*/  /* Keep it fixed if it was over the entire screen */
  /*z-index: 1;
  top: 0;
  left: 0;
  width: 0%;
  height: 0%;
  opacity: 0;
  pointer-events: none;
}*/

/* Loader visibility settings */
/*.active-loader {
  display: block;
}

.inactive-loader {
  display: none;
}*/
/* Full-screen opaque overlay */
/*(#loading-overlay {
  width: 100vw;
  height: 100vh;
  background: rgba(155, 155, 155, 0.5);
  display: block; /* Ensure flex display for centering */
  /*justify-content: center; 
  align-items: center;
  z-index: 99999;
  visibility: visible;
  opacity: 1;
  transition: opacity 0.5s ease; /* Smooth fade-out transition */
/*}

#loading-overlay.hidden {
  opacity: 0; /* Smooth fade-out */
  /*pointer-events: none; /* Disable interactions */
  /*transition: opacity 0.5s ease; /* Match fade-out transition */
/*}
/* Loader visibility settings */
/*.active-loader {
  display: block;
}

.inactive-loader {
  display: none;
}

#loader1, #loader2 {
  width: 100px; /* Adjust as necessary */
  /*height: 100px;
  object-fit: contain;
}*/


#loadingSpinner {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  display: block;
}

.spinner2 {
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #3498db;
  width: 120px;
  height: 120px;
  animation: spin 2s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

canvas[style="display: block; width: 769px; height: 640px;"]{
  pointer-events: auto !important;
}
canvas element.style {
    display: block !important;
    width: 769px;
    height: 640px;
    pointer-events: all !important;
}

input[type="date"]::-webkit-input-placeholder {
    color: rgba(255, 255, 255, 0.75);
}

input[type="date"]::-webkit-calendar-picker-indicator {
    filter: invert(75%); /* Adjust icon color for dark backgrounds */
}
input[type="date"] {
    color: rgba(251, 251, 251, 0.75);
    background-color: rgba(255, 255, 255, 0.15); /* Optional */
}
input[type="date"]::-webkit-datetime-edit {
    color: rgba(255, 255, 255, 0.75);
}
 /* Added mobile-specific styles */
 /* Mobile-specific styles */
@media (max-width: 768px) {
  .overlayContainer, .loadingScreen, .toggle-container, .instructionsOverlay {
    width: 90%;
    height: auto;
    margin: 10px auto;
  }
  .overlayContainer2 {
    width: 90%;
    height: auto;
    margin: 10px auto;
  }
  .gotItBtn, .submitRegion, .regionSelectBtn, .toggleButton, .newsButton, .closeNewsButton {
    font-size: 14px;
    padding: 10px 15px;
  }
  .container, .header {
    width: 100%;
    padding: 5%;
    font-size: 16px;
  }
  .regionPopup, .priceCategorySelect, .airbnbSelector {
    width: 100%;
    margin: 10px 0;
  }
  .confirmationMessage {
    font-size: 14px;
    padding: 10px;
    text-align: center;
  }
  .newsOverlay, .newsOverlaynighttheme {
    width: 100%;
    height: auto;
    margin: 0 auto;
  }
  
}
#closeBtn {
  display:flex;
}
@media (max-width: 768px) {
      #dayTicker, #nightTicker, #header, #header2, .theme-switch {
        display: none !important;
      }
    }
    .flatpickr-calendar {
    font-size: 16px; /* Larger font for better readability */
    background: rgba(255, 255, 255, 0.15);
    color: white;
}

.flatpickr-calendar.animate.arrowTop.arrowLeft.open {
  color: rgb(255, 255, 255);
  background-color: rgba(255, 255, 255, 0.15); /* Use rgba for transparency */
}

.flatpickr-input {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 10px 15px;
    background-color: rgba(255, 255, 255, 0.15);
    color: rgba(255,255, 255, 0.75); /* Set the text color to white */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;500;700&display=swap');

.flatpickr-calendar {
    font-family: 'Roboto', sans-serif;
    font-weight: 400;
    background: rgba(0, 0, 0, 0.8);
    border: 0px solid #444;
    border-radius: 10px;
    color: #f5f5f5;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
}

.flatpickr-calendar .flatpickr-day {
    color: #ffffff;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.6);
    transition: all 0.2s ease-in-out;
}

.flatpickr-calendar .flatpickr-day:hover {
    color: #ffffff;
    background: #00aaff;
    transform: scale(1.1);
    border-radius: 50%;
}

.flatpickr-calendar .flatpickr-day.selected {
    background: #5fcaff;
    color: #ffffff;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

.flatpickr-calendar .flatpickr-weekday {
    color: #f2f2f2;
    font-weight: bold;
    text-transform: uppercase;
    background-color: rgba(255, 255, 255, 0.1);
    padding: 5px;
    border-radius: 5px;
}

.flatpickr-calendar .flatpickr-prev-month,
.flatpickr-calendar .flatpickr-next-month {
    color: #ffffff;
    font-size: 1.2em;
    transition: background 0.2s;
}

.flatpickr-calendar .flatpickr-prev-month:hover,
.flatpickr-calendar .flatpickr-next-month:hover {
    background: #7bcafe;
    color: #ffffff;
    border-radius: 50%;
}

.calendar-icon {
    width: 20px;
    height:22px;
    transform: translateY(-50%);
    font-size: 18px; /* Adjust size */
    color: white; /* Icon color (if using font-based icons) */
    pointer-events: none; /* Prevent the icon from blocking clicks on the input */
    margin-left: 106.5px !important;
margin-top: -90px;
}
.calendar-icon2 {
    transform: translateY(-50%);
    font-size: 18px; /* Adjust size */
    color: white; /* Icon color (if using font-based icons) */
    pointer-events: none; /* Prevent the icon from blocking clicks on the input */
    flex: 1 !important;
    margin-left: 130.5px;
margin-top: -100px;
/* top: -10px; */
margin-bottom: 6px;
}
.calendar-icon {
  width: 20px;
    height:22px;
    transform: translateY(-50%);
    font-size: 18px; /* Adjust size */
    color: white; /* Icon color (if using font-based icons) */
    pointer-events: none; /* Prevent the icon from blocking clicks on the input */
    flex: 1;
    margin-left: 105.9px;
margin-top: -90px;
}
#mobileDesktopView {
    position: fixed;
    top: 40%;
    left: 12px;
    width: 85%;
    background-color: rgba(255, 255, 255, 0.15); /* Yellow for attention */
    color: rgba(255, 255, 255, 0.75);
    text-align: center;
    padding: 15px;
    font-size: 16px;
    font-weight: bold;
    z-index: 999999;
    box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.2);
    border-radius: 15px; /* Slightly more rounded corners */
}
.close-btn2 {
  top: 40%;
  right:30px;
  color: rgba(251, 251, 251, 0.75);
  background-color: rgba(255, 255, 255, 0.0);
  border-radius: 25px;
  border-color: rgba(255, 255 255, 0.65);
}
</style>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5689710336620898"
crossorigin="anonymous"></script>

<style>
.post img {
    width: 300px;
    height: 300px;
    object-fit: cover;
    border-radius: 15px;
}
/* Specific styles for Windows users */
.windows-style {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Windows default font */
  background-color: #f4f4f4; /* A light neutral background */
  color: #333; /* Darker text for readability */
}

.windows-style a {
  color: #0066cc; /* Windows-themed link color */
  text-decoration: underline;
}

.windows-style button {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background-color: #0078d7; /* Windows blue */
  color: white;
  border: none;
  padding: 10px 15px;
  border-radius: 4px;
  cursor: pointer;
}
.windows-style .theme-switch2 {
  left: 15%;
}
.windows-style button:hover {
  background-color: #005a9e; /* Darker blue for hover state */
}

.windows-style input, .windows-style select {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
}

.windows-style input:focus, .windows-style select:focus {
  border-color: #0078d7;
  box-shadow: 0 0 5px rgba(0, 120, 215, 0.5);
  outline: none;
}
#carousel-container {
  width: 100%;
  overflow: hidden;
  position: fixed;
  bottom: -10px;
  z-index: 22011;
  background-color: rgba(255, 255, 255, 0.0); /* Optional */
}
#carousel-container2 {
  width: 100%;
  overflow: hidden;
  position: fixed;
  bottom: -2.5px;
  z-index: 22011;
  background-color: rgba(255, 255, 255, 0.0); /* Optional */
}

.carousel {
  display: flex;
  width: max-content;  /* Allow the carousel to be wide enough for all items */
  animation: scroll 60s linear infinite; /* Continuous scrolling */
}

.carousel2 {
  display: flex;
  width: max-content;  /* Allow the carousel to be wide enough for all items */
  animation: scroll 60s linear infinite; /* Continuous scrolling */
}

.carousel-item {
  min-width: 600px; /* Adjust to match your desired width */
  max-height: 120px;
  margin: 10px;
  padding: 10px;
  text-align: center;
}

.carousel-item2 {
  min-width: 600px; /* Adjust to match your desired width */
  max-height: 120px;
  margin: 10px;
  padding: 10px;
  text-align: center;
}

.carousel img {
  width: 100%;
  height: auto;
  border-radius: 8px; /* Optional */
}
.carousel2 img {
  width: 100%;
  height: auto;
  border-radius: 8px; /* Optional */
}

/* Keyframes for continuous scrolling */
@keyframes scroll {
  0% {
    transform: translateX(0); /* Start at the beginning */
  }
  100% {
    transform: translateX(-100%); /* Scroll full width of all items */
  }
}

.carousel-container a {
  display: block;  /* Make the whole image clickable */
}

.carousel-container2 a {
  display: block;  /* Make the whole image clickable */
}

.carousel-buttons {
  position: absolute;
  top: 50%;
  width: 100%;
  display: none;
  justify-content: space-between;
  transform: translateY(-50%);
}

.carousel2-buttons {
  position: absolute;
  top: 50%;
  width: 100%;
  display: none;
  justify-content: space-between;
  transform: translateY(-50%);
}

.carousel-buttons button {
  background-color: rgba(0, 0, 0, 0.5);
  color: white;
  border: none;
  font-size: 24px;
  padding: 10px;
  cursor: pointer;
}

.carousel2-buttons button {
  background-color: rgba(0, 0, 0, 0.5);
  color: white;
  border: none;
  font-size: 24px;
  padding: 10px;
  cursor: pointer;
}

.carousel-buttons button:hover {
  background-color: rgba(0, 0, 0, 0.8);
}
.carousel2-buttons button:hover {
  background-color: rgba(0, 0, 0, 0.8);
}
.carousel-header {
  display: flex;
  justify-content: flex-end;
  margin-bottom: 5px;
  position:fixed;
  background-color: rgba(255,255,255,0.0);
  top: 120px;
  z-index: 22011;
  left: 0px;
  right: 15px;
  top: 348px;
}

#minimizeCarouselBtn {
  background-color: rgba(255, 255, 255, 0.15);
  color: rgba(255, 255, 255, 0.75);
  border: none;
  padding: 8px 12px;
  cursor: pointer;
  border-radius: 4px;
  font-size: 12px;
  border-radius: 0px 0px 12px 12px;
  z-index:22011;
      right: 15px;
      top: 347px;
      padding: 5px 7px;
      font-size: 12px;
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      width: 125px;
}
/* Popup Container */
.popup-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  display: none; /* Hidden by default */
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

/* Popup Content */
.popup-content {
  background: white;
  border-radius: 8px;
  padding: 20px;
  width: 90%;
  max-width: 400px;
  text-align: center;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

/* Close Button */
.popup-close-btn {
  position: absolute;
  top: 15px;
  right: 15px;
  font-size: 20px;
  color: #333;
  cursor: pointer;
}

/* Input Field */
#emailInput {
  width: 80%;
  padding: 10px;
  margin: 10px 0;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 16px;
}

/* Submit Button */
.popup-submit-btn {
  background-color: #00aaff;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
}

.popup-submit-btn:hover {
  background-color: #007acc;
}


#minimizeCarouselBtn:hover {
  background-color: rgba(225, 225, 225, 0.35);
}
#cruisesBtn:hover {
  background-color: rgba(225, 225, 225, 0.35);
}
#globeViz {
      width: 100%;
      height: 100%;
    }
.carousel-header2 {
  display: flex;
  justify-content: flex-end;
  margin-bottom: 5px;
  position:fixed;
  background-color: rgba(255,255,255,0.0);
  top: 120px;
  z-index: 22011;
  left: 0px;
  right: 15px;
  top: 300px;
}
#showPromoCodesBtn {
  background-color: rgba(255, 255, 255, 0.15);
  color: rgba(255, 255, 255, 0.75);
  border: none;
  padding: 8px 12px;
  cursor: pointer;
  border-radius: 4px;
  font-size: 12px;
  border-radius: 0px 0px 12px 12px;
  z-index:22011;
      right: 15px;
      top: 191px;
      padding: 5px 7px;
      font-size: 12px;
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      width: 100px;
}

#showPromoCodesBtn:hover {
  background-color: rgba(225, 225, 225, 0.35);
}

.carousel-container {
  transition: height 0.3s ease, opacity 0.3s ease;
  overflow: hidden;
}

.carousel-container.hidden {
  height: 0;
  opacity: 0;
}

#cycleUp {
  display: flex;
background-color: rgba(255, 255, 255, 0.15);
color: white;
border: 1.5px solid rgba(225, 225, 225, 0);
cursor: pointer;
padding: 0px 3.5px;
position: relative;
border-radius: 0px 50px 0px 0px;
margin-left: 98px;
/* margin-right: 13px; */
/* margin-top: -10px; */
top: -38px;
/* margin-bottom: 0px; */
/* margin-bottom: 100px; */
/* bottom: 10px; */
padding-bottom: 0;
flex: 1;
/* align-self: start; */
}
@media not all and (min-resolution:.001dpcm) {
    @supports (-webkit-appearance: none) {
        #cycleUp {
            padding: 1.5px 2.5px !important; /* Safari-specific padding */
        }
        #cycleDown {
            padding: 1.5px 2.5px !important; /* Safari-specific padding */
        }
    }
}.safari #cycleUp {
    padding: 1.25px 2.5px !important;
}

.safari #cycleDown {
    padding: 1.25px 2.5px !important;
}
@media not all and (min-resolution: 0.001dpcm) {
    @supports (-webkit-appearance: none) {
        #cycleUp {
            padding: 1.5px 2.5px !important; /* Safari-specific padding */
        }
        #cycleDown {
            padding: 1.5px 2.5px !important; /* Safari-specific padding */
        }
    }
}


#cycleDown {
  margin-right: 0px;
position: relative;
right: -3px;
padding-top: 0;
background-color: rgba(255, 255, 255, 0.15);
color: white;
border: 1.5px solid rgba(225, 225, 225, 0);
cursor: pointer;
padding: 2.5px;
border-radius: 0px 0px 50px 0px;
top: 26px;
/* margin-right: 100px; */
padding: 0px 3.5px;
margin-left: 95px;
margin-top: 13.9999999px;
/* bottom: 30px; */
margin-bottom: 1px;
}
#dropdownMenu button {
    display: block;
    width: 100%;
    padding: 10px;
    border: none;
    background: white;
    text-align: left;
    transition: background 0.3s ease-in-out; /* Smooth transition */
}

#dropdownMenu button:hover {
    background: lightgrey; /* Light grey background on hover */
    cursor: pointer;
}

</style>
<script>
  // Check the user agent for Windows OS
  if (navigator.userAgent.includes('Windows')) {
    document.body.classList.add('windows-style');
  }
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5689710336620898"
     crossorigin="anonymous"></script>
</head>
<body>
  <div id="globeViz" style="display:none"></div>
  <div class="carousel-header">
    <button id="minimizeCarouselBtn">&nbsp;&nbsp;&nbsp;Hide Ads</button>
  </div>
  <div class="carousel-header2">
    <button id="showPromoCodesBtn" style="display:none">Promo Codes</button>
  </div>
  <div id="carousel-container" style="display: flex;">
    <div class="carousel">
      <!-- Advertiser 1 Address Hotels-->
      <div class="carousel-item">
        <a href="https://www.anrdoezrs.net/click-101312981-16944928?url=https%3A%2F%2Fwww.addresshotels.com%2Fen%2F" target="_blank">
          <img src="js/Screenshot 2024-12-09 at 14.07.42.png" alt="Advertiser 1">
        </a>
      </div>
  
      <!-- Advertiser 2 Vida Hotels-->
      <div class="carousel-item">
        <a href="https://www.tkqlhce.com/click-101312981-16978427?url=https%3A%2F%2Fwww.vidahotels.com%2Fen%2F" target="_blank">
          <img src="js/Screenshot 2024-12-09 at 14.12.35.png" style="  height: 82.95px; width: 600px;" alt="Advertiser 2">
        </a>
      </div>
  
      <!-- Advertiser 3 Travel Up-->
      <div class="carousel-item">
        <a href="https://www.tkqlhce.com/click-101312981-15488597?url=https%3A%2F%2Fwww.travelup.com%2Fen-gb"target="_blank">
          <img src="js/Screenshot 2024-12-09 at 14.15.30.png"style=" height: 83px; width: 650px;" alt="Advertiser 3" >
        </a>
      </div>
  
      <!-- Advertiser 4 Rexing-->
      <div class="carousel-item">
        <a href="https://www.dpbolvw.net/click-101312981-14000405?url=https%3A%2F%2Fwww.rexingusa.com%2F%3Fsrsltid%3DAfmBOopQTSipJZiie7zY23n5SsOGVXgil3GahX4szeaNXrR4XAsit4l8" target="_blank">
          <img src="js/blue_rexinglogo_hd-e1622158390594.png"  style="width: 460px; height: 84px;" alt="Advertiser 3">
        </a>
      </div>
      <!-- Advertiser 5 Lumary-->
      <div class="carousel-item">
        <a href="https://www.jdoqocy.com/click-101312981-15890503?url=https%3A%2F%2Fwww.lumarysmart.com%2F" target="_blank">
          <img src="js/ads.png" style="display: flex; height: 100px; width: 230px; margin-top: -10px; margin-bottom: 0px;" alt="Advertiser 3">
        </a>
      </div>     
      <!-- Add more advertisers as needed -->
       <!-- Advertiser 6.5 Expedia-->
      <div class="carousel-item">
        <a href="https://www.kqzyfj.com/click-101312981-13882988?url=https%3A%2F%2Fwww.expedia.co.uk%2F" target="_blank">
          <img src="js/Screenshot 2024-12-16 at 09.29.38.png" style="display: flex; height: 100px; width: 250px; margin-top: -10px; margin-bottom: 0px;" alt="Advertiser 3">
        </a>
      </div>
    </div>
  </div>

  <div id="carousel-container2" style="display: none">
    <div class="carousel2">
      <!-- Advertiser 1 Address Hotels-->
      <div class="carousel-item2">
        <a href="https://www.anrdoezrs.net/click-101312981-16944928?url=https%3A%2F%2Fwww.addresshotels.com%2Fen%2F" target="_blank">
          <img src="js/Screenshot 2024-12-13 at 18.18.34.png" alt="Advertiser 1">
        </a>
      </div>
  
      <!-- Advertiser 2 Vida Hotels-->
      <div class="carousel-item2">
        <a href="https://www.tkqlhce.com/click-101312981-16978427?url=https%3A%2F%2Fwww.vidahotels.com%2Fen%2F" target="_blank">
          <img src="js/Screenshot 2024-12-13 at 16.56.32.png" alt="Advertiser 2">
        </a>
      </div>
  
      <!-- Advertiser 3 Travel Up-->
      <div class="carousel-item2">
        <a href="https://www.tkqlhce.com/click-101312981-15488597?url=https%3A%2F%2Fwww.travelup.com%2Fen-gb"target="_blank">
          <img src="js/Screenshot 2024-12-13 at 18.03.21.png"style=" height: 98px; width: 600px;" alt="Advertiser 3" >
        </a>
      </div>
  
      <!-- Advertiser 4 Rexing-->
      <div class="carousel-item2">
        <a href="https://www.dpbolvw.net/click-101312981-14000405?url=https%3A%2F%2Fwww.rexingusa.com%2F%3Fsrsltid%3DAfmBOopQTSipJZiie7zY23n5SsOGVXgil3GahX4szeaNXrR4XAsit4l8" target="_blank">
          <img src="js/blue_rexinglogo_hd-e1622158390594.png"  style="width: 460px; height: 84px;" alt="Advertiser 3">
        </a>
      </div>
      <!-- Advertiser 5 Lumary-->
      <div class="carousel-item2">
        <a href="https://www.jdoqocy.com/click-101312981-15890503?url=https%3A%2F%2Fwww.lumarysmart.com%2F" target="_blank">
          <img src="js/ads.png" style="display: flex; height: 100px; width: 230px; margin-top: -10px; margin-bottom: 0px;" alt="Advertiser 3">
        </a>
      </div>      
      <!-- Add more advertisers as needed -->
       <!-- Advertiser 6.5 Expedia-->
      <div class="carousel-item">
        <a href="https://www.kqzyfj.com/click-101312981-13882988?url=https%3A%2F%2Fwww.expedia.co.uk%2F" target="_blank">
          <img src="js/Screenshot 2024-12-16 at 09.29.38.png" style="display: flex; height: 100px; width: 250px; margin-top: -10px; margin-bottom: 0px;" alt="Advertiser 3">
        </a>
      </div>
    </div>
  </div>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<!-- Vertical three-dots button -->
<div class="menu-container" style="position: absolute; z-index: 9999999; display: none; top: 165px; left: -4px;">
  <button id="menuButton" style="
    border: none;
    display: none;
    background: transparent;
    cursor: pointer;
    color: white;
    font-size: 24px; /* Increase icon size */
    padding: 12px; /* Add spacing around icon */
    width: 50px; /* Increase clickable area */
    height: 50px; /* Increase clickable area */
    border-radius: 50%; /* Make it circular */
    display: flex;
    align-items: center;
    justify-content: center;
">
    <strong style="z-index: 9999999;">&#x22EE;</strong> <!-- Vertical three-dots icon -->
</button>
  <div id="dropdownMenu" style="display: none; position: absolute; left: 10px; background: white; width: 120px; border: 1px solid lightgray; border-radius: 5px; z-index: 9999999;">
    <button id="airbnbOption" style="display: block; width: 100%; padding: 10px; border: none; background: none; text-align: left;">Airbnb Stays</button>
    <button id="expediaOption" style="display: block; width: 100%; padding: 10px; border: none; background: none; text-align: left;">Expedia Hotels</button>
  </div>
</div>
    <div id="overlayContainer" style="resize: both; overflow: auto;">
        <div class="drag-handle" style="cursor: grab; background: lightgray; padding: 10px; border-radius: 5px;">
            Drag to minimize or maximize
        </div>
    <button id="closeBtn" style="display: block;"class="close-btn">X</button>
    <div class="drag-handle" style="display: block;">
      <div class="line" style="display: block;"></div>
      <div class="line" style="display: block;"></div>
    </div>
    <!-- First post -->
    <div class="post">
      <img src="your-image-url-1.jpg" alt="Post Title 1" />
      <div class="guest-favorite">Guest favorite</div>
      <h3>Post Title 1</h3>
      <p class="details">Price per night, Location</p>
      <p class="details">Dates available</p>
      <p class="details">Rating: 4.99</p>
      <a href="#" class="view-link">View Listing</a>
    </div>
  </div>

  <div id="overlayContainer2" style="resize: both; overflow: auto;">
    <div class="drag-handle" style="cursor: grab; background: lightgray; padding: 10px; border-radius: 5px;">
        Drag to minimize or maximize
    </div>
    

<button id="closeBtn" style="display: block;"class="close-btn">X</button>
<div class="drag-handle" style="display: block;">
  <div class="line" style="display: block;"></div>
  <div class="line" style="display: block;"></div>
</div>
<!-- First post -->
<div class="post">
  <img src="your-image-url-1.jpg" alt="Post Title 1" />
  <div class="guest-favorite">Guest favorite</div>
  <h3>Post Title 1</h3>
  <p class="details">Price per night, Location</p>
  <p class="details">Dates available</p>
  <p class="details">Rating: 4.99</p>
  <a href="#" class="view-link">View Listing</a>
</div>
</div>
  <div id="globeContainer"></div>
  <!-- Loading overlay with two loaders (visible by default) -->
  <!-- Loading Screen -->
<div id="loadingScreen" class="loading-screen">
  <img id="loader1" src="js/Infinity@1x-1.0s-200px-200px-2.svg" alt="Loading..." class="active-loader" />
  <img id="loader2" src="js/Eclipse@1x-1.0s-200px-200px-2.svg" alt="Loading..." class="inactive-loader" />
</div>
<div class="toggle-container">
  <label class="theme-switch">
    <input type="checkbox" id="themeToggle">
    <span class="slider">
      <img src="js/hotel-7.png" alt="Airbnb" style="display: none; left: 9px; justify-content: center; width: 32px; height: 32px;
  align-items: center;" class="logo-airbnb">
      <img src="js/airplane-3.png" alt="Trivago" style="right: 12px; justify-content: center; height: 28px; width: 28px;
  align-items: center;"class="logo-trivago">
    </span>
  </label>
</div>
<button id="clearFiltersBtn">Clear Filters</button>


<!-- Instructions Modal -->
<!-- Instructions Modal -->
<div id="instructionsOverlay" class="hidden">
  <div class="instruction-step hidden" id="zoomInstruction">
    <img src="js/travel-4.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 50%; left: 50%;"></div>
    <p class="instruction-text">Welcome to Horizon Flights! <br> we are a luxury travel platform designed to help you book flights and hotels around the world!</p>
  </div>
  <div class="instruction-step hidden" id="zoomInstruction">
    <img src="js/1707657805expedia-icon-png.png" alt="Button Click" class="glove-hand"><img src="js/img.icons8.com.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 50%; left: 50%;"></div>
    <p class="instruction-text">We partner with Airbnb and Expedia to bring you the best flights & hotels around the world!</p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/travel-4.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text">The globe is interactive! Use your mouse or trackpad to zoom in and out, drag around & click on the markers to view the latest hotels in each region!</p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/travel-4.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text">Tap to skip the tutorial and start browsing, or wait to view the full tutorial</p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
<button id="gotItBtn" style="top: 50%;left: 35%;" class="got-it-button hidden">Skip Tutorial</button>
</div>
  <div class="instruction-step hidden" id="dragInstruction">
    <img src="js/left-click.png" alt="Drag Gesture" class="glove-hand">
    <div class="pulsating-dot" style="top: 60%; left: 55%;"></div>
    <p class="instruction-text">Drag across the globe to explore different regions!</p>
  </div>
  <div class="instruction-step hidden" id="dragInstruction">
    <img src="js/white-glove-scroll.png" alt="Drag Gesture" class="glove-hand">
    <div class="pulsating-dot" style="top: 60%; left: 55%;"></div>
    <p class="instruction-text">Click anywhere outside the blue buttons to close the hotel listings</p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/day-and-night-2.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text">Click the buttons on the side to switch between day and night theme</p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/toggle-4.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text">Use the buttons on the side to switch between searches for flights, hotels, cities and countries</p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/seo-and-web.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text">Use the search bar to search for cities and countries with flight mapping!</p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/dots.png" alt="Button Click" class="glove-hand"><img src="js/white-glove-scroll.png" alt="Drag Gesture" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text">Click the three-dot button on the search results page to filter between Expedia and Airbnb results</p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/page-refresh.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text">Use the Clear Filters button to refresh the page and perform a new search</p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/travel-4.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text">Discover our weekly travel blog, filled with the latest travel tips, destination guides, and hidden gems to inspire your next adventure. Click the Travel Blog button to explore exciting posts and plan your perfect getaway today!</p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/email.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text">Sign Up for Exclusive Offers! Subscribe to our email list and get access to exclusive promotions and deals.</p>
    <form id="emailForm" onsubmit="submitEmail(event)">
      <input style="justify-content: center; justify-items: center; align-items: center; margin-left: 14px;"type="email" id="emailInput" placeholder="Enter your email" required />
      <button style="justify-content: center; justify-items: center; align-items: center; margin-left: 56.5px;"type="submit" class="popup-submit-btn">Sign Up</button>
    </form>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/diamond.png" alt="Button Click" class="glove-hand"><img src="js/customize.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text"> 
       Enjoy <strong>premium themes</strong> and book flights like a VIP 
       <strong>Sign Up</strong> for our <strong>premium subscription</strong> to explore the world in <strong>first-class</strong> style! </p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/login--2.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text">Lastly, Phew, Login to view saved and liked posts!</p>
  </div>
  <div class="instruction-step hidden" id="themeInstruction">
    <img src="js/resort-2.png" alt="Button Click" class="glove-hand"><img src="js/luxury.png" alt="Button Click" class="glove-hand">
    <div class="pulsating-dot" style="top: 70%; left: 60%;"></div>
    <p class="instruction-text">With Us, All you have to ask is where to next! start exploring and have fun!!</p>
  </div>
<div class="instruction-step hidden" id="themeInstruction">
<button id="gotItBtn" style="top: 50%;left: 35%;" class="got-it-button hidden">Got it!</button>
</div>
</div>


<div id="container">
<div id="left-container" style="display: none;" class="split-screen-left"></div>
    </div>
  </div>
  
  <!-- Info Section -->
  <div id="info" style="display:none">Click the markers to show the label</div>
  <div id="credits" style="display:none">
    Made by
    <a href="https://www.linkedin.com/in/shange-fagan-bba3a3239/" target="_blank" rel="noopener">Shange Fagan</a>
  </div>
	<!-- Footer -->
  <footer>
     2024 Horizon Flights. All rights reserved.
    <a href="https://www.linkedin.com/in/shange-fagan-bba3a3239/" target="_blank" style="display: none;">LinkedIn</a><a href="privacy.html" target="_blank">Privacy Policy</a> | 
        <a href="about.html" target="_blank">About Us</a> |
        <a href="faqs.html" target="_blank">FAQs</a> |
        <a href="mailto:horizonflights.co@gmail.com?subject=Inquiry&body=Hello, I would like to know more about your services." target="_blank">Contact Us</a>
</footer>
  <div id="mobileDesktopView" style="display: none;">
    <button class="close-btn2"></button>
    <p> Best Viewed on Desktop for Full Experience!

      For the most immersive and fully featured Horizon Flights experience, we recommend using a laptop or desktop (Windows/Mac).
      
      Our 3D globe, dynamic animations, and premium themes are optimised for larger screens, just as showcased on TikTok!
      
      <br>
       Mobile Version in Progress!
      
      We're working hard to bring the full experience to mobile soon.
      
      In the meantime, for the best performance and all premium features, please revisit on a desktop device.
      
      <br>
       Thank you for your patience & happy travels! </p>
</div>
<div id="header">
  <input type="text" id="from" name="travel_from" placeholder="Where from?">
  <input type="text" id="where" name="destination" placeholder="Where to?">
  <!-- Checkbox for Location Type (City or Country) -->
  <div class="toggle-container2">
    <label class="theme-switch2">
      <input type="checkbox" id="themeToggle2">
      <span class="slider2">
        <img src="js/earth.png" alt="Airbnb" style="display: none; left: 14px; justify-content: center; width: 20%; height: 69%; margin-left:-7px;
    margin-top:20px; align-items: center;" class="logo-country"><span id="countryBtn" style="display: none; margin-left:37px; margin-top: -36.5px;">Country</span>
        <img src="js/buildings.png" alt="Trivago" style="right: -97px; top: 20px; justify-content: center; width: 24%; height: 80%; margin-right: -7px;
    align-items: center;"class="logo-city"><span id="cityBtn" style="margin-left: 40px; display: none; margin-top: -21px !important;">By City</span>
      </span>
    </label>
  </div>
  <div class="date-picker-wrapper">
    <input type="text" id="checkin" class="flatpickr-input" placeholder="Check-in date">
    <img src="js/calendar-icon2.png" alt="Calendar Icon" class="calendar-icon">
</div>
<div class="date-picker-wrapper">
  <input type="text" id="checkout" class="flatpickr-input" placeholder="Departure date">
  <img src="js/exit.png" id="Icon"alt="Calendar Icon" class="calendar-icon2"style="width: 17px; height: 17px;">
</div>
  <div id="guestSelector" style="position: relative;">
    <input type="number" id="adults" name="adults" placeholder="Add guests">
    <button id="openGuestPopup" class="guest-popup-btn" style="margin-right: 8px; display: none">+</button>
  <!-- Popup Modal -->
  <div id="guestPopup" class="popup hidden">
    <div class="popup-content">
        <h3>Guests</h3>
        <div class="guest-row">
            <label for="adultsPopup">Adults:</label>
            <input type="number" id="adultsPopup" name="adultsPopup" min="0" value="2">
        </div>
        <div class="guest-row">
            <label for="childrenPopup">Children:</label>
            <input type="number" id="no_of_children" name="childrenPopup" min="0" value="0">
        </div>
        <div class="guest-row">
          <label for="roomsPopup">Rooms:</label>
          <input type="number" id="roomsPopup" name="roomsPopup" min="1" value="1">
      </div>
        <button id="saveGuests" class="popup-save-btn">Save</button>
        <button id="closePopup" class="popup-close-btn">Close</button>
    </div>
</div>
</div>
<div id="cabinClassContainer">
  <span id="cabinClassLabel">
    Cabin Class: 
  </span>
  <div>
    <button id="cycleDown">
      &#8595;
    </button>
    <input id="cabinClassInput" type="text" value="Economy" readonly
       />
    <button id="cycleUp">
      &#8593;
    </button>
  </div>
</div>

  <input type="number" id="price_min" style="display: flex" name="price_min" placeholder="Min price">
  <input type="number" id="price_max" style="display: flex" name="price_max" placeholder="Max price">
  <button class="languageSelect-btn">
    <img src="js/world.png" style="width: 16px; height: 16px; margin-top: -7px; margin-left: -7.9px;" class="logo-lng-setting">
  <select id="languageSelect" style="display: none !important" class="hidden">
    <option value="en-gb">English (UK)</option>
  </select>
</button>
  <button id="searchBtn" class="airbnb-button">Search</button>
  <button id="searchBtn" class="airbnb-button22" style="display:none">Search</button>
  <button id="searchBtn" class="airbnb-button23" style="display:none">Search</button>
<!-- Login Button with Dropdown -->
<div class="dropdown">
  <!-- New Login Button -->
  <button id="loginButton" class="airbnb-button2">
    <img src="js/profile-icon.png" alt="Profile Icon" style="width: 24px; display:flex; align-items: center; height: 24px; margin-right: 8px;">
    Login
  </button>
  <div id="dropdownMenu" class="dropdown-content">
    <a href="#" id="loginLogoutLink">Login</a>
  </div>
</div>
  <button id="likedPostsButton" class="liked-button">
    <img src="js/heart.png" alt="Liked posts Icon" style="width: 24px; display:flex; align-items: center; height: 24px; margin-right: 0px; margin-top: 1.5px;">
  </button>
  
</div>

<div id="header2" style="display: none;">
    <input type="text" id="from" name="travel_from" placeholder="Where from?">
    <input type="text" id="where" name="destination" placeholder="Where to?">
    <!-- Checkbox for Location Type (City or Country) -->
    <div class="toggle-container2">
      <label class="theme-switch2">
        <input type="checkbox" id="themeToggle2">
        <span class="slider2">
          <img src="js/planet-earth.png" alt="Airbnb" style="display: none; left: 14px; justify-content: center; width: 20%; height: 69%; margin-left:-7px;
      margin-top:20px; align-items: center;" class="logo-country"><span id="countryBtn" style="display: none; margin-left:42px; margin-top: -36.5px;">Country</span>
          <img src="js/buildings.png" alt="Trivago" style="right: -97px; top: 20px; justify-content: center; width: 24%; height: 80%; margin-right: -7px;
      align-items: center;"class="logo-city"><span id="cityBtn" style="margin-left: 40px; display: none; margin-top: -21px !important;">By City</span>
        </span>
      </label>
    </div>
    <input type="text" id="checkin" name="checkin" placeholder="Check-in date">
    <input type="text" id="checkout" name="checkout" placeholder="Departure date">
    <div id="guestSelector" style="position: relative; display: none">
      <input type="number" id="adults" name="adults" placeholder="Add guests">
      <button id="openGuestPopup" class="guest-popup-btn" style="margin-right: 8px;">+</button>
    <!-- Popup Modal -->
    <div id="guestPopup" class="popup hidden">
      <div class="popup-content">
          <h3>Guests</h3>
          <div class="guest-row">
              <label for="adultsPopup">Adults:</label>
              <input type="number" id="adultsPopup" name="adultsPopup" min="0" value="2">
          </div>
          <div class="guest-row">
              <label for="childrenPopup">Children:</label>
              <input type="number" id="no_of_children" name="childrenPopup" min="0" value="0">
          </div>
          <div class="guest-row">
              <label for="roomsPopup">Rooms:</label>
              <input type="number" id="roomsPopup" name="roomsPopup" min="1" value="1">
          </div>
          <button id="saveGuests" class="popup-save-btn">Save</button>
          <button id="closePopup" class="popup-close-btn">Close</button>
      </div>
  </div>
  </div>
    <input type="number" id="price_min" name="price_min" placeholder="Min price">
    <input type="number" id="price_max" name="price_max" placeholder="Max price">
    <button class="languageSelect-btn">
      <img src="js/world.png" style="width: 16px; height: 16px; margin-top: -7px; margin-left: -12px;" class="logo-lng-setting">
    <select id="languageSelect" class="hidden">
      <option value="en-gb">English (UK)</option>
      <option value="fr-fr">French</option>
      <option value="de-de">German</option>
    </select>
  </button>
    <button id="searchBtn" class="airbnb-button">Search</button>
    <button id="searchBtn" class="airbnb-button22" style="display:none">Search</button>
  <!-- Login Button with Dropdown -->
  <div class="dropdown">
    <!-- New Login Button -->
    <button id="loginButton" class="airbnb-button2">
      <img src="js/profile-icon.png" alt="Profile Icon" style="width: 24px; display:flex; align-items: center; height: 24px; margin-right: 8px;">
      Login
    </button>
    <div id="dropdownMenu" class="dropdown-content">
      <a href="#" id="loginLogoutLink">Login</a>
    </div>
  </div>
    <button id="likedPostsButton" class="liked-button">
      <img src="js/heart.png" alt="Liked posts Icon" style="width: 24px; display:flex; align-items: center; height: 24px; margin-right: 0px; margin-top: 1.5px;">
    </button>
</div>
	
<div id="regionPopup">
  <h2>Welcome to Horizon Flights</h2>
  <p>Powered by Expedia  Your Trusted Travel Partner</p>
  <p>Please select your region</p>
  <select id="regionSelect">
    <option value="africa">Africa</option>
    <option value="europe">Europe</option>
    <!-- more regions -->
    <option value="america">America</option>
    <option value="south america">South America</option>
    <option value="carribbean">Carribbean</option>
    <option value="asia">Asia</option>
    <option value="world">World</option>
  </select>
  <button id="submitRegion">Submit</button>
</div>
<button id="toggleAirbnbPrices" style="font-size: 7px; letter-spacing: 1px; display: none;">
    
</button>
	<!-- Add this dropdown for price categories -->
	<select id="priceCategorySelect" style="display:none;">
    <optgroup label="Region-Specific Categories">
      <option value="disabled">Sort by (Region)</option>
        <option value="popular">Most Popular(in Region)</option>
        <option value="cheapest">Cheapest</option>
        <option value="midPrice">Mid Price</option>
        <option value="expensive">Expensive</option>
    </optgroup>
		</select>
		<select id="airbnbSelector" style="display:none;">
    <optgroup label="World Categories">
      <option value="disabled">Sort by (Across the World) </option>
        <option value="general">Most Popular(Across the World)</option>
        <option value="cheapest">Cheapest</option>
        <option value="midPrice">Mid Price</option>
        <option value="expensive">Most Expensive</option>
    </optgroup>
</select>


<div id="confirmationMessage" style="display: none;">
  <h2>Thank you!</h2>
  <p>
    Please enter the details of your travel above, and we'll do our best to find the airbnbs tailored to your needs! or feel free to browse the top airbnbs around the world!
  </p>
</div>

<!-- Region Select button -->
<button id="regionSelectBtn">&nbsp;&nbsp;&nbsp;Select Region</button>

<div id="topLeftLabel">
  <img src="js/Adobe Express - file-2.png" alt="Profile Icon" style="width: 58px; height: 62px !important;display:flex; align-items: center; height: 28px; margin-right: -8px; margin-top: 10px;">Horizon Flights
  <img src="js/300694_plane-plane-emoji-png-png-download (1).png" alt="Profile Icon" style="width: 30.5px; display:flex; align-items: center; height: 30px; margin-left: 4px; margin-top: -2px;">
</div>
<!-- Tickers -->
  <iframe
    id="dayTicker"
    class="iframe-container"
    src="https://www.tkqlhce.com/click-101312981-13882988?url=https://rss.app/embed/v1/ticker/A443LjY7WUDJRzOm"
    frameborder="0"
    sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox"
  ></iframe>
  <iframe
    id="nightTicker"
    src="https://rss.app/embed/v1/ticker/7ctLbFgRverm6aVX"
    frameborder="0"
    style="display: none;"
    sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox"
  ></iframe>
	<iframe
    id="mobileTicker"
    src="https://rss.app/embed/v1/ticker/w7az9T20B74RTID3"
    frameborder="0"
    sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox"
  ></iframe>
	<iframe
    id="searchTicker"
    src="https://rss.app/embed/v1/ticker/drjICgXpka7g2vRG"
    frameborder="0"
    style="display: none;"  <!-- Initially hidden until search is pressed -->
    sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox"
></iframe>
    <iframe
  id="trivagoIframeContainer"
  class="iframe-container"
  src="https://www.tkqlhce.com/click-101312981-13882988?url=https://rss.app/embed/v1/ticker/A443LjY7WUDJRzOm"
  frameborder="0"
  sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox"
></iframe>


  <!-- Marker Labels (Will be dynamically generated) -->
  <div id="labels-container"></div>
  <div id="loadingIcon" class="loading-spinner"></div>
  <!-- Import Map -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.136.0/build/three.module.js",
      "three/examples/jsm/controls/OrbitControls": "https://unpkg.com/three@0.136.0/examples/jsm/controls/OrbitControls.js",
      "three/examples/jsm/renderers/CSS2DRenderer": "https://unpkg.com/three@0.136.0/examples/jsm/renderers/CSS2DRenderer.js",
      "three/examples/jsm/renderers/CSS3DRenderer": "https://cdn.jsdelivr.net/npm/three@0.136.0/examples/jsm/renderers/CSS3DRenderer.js",
      "three/examples/jsm/loaders/RGBELoader": "https://unpkg.com/three@0.136.0/examples/jsm/loaders/RGBELoader.js"
    }
  }
  </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/luxon/3.3.0/luxon.min.js"></script>
<script src="//unpkg.com/globe.gl"></script>
<script src="./js/THREE.MeshLine.js"></script>
<script type="module" src="https://cdn.jsdelivr.net/npm/three@0.136.0/examples/jsm/loaders/OBJLoader.js"></script>
<!-- Firebase App (the core Firebase SDK) -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>

<!-- Firebase Authentication -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>


<script>
  // Function to toggle the visibility of the region select dropdown when clicking the button
	document.addEventListener("DOMContentLoaded", function() {
  document.getElementById('regionSelectBtn').addEventListener('click', function(event) {
    var regionSelect = document.getElementById('regionSelectDropdown');
    
    // Toggle the visibility of the dropdown
    if (regionSelect.style.display === 'block') {
      regionSelect.style.display = 'none';
    } else {
      regionSelect.style.display = 'block';
    }
    
    // Prevent the click from propagating to the document listener (so it won't hide immediately)
    event.stopPropagation();
  });

  // Function to hide the region select dropdown when clicking outside of it
  document.addEventListener('click', function(event) {
    var regionSelect = document.getElementById('regionSelectDropdown');
    var regionSelectBtn = document.getElementById('regionSelectBtn');
    
    // Check if the click happened outside the dropdown and button
    if (regionSelect && !regionSelect.contains(event.target) && !regionSelectBtn.contains(event.target)) {
      regionSelect.style.display = 'none';
    }
  });
});
</script>

<script type="x-shader/x-vertex" id="vertexShader">
  varying vec2 vUv;
varying vec3 vNormal;
varying vec3 vp;
varying vec3 vPositionNormal;
void main(void){
  vUv = uv;
  vNormal = normalize( normalMatrix * normal );
  vp = position;
  vPositionNormal = normalize(( modelViewMatrix * vec4(position, 1.0) ).xyz);
  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
</script>
<script type="x-shader/x-fragment" id="fragmentShader">
  uniform vec3 glowColor;
uniform float bias;
uniform float power;
uniform float time;
varying vec3 vp;
varying vec3 vNormal;
varying vec3 vPositionNormal;
uniform float scale;

uniform sampler2D map;

varying vec2 vUv;

void main(void){
  float a = pow( bias + scale * abs(dot(vNormal, vPositionNormal)), power );
  if(vp.y > time && vp.y < time + 20.0) {
    float t =  smoothstep(0.0, 0.8,  (1.0 - abs(0.5 - (vp.y - time) / 20.0)) / 3.0  );
    gl_FragColor = mix(gl_FragColor, vec4(glowColor, 1.0), t * t );
  }
  gl_FragColor = mix(gl_FragColor, vec4( glowColor, 1.0 ), a);
  float b = 0.8;
  gl_FragColor = gl_FragColor + texture2D( map, vUv );
}
</script>
<script type="x-shader/x-vertex" id="aeroVertexShader">
  varying vec3	vVertexWorldPosition;
varying vec3	vVertexNormal;
varying vec4	vFragColor;
void main(){
vVertexNormal	= normalize(normalMatrix * normal);
vVertexWorldPosition	= (modelMatrix * vec4(position, 1.0)).xyz;
gl_Position	= projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
</script>
<script type="x-shader/x-fragment" id="aeroFragmentShader">
  uniform vec3	glowColor;
uniform float	coeficient;
uniform float	power;

varying vec3	vVertexNormal;
varying vec3	vVertexWorldPosition;

varying vec4	vFragColor;

void main(){
vec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;
vec3 viewCameraToVertex	= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;
viewCameraToVertex= normalize(viewCameraToVertex); 
float intensity	= pow(coeficient + dot(vVertexNormal, viewCameraToVertex), power);
gl_FragColor = vec4(glowColor, intensity);
}
</script>


	
<button id="toggleButton">&nbsp;&nbsp;&nbsp;Day Theme</button>
<!-- Background Toggle Button -->
<button id="toggleButton3" class="theme-button">&nbsp;&nbsp;&nbsp;Background</button>
<!-- Dropdown Menu for Background Selection -->
<div id="backgroundDropdown" class="dropdown-menu hidden">
    <button id="dayButton" class="background-option"> Day</button>
    <button id="nightButton" class="background-option"> Night</button>
    <button id="customButton" class="background-option"> Custom</button>
</div>
<!-- Custom Background Selection (Hidden Initially) -->
<div id="customBackgroundMenu" class="dropdown-menu2 hidden">
  <label for="customHDRI">Choose a custom backdrop:</label>
  <select id="customHDRI">
      <option value="js/kloofendal_48d_partly_cloudy_puresky.jpg">Cloudy sky background </option>
      <option value="js/autumn_field_puresky.jpg">Clear sky background </option>
      <option value="js/kloppenheim_06_puresky.jpg">Cloudy sunset </option>
      <option value="js/kiara_1_dawn.jpg">Sierra Mountains </option>
  </select>
  <button id="applycustomHDRI">Apply</button>
</div>
<button id="addLightsbutton" style="display: block;">Jetsetter Theme</button>
<button id="addLightsbutton3" style="display: block;">&nbsp;&nbsp;&nbsp;Blue Theme</button>
<button id="addLightsbutton2">&nbsp;&nbsp;&nbsp;Atmosphere</button>
<!-- Globe Style Toggle Button -->
<button id="toggleButton4" style="display:none" class="theme-button2">&nbsp;&nbsp;&nbsp;Globe Theme</button>
<!-- Dropdown Menu for Background Selection -->
<div id="backgroundDropdown2" class="dropdown-menu3 hidden">
  <button id="glassButton" class="background-option"> Gold</button>
  <button id="blueButton" class="background-option"> Blue</button>
  <button id="pinkButton" class="background-option"> Pink</button>
</div>
<button id="toggleChristmastheme" style="display:none">Christmas</button>

<button id="newsButton">&nbsp;&nbsp;&nbsp;Travel Blog</button>
  <!-- The iframe containers will be added dynamically -->
  <!-- X Button to close the iframe -->
<button id="closeNewsButton"></button>
  <!-- Iframe overlay for news articles -->
<div id="newsOverlay" style="display: none;">
  <iframe id="newsIframe" width="900" height="1600" src="https://rss.app/embed/v1/magazine/5J869AE7cqDlimdE" frameborder="0"></iframe>
</div>
<div id="newsOverlaynighttheme" style="display: none;">
  <iframe id="newsIframenighttheme" width="900" height="1600" src="https://rss.app/embed/v1/magazine/l8d8McKVHYpe6MzA" frameborder="0"></iframe>
</div>
	
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const labelDiv = document.querySelector('div[style*="1324px"][style*="353px"]');
    if (labelDiv) {
      labelDiv.setAttribute('draggable', 'true');
      labelDiv.style.touchAction = 'auto';
    }
  });
</script>
  <!-- Scripts -->
  <!-- Include Three.js and other dependencies here -->

  <!-- Main JavaScript -->
  <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
      import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
import { addDoc } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";
import {
    getAuth,
    onAuthStateChanged,
    signInWithPopup,
    GoogleAuthProvider,
    signOut,
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword
} from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
    // Firebase configuration
const firebaseConfig = {
    apiKey: "AIzaSyBP9WtBgIHmpavBQHnG0LxXcyfK7GM5_Q4",
    authDomain: "horizon-flights.firebaseapp.com",
    projectId: "horizon-flights",
    storageBucket: "horizon-flights.appspot.com",
    messagingSenderId: "173542786157",
    appId: "1:173542786157:web:073fb82c209555d9432b64",
    measurementId: "G-4KJF5LVT0R"
};
if (navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome')) {
    document.body.classList.add('safari');
}

// Initialize Firebase
const app = initializeApp(firebaseConfig);
// Initialize Firebase (Add this line before any authentication calls)
if (!firebase.apps.length) {
    firebase.initializeApp(firebaseConfig);
} else {
    firebase.app(); // Use existing app if already initialized
}
    // JavaScript code will go here
    import * as THREE from "https://unpkg.com/three@0.136.0/build/three.module.js";
  import { OrbitControls } from "https://unpkg.com/three@0.136.0/examples/jsm/controls/OrbitControls";
  import {
    CSS2DRenderer,
    CSS2DObject,
  } from "https://unpkg.com/three@0.136.0/examples/jsm/renderers/CSS2DRenderer.js";
    //import { RGBELoader } from 'https://unpkg.com/three@0.136.0/examples/jsm/loaders/RGBELoader.js';
	  // Import necessary post-processing modules
//import { EffectComposer } from 'https://unpkg.com/three@0.136.0/examples/jsm/postprocessing/EffectComposer.js?v=1';
//import { RenderPass } from 'https://unpkg.com/three@0.136.0/examples/jsm/postprocessing/RenderPass.js?v=1';
//import { UnrealBloomPass } from 'https://unpkg.com/three@0.136.0/examples/jsm/postprocessing/UnrealBloomPass.js?v=1';
//import  Luxon from 'https://cdnjs.cloudflare.com/ajax/libs/luxon/3.3.0/luxon.min.js'; //(if using modules)
//import { MeshLine, MeshLineMaterial } from './js/THREE.MeshLine.js';
// Scene Setup
  const scene = new THREE.Scene();
  /*const camera = new THREE.PerspectiveCamera(45, innerWidth / innerHeight, 1, 2000);*/
  let camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 2000);
  camera.position.set(20, 0.5, 15).setLength(25);

// Initialize Firestore
const db = getFirestore(app);

// Initialize Firebase Authentication
const auth = getAuth(app);

  // Submit email to Firestore
  document.querySelector(".popup-submit-btn").addEventListener("click", function (event) {
    event.preventDefault(); // Prevent default form submission behavior

    // Collect the email value from the input field
    const email = document.getElementById("emailInput").value.trim();

    // Validate the email (optional, for better user experience)
    if (!email || !/\S+@\S+\.\S+/.test(email)) { // Basic email regex validation
        alert("Please enter a valid email address.");
        return;
    }

    // Ensure the email is stored uniquely
    const postId = `email_${Date.now()}`; // Generate a unique ID based on the timestamp

    // Create a Firestore document reference for the email
    const mailingList = doc(db, "EmailList", postId);

    // Save the email data in Firestore
    setDoc(mailingList, { email: email, id: postId }) // Save the email and unique ID
        .then(() => {
            alert(`Email ${email} successfully added to Mailing list!`);
            // Show a success message to the user
            alert("Thank you for subscribing!");
            // Reset the input field
            document.getElementById("emailInput").value = "";
        })
        .catch((error) => {
            console.error("Error storing email in Firestore: ", error);
            // Show an error message to the user
            alert("There was an error submitting your email. Please try again later.");
        });
});
// JavaScript to Toggle and Close Dropdown
/*document.addEventListener("DOMContentLoaded", () => {
    const dropdownBtn = document.getElementById("toggleButton3");
    const dropdown = document.getElementById("backgroundDropdown");

    // Close dropdown when clicking outside
    document.addEventListener("click", (event) => {
        if (!dropdown.contains(event.target) && event.target !== dropdownBtn) {
            dropdown.style.display = "none"
        }
    });
});*/





// Handle Login/Logout when the login button is clicked
document.getElementById("loginButton").addEventListener("click", () => {
    const user = auth.currentUser;

    if (user) {
        // User is logged in, handle logout
        signOut(auth)
            .then(() => {
                alert("Logged out successfully.");
                updateLoginButton(null); // Update the button to show "Login"
                updatelikedPostsButton(null);
            })
            .catch((error) => console.error("Error during logout:", error));
    } else {
        // Show login modal with options
        const loginContainer = document.createElement("div");
        loginContainer.setAttribute("id", "loginContainer");
        loginContainer.style.position = "fixed";
        loginContainer.style.top = "50%";
        loginContainer.style.left = "50%";
        loginContainer.style.transform = "translate(-50%, -50%)";
        loginContainer.style.backgroundColor = "rgba(255, 255, 255, 0.15)";
        loginContainer.style.padding = "20px";
        loginContainer.style.borderRadius = "10px";
        loginContainer.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.2)";
        loginContainer.style.textAlign = "center";
        loginContainer.style.zIndex = "22012";

        // Close Button
        const closeButton = document.createElement("span");
        closeButton.innerHTML = "&times;";
        closeButton.style.position = "absolute";
        closeButton.style.top = "0px";
        closeButton.style.right = "7px";
        closeButton.style.cursor = "pointer";
        closeButton.style.fontSize = "20px";
        closeButton.style.color = "#FFFFFF";
        closeButton.addEventListener("click", () => {
            document.body.removeChild(loginContainer); // Close modal
        });
        loginContainer.appendChild(closeButton);

        // Google Login Button
        const googleButton = document.createElement("button");
        googleButton.innerHTML = `
            <img src="js/transparent-google-logo-google-logo-blue-circle-with-g-1710875609249.png" alt="Google Icon" style="width: 40px; height: 40px; margin-right: 10px;">
            Continue with Google
        `;
        googleButton.style.backgroundColor = "#4285F4";
        googleButton.style.color = "white";
        googleButton.style.border = "none";
        googleButton.style.padding = "10px 29px";
        googleButton.style.borderRadius = "5px";
        googleButton.style.cursor = "pointer";
        googleButton.style.marginBottom = "10px";
        googleButton.style.display = "flex";
        googleButton.style.justifyContent = "center";
        googleButton.style.alignItems = "center";

        googleButton.addEventListener("click", () => {
            const provider = new GoogleAuthProvider();
            signInWithPopup(auth, provider)
                .then((result) => {
                    alert(`Logged in as ${result.user.displayName}`);
                    updateLoginButton(result.user);
                    updatelikedPostsButton(result.user);
                    document.body.removeChild(loginContainer); // Remove modal
                })
                .catch((error) => console.error("Login error:", error));
        });

        // Add "or" separator
        const orText = document.createElement("p");
        orText.innerText = "or";
        orText.style.fontSize = "16px";
        orText.style.color = "#FFFFFF";
        orText.style.margin = "10px 0";
        orText.style.fontFamily = "system-ui";

        // Email/Password Login Form
        const emailForm = document.createElement("form");
        emailForm.innerHTML = `
            <input type="email" id="emailInput" placeholder="Enter your email" style="display: block; width: 90%; margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" required>
            <input type="password" id="passwordInput" placeholder="Enter your password" style="display: block; width: 90%; margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" required>
            <button type="submit" id="emailLoginButton" style="background-color: #00aaff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Login</button>
        `;

        emailForm.addEventListener("submit", (e) => {
            e.preventDefault();

            const email = document.getElementById("emailInput").value.trim();
            const password = document.getElementById("passwordInput").value;

            signInWithEmailAndPassword(auth, email, password)
                .then((result) => {
                    alert(`Logged in as ${result.user.email}`);
                    updateLoginButton(result.user);
                    updatelikedPostsButton(result.user);
                    document.body.removeChild(loginContainer); // Remove modal
                })
                .catch((error) => {
                    console.error("Login error:", error);
                });
        });

        // Signup Button
        const signupButton = document.createElement("button");
        signupButton.innerText = "New to Horizon? Sign up here";
        signupButton.style.fontSize = "14px";
        signupButton.style.color = "#00aaff";
        signupButton.style.backgroundColor = "transparent";
        signupButton.style.border = "none";
        signupButton.style.cursor = "pointer";
        signupButton.style.marginTop = "10px";

        signupButton.addEventListener("click", () => {
            // Hide the login form
            loginContainer.style.display = "none";

            // Show signup form
            const signupContainer = document.createElement("div");
            signupContainer.setAttribute("id", "signupContainer");
            signupContainer.style.position = "fixed";
            signupContainer.style.top = "50%";
            signupContainer.style.left = "50%";
            signupContainer.style.transform = "translate(-50%, -50%)";
            signupContainer.style.backgroundColor = "rgba(255, 255, 255, 0.15)";
            signupContainer.style.padding = "20px";
            signupContainer.style.borderRadius = "10px";
            signupContainer.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.2)";
            signupContainer.style.textAlign = "center";
            signupContainer.style.zIndex = "22013"; // Higher z-index than login form

            const signupForm = document.createElement("form");
            signupForm.innerHTML = `
                <input type="email" id="signupEmailInput" placeholder="Enter your email" style="display: block; width: 90%; margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-left: -1.5%;" required>
                <input type="password" id="signupPasswordInput" placeholder="Enter your password" style="display: block; width: 90%; margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-left: -1.5%;" required>
                <button type="submit" style="background-color: #00aaff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Sign Up</button>
            `;

            signupForm.addEventListener("submit", (e) => {
                e.preventDefault();

                const email = document.getElementById("signupEmailInput").value.trim();
                const password = document.getElementById("signupPasswordInput").value;

                createUserWithEmailAndPassword(auth, email, password)
                    .then((result) => {
                        alert(`Account created for ${result.user.email}`);
                        updateLoginButton(result.user);
                        updatelikedPostsButton(result.user);
                        document.body.removeChild(signupContainer); // Remove signup modal
                    })
                    .catch((error) => {
                        console.error("Signup error:", error);
                    });
            });

            // Close button for signup form
            const closeSignupButton = document.createElement("span");
            closeSignupButton.innerHTML = "&times;";
            closeSignupButton.style.position = "absolute";
            closeSignupButton.style.top = "2.5px";
            closeSignupButton.style.right = "10px";
            closeSignupButton.style.cursor = "pointer";
            closeSignupButton.style.fontSize = "20px";
            closeSignupButton.style.color = "#FFFFFF";
            closeSignupButton.addEventListener("click", () => {
                document.body.removeChild(signupContainer);
                loginContainer.style.display = "block"; // Show login form again
            });

            signupContainer.appendChild(closeSignupButton);
            signupContainer.appendChild(signupForm);
            document.body.appendChild(signupContainer);
        });

        // Append elements to the login modal
        loginContainer.appendChild(googleButton);
        loginContainer.appendChild(orText); // Add "or" text
        loginContainer.appendChild(emailForm);
        loginContainer.appendChild(signupButton);
        document.body.appendChild(loginContainer);
    }
});
// Handle form submission
/*(function submitEmail(event) {
  event.preventDefault();
  const email = document.getElementById("emailInput").value;
  alert(`Thank you for signing up, ${email}!`);
  closePopup();
  // Add logic to send email to your marketing system
}*/


// Update Login Button State
function updateLoginButton(user) {
    const loginButton = document.getElementById("loginButton");
    if (user) {
        loginButton.innerHTML = `
            <img src="js/profile-icon2.png" alt="Profile Icon" style="width: 24px; height: 24px; margin-right: 8px;"> Logout`;
    } else {
        loginButton.innerHTML = `
            <img src="js/profile-icon.png" alt="Profile Icon" style="width: 24px; height: 24px; margin-right: 8px;"> Login`;
    }
}

//Track Authentication State Changes
onAuthStateChanged(auth, (user) => {
    updateLoginButton(user); // Update button state based on auth state
    updatelikedPostsButton(user);
});


// Update Liked Posts Button State
function updatelikedPostsButton(user) {
    const likedPostsButton = document.getElementById("likedPostsButton");
    if (user) {
        likedPostsButton.innerHTML = `
            <img src="js/heart-2.png" alt="Liked Posts Icon" style="width: 24px; display: flex; align-items: center; height: 24px; margin-right: 0px; margin-top: 1.5px;">`;
    } else {
        likedPostsButton.innerHTML = `
            <img src="js/heart.png" alt="Liked Posts Icon" style="width: 24px; display: flex; align-items: center; height: 24px; margin-right: 0px; margin-top: 1.5px;">`;
    }
}

  document.addEventListener('DOMContentLoaded', function () {
    flatpickr("#checkin", {
        dateFormat: "Y-m-d",
        minDate: "today",
        defaultDate: "today",
        onChange: function(selectedDates, dateStr, instance) {
            // Update the checkout field's minDate
            const checkoutPicker = flatpickr("#checkout");
            checkoutPicker.set("minDate", dateStr);
        }
    });

    flatpickr("#checkout", {
        dateFormat: "Y-m-d",
        minDate: "today",
    });
});
// Get the input element
const checkinInput = document.getElementById('checkin');

// Function to format today's date
function getFormattedDate() {
    const today = new Date();
    const year = today.getFullYear();
    const month = String(today.getMonth() + 1).padStart(2, '0'); // Month is zero-based
    const day = String(today.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`; // Format as YYYY-MM-DD
}

// Set the placeholder to today's date
checkinInput.placeholder = getFormattedDate();
/*document.addEventListener('DOMContentLoaded', function () {
  const carousel = document.querySelector('.carousel');
  const carouselItems = document.querySelectorAll('.carousel-item');
  const totalItems = carouselItems.length;

  let currentIndex2 = 0;

  // Clone the first and last items for seamless scrolling
  const firstItem = carouselItems[0].cloneNode(true);
  const lastItem = carouselItems[totalItems - 1].cloneNode(true);

  // Append clones to the carousel
  carousel.appendChild(firstItem);
  carousel.insertBefore(lastItem, carouselItems[0]);

  // Adjust carousel width to fit all items
  carousel.style.width = `${(totalItems + 2) * 600}px`; // Adjust 600px to match your item width
  carousel.style.transform = `translateX(-600px)`; // Start position (skip the clone)

  function showNextSlide() {
    currentIndex2++;
    carousel.style.transition = 'transform 0.5s ease';
    carousel.style.transform = `translateX(-${(currentIndex2 + 1) * 600}px)`;

    // Reset position when reaching the cloned last item
    if (currentIndex2 === totalItems) {
      setTimeout(() => {
        carousel.style.transition = 'none';
        carousel.style.transform = `translateX(-600px)`; // Back to real first item
        currentIndex2 = 0;
      }, 500); // Match the transition duration
    }
  }

  // Automatically slide every 3 seconds
  setInterval(showNextSlide, 3000);
});


function toggleCarousel() {
  const carouselContainer = document.getElementById('carousel-container');
  const minimizeButton = document.getElementById('minimizeCarouselBtn');

  if (carouselContainer.style.display === 'none') {
    // Show the carousel
    carouselContainer.style.display = 'flex';
    minimizeButton.textContent = 'Minimize Ads';
  } else {
    // Hide the carousel
    carouselContainer.style.display = 'none';
    minimizeButton.textContent = 'Maximize Ads';
  }
}
document.getElementById('minimizeCarouselBtn').addEventListener('click', function() {
  toggleCarousel()
});*/
// Add event listener for DOM content loaded
document.addEventListener('DOMContentLoaded', function () {
  const carousel1 = document.querySelector('.carousel');
  const carousel2 = document.querySelector('.carousel2');
  const carouselItems = document.querySelectorAll('.carousel-item');
  const totalItems = carouselItems.length;
  let currentIndex2 = 0;

  // Clone first and last items for seamless scrolling for carousel 1
  const firstItem = carouselItems[0].cloneNode(true);
  const lastItem = carouselItems[totalItems - 1].cloneNode(true);

  // Append clones to carousel 1
  carousel1.appendChild(firstItem);
  carousel1.insertBefore(lastItem, carouselItems[0]);

  // Adjust carousel width to fit all items
  carousel1.style.width = `${(totalItems + 2) * 600}px`; // Adjust 600px to match item width
  carousel1.style.transform = `translateX(-600px)`; // Start position (skip the clone)

  function showNextSlide() {
    currentIndex2++;
    carousel1.style.transition = 'transform 0.5s ease';
    carousel1.style.transform = `translateX(-${(currentIndex2 + 1) * 600}px)`;

    // Reset position when reaching the cloned last item
    if (currentIndex2 === totalItems) {
      setTimeout(() => {
        carousel1.style.transition = 'none';
        carousel1.style.transform = `translateX(-600px)`; // Back to real first item
        currentIndex2 = 0;
      }, 500); // Match transition duration
    }
  }

  // Automatically slide every 3 seconds for carousel 1
  setInterval(showNextSlide, 3000);

  // Add toggle logic between carousel1 and carousel2
  const showPromoCodesBtn = document.getElementById('showPromoCodesBtn');
  const carouselContainer1 = document.getElementById('carousel-container');
  const carouselContainer2 = document.getElementById('carousel-container2');

  showPromoCodesBtn.addEventListener('click', function () {
    if (carouselContainer1.style.display !== 'none') {
      // Switch to carousel 2 (Promo Codes View)
      carouselContainer1.style.display = 'none';
      carouselContainer2.style.display = 'flex';
      showPromoCodesBtn.textContent = 'Hide Codes';
    } else {
      // Switch back to carousel 1 (Regular Ads View)
      carouselContainer1.style.display = 'flex';
      carouselContainer2.style.display = 'none';
      showPromoCodesBtn.textContent = 'Promo Codes';
    }
  });

  // Add minimize button logic
  const minimizeButton = document.getElementById('minimizeCarouselBtn');
  minimizeButton.addEventListener('click', function () {
    if (carouselContainer1.style.display !== 'none' || carouselContainer2.style.display !== 'none') {
      // Hide both carousels
      carouselContainer1.style.display = 'none';
      carouselContainer2.style.display = 'none';
      minimizeButton.textContent = '\u00A0\u00A0\u00A0Show Ads';
    } else {
      // Show the appropriate carousel (default is carousel 1)
      if (showPromoCodesBtn.textContent === 'Hide Promo Codes') {
        carouselContainer2.style.display = 'flex';
      } else {
        carouselContainer1.style.display = 'flex';
      }
      minimizeButton.textContent = '\u00A0\u00A0\u00A0Hide Ads';
    }
  });
});
function showMobileDesktopView() {
    const mobileDesktopView = document.getElementById("mobileDesktopView");

    // Detect if the user is on a mobile device
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

    if (isMobile) {
      mobileDesktopView.style.display = "block";
    // Close button functionality
document.querySelector('.close-btn2').addEventListener('click', function () {
    const closeNewsButton = document.getElementById('.close-btn2');
    
    // Hide the overlay and close button
    mobileDesktopView.style.display = 'none';
    closeNewsButton.style.display = 'none';
});
    const topLeftLabel = document.getElementById('topLeftLabel');
        const iframe = document.getElementById('mobileTicker');
        const daythemeiframe = document.getElementById('dayTicker');
        const nightthemeiframe = document.getElementById('nightTicker');
        const trivagoIframeContainer = document.getElementById('trivagoIframeContainer');
        const searchTicker = document.getElementById('searchTicker');
        const submitRegion = document.getElementById('regionPopup');
        const clearFiltersBtn = document.getElementById('clearFiltersBtn');
        const regionSelect = document.getElementById('regionSelectBtn');
        const toggleButton = document.getElementById('toggleButton');
        const addLightsbutton = document.getElementById('addLightsbutton');
        const addLightsbutton2 = document.getElementById('addLightsbutton2');
        const newsButton = document.getElementById('newsButton');
        const minimizeCarouselBtn = document.querySelector('.carousel-header');
        const carouselContainer = document.getElementById('carousel-container');
        const loadingScreen = document.getElementById('loadingScreen');
        const pinkthemeBtn = document.getElementById('addLightsbutton3');
        const backgroundthemeBtn = document.getElementById('toggleButton3');
        const globethemeBtn = document.getElementById('toggleButton4');
        topLeftLabel.innerHTML = `
  <img src="js/Adobe Express - file-2.png" style="width: 58px; height: 62px !important; display:flex; align-items: center; height: 28px; margin-right: -4px; margin-top: 10px;" alt="Earth Globe" />
  Search Hotels
  <img src="js/5-stars.png" style="width: 33.9px; display:flex; align-items: center; height: 33.9px; margin-left: 8px; margin-top: -10px;" alt="Plane" />
`;
        iframe.style.display = "none";
        daythemeiframe.style.display = "none";
        nightthemeiframe.style.display = "none";
        trivagoIframeContainer.style.display = "none";
        searchTicker.style.display = "none";
        submitRegion.style.display = "none";
        clearFiltersBtn.style.display = "none";
        regionSelect.style.display = "none";
        toggleButton.style.display = "none";
        addLightsbutton.style.display = "none";
        addLightsbutton2.style.display = "none";
        newsButton.style.display = "none";
        minimizeCarouselBtn.style.display = "block";
        minimizeCarouselBtn.style.top = "55px";
        minimizeCarouselBtn.style.right = "0px";
        carouselContainer.style.display = "none";
        pinkthemeBtn.style.display = "none";
        backgroundthemeBtn.style.display = "none";
        globethemeBtn.style.display = "none";
        nightTexture = textureLoader.load("//unpkg.com/three-globe/example/img/earth-night.jpg");
        dayTexture = textureLoader.load("//unpkg.com/three-globe/example/img/earth-night.jpg");
        // Optionally, disable other content
        document.body.style.overflow = "hidden"; // Prevent scrolling
    }
}

// Run the function after the DOM is fully loaded
document.addEventListener("DOMContentLoaded", showMobileDesktopView);


	  // Hide the spinner after globe and scene are ready
//window.addEventListener('load', () => {
  //document.getElementById('loadingSpinner').style.display = 'none';
//});
// Function to switch between loaders
// Function to show the second loader when the page is almost done
// Function to switch from the first loader to the second loader after 5 seconds
/*function showSecondLoader() {
    const loader1 = document.getElementById("loader1");
    const loader2 = document.getElementById("loader2");

    // Hide the first loader and show the second loader
    loader1.classList.remove("active-loader");
    loader1.classList.add("inactive-loader");

    loader2.classList.remove("inactive-loader");
    loader2.classList.add("active-loader");

    // After 2 more seconds, hide the loader and show the main content
    setTimeout(hideLoader, 5000);  // Wait for 2 seconds before hiding the loader
}

// Function to hide the loader and show the main content
function hideLoader() {
    const overlay = document.getElementById("loading-overlay");

    // Add a class that triggers the fade-out
    overlay.classList.add('hidden');

    // After the fade-out is done, set display to 'none' to remove it from the document flow
    setTimeout(() => {
        overlay.style.display = 'none';

// Ensure it doesn't take up space or interfere with the layout
overlay.style.visibility = "hidden";
overlay.style.pointerEvents = "none"; 
    }, 500);  // Match the transition time in your CSS
}*/
//let daymarkerMaterial = new THREE.Color('#ff3232'); // Default to Airbnb color
//let nightmarkerMaterial = new THREE.Color('#FE8C02');
//const daymarkerMaterial = new THREE.Color('#ff3232');
let currentTicker = document.getElementById('dayTicker');

// Add the event listener for the toggle change
document.addEventListener('DOMContentLoaded', () => {
    // Add a 10-second delay before simulating a click on the toggle button
    setTimeout(() => {
        const themeToggle = document.getElementById('themeToggle');
        if (themeToggle) {
            themeToggle.click(); // Simulate a click on the toggle
        }
    }, 10000); // 10000 milliseconds = 10 seconds
});

document.addEventListener('DOMContentLoaded', () => {
    // Add a 10-second delay before simulating a click on the toggle button
    setTimeout(() => {
        const themeToggle2 = document.getElementById('themeToggle2');
        if (themeToggle2) {
            themeToggle2.click(); // Simulate a click on the toggle
            themeToggle2.click(); // Simulate a click on the toggle
        }
    }, 10000); // 10000 milliseconds = 10 seconds
});

document.addEventListener('DOMContentLoaded', () => {
    // Add a 10-second delay before simulating a click on the toggle button
    setTimeout(() => {
        const toggleButton = document.getElementById('toggleButton');
        if (toggleButton) {
          toggleButton.click(); // Simulate a click on the toggle
        }
    }, 10000); // 10000 milliseconds = 10 seconds
});
// Add the event listener for the toggle change
document.addEventListener('DOMContentLoaded', () => {
    // Add a 10-second delay before simulating a click on the toggle button
    setTimeout(() => {
        const themeToggle = document.getElementById('minimizeCarouselBtn');
        if (themeToggle) {
            themeToggle.click(); // Simulate a click on the toggle
        }
    }, 10000); // 10000 milliseconds = 10 seconds
});
  const cabinClasses = ["Economy"," Premium", "Business", "1st Class"];
  let currentIndex = 0;

  const cabinClassInput = document.getElementById("cabinClassInput");
  const cycleUp = document.getElementById("cycleUp");
  const cycleDown = document.getElementById("cycleDown");

  // Function to update the cabin class input with a sliding animation
  const updateCabinClass = (index, direction) => {
    cabinClassInput.classList.add(direction === "up" ? "slide-up" : "slide-down");

    setTimeout(() => {
      cabinClassInput.value = cabinClasses[index]; // Update the value
      cabinClassInput.classList.remove("slide-up", "slide-down"); // Reset animation class
    }, 300); // Matches the CSS animation duration
  };

  // Event listeners for up and down buttons
  cycleUp.addEventListener("click", () => {
    currentIndex = (currentIndex + 1) % cabinClasses.length; // Cycle forward
    updateCabinClass(currentIndex, "up");
  });

  cycleDown.addEventListener("click", () => {
    currentIndex = (currentIndex - 1 + cabinClasses.length) % cabinClasses.length; // Cycle backward
    updateCabinClass(currentIndex, "down");
  });
  let pinkThemeActive = false; // Track if the pink theme is active


document.getElementById('themeToggle').addEventListener('change', (event) => {
  const isChecked = event.target.checked;

  const airbnbLogos = document.getElementsByClassName("logo-airbnb");
  const trivagoLogos = document.getElementsByClassName("logo-trivago");
  // Toggle search bar button style
  const searchBtn = document.querySelector('.airbnb-button');
  const searchBtn22 = document.querySelector('.airbnb-button22');
  const regionPopupbutton = document.getElementById('submitRegion');
  const loginButton = document.getElementById('loginButton');
  const loginButton2 = document.querySelector('.airbnb-button2');
  const likedPostsButton = document.getElementById('likedPostsButton');
  const topLeftLabel = document.getElementById('topLeftLabel');
  const popupSavebtn = document.querySelector('.popup-save-btn');
  const popupClosebtn = document.querySelector('.popup-close-btn');
  const clearFiltersBtn = document.getElementById('clearFiltersBtn');
  const header = document.getElementById('header');
  const header2 = document.querySelector('header2');
  const theme = document.querySelector('.theme-switch2');
  const themebtn = document.querySelector('.slider');
  const gotItBtn = document.getElementById('gotItBtn');
  const calendaricon2 = document.querySelector('.calendar-icon2');
  const calendaricon = document.querySelector('.calendar-icon');

// Colors based on theme mode
const flightColor = pinkThemeActive ? '#C950AB' : '#0780B3';  // Dark pink or dark blue
  const hotelColor = pinkThemeActive ? '#F56ED3' : '#00aaff';  // Light pink or light blue
  
  //let currentTicker = document.getElementById('dayTicker');
  if (isChecked) {
    //searchBtn.classList.remove('airbnb-button');
    //searchBtn.classList.add('airbnb-button22');
    // Hide the day ticker
    currentTicker.style.display = "none";
        currentTicker = document.getElementById("trivagoIframeContainer"); // Set current ticker to Trivago iframe
        currentTicker.style.display = "block";
    // Hide all Airbnb logos
  Array.from(airbnbLogos).forEach(logo => logo.style.display = "block");
  Array.from(trivagoLogos).forEach(logo => logo.style.display = "none");
    document.getElementById("trivagoIframeContainer").style.display = "block";
    searchBtn.style.backgroundColor = hotelColor;
    loginButton.style.backgroundColor = hotelColor;
    topLeftLabel.style.backgroundColor = hotelColor;
    likedPostsButton.style.backgroundColor = hotelColor;
    regionPopupbutton.style.backgroundColor = hotelColor;
    popupSavebtn.style.backgroundColor = hotelColor;
    gotItBtn.style.backgroundColor = hotelColor;
    popupClosebtn.style.backgroundColor = flightColor;
    clearFiltersBtn.style.backgroundColor = hotelColor;
    themebtn.style.backgroundColor = hotelColor;
    header.style.display = "flex";
    calendaricon2.style.right="59.25%";
    calendaricon.style.right="47.3%";
    document.getElementById("cabinClassContainer").style.display = "none";
    document.getElementById("cabinClassContainer").style.display = "none";
    document.getElementById("price_min").style.display = "flex";
    document.getElementById("price_max").style.display = "flex";
    header.style.padding= "9px 0px";

    // Append the div to the parent container
    document.getElementById("header").querySelector("#guestPopup").style.top = "275px";
    theme.style.left = "25.8%";
//daymarkerMaterial.set('#00aaff');
    searchBtn.style.display = "flex";
    searchBtn.textContent = 'Search';
    searchBtn22.style.display = "none";
    topLeftLabel.innerHTML = `
  <img src="js/Adobe Express - file-2.png" style="width: 58px; height: 62px !important; display:flex; align-items: center; height: 28px; margin-right: -4px; margin-top: 10px;" alt="Earth Globe" />
  Search Hotels
  <img src="js/5-stars.png" style="width: 33.9px; display:flex; align-items: center; height: 33.9px; margin-left: 8px; margin-top: -10px;" alt="Plane" />
`;
  } else {
    //searchBtn.classList.remove('airbnb-button22');
    //searchBtn.classList.add('airbnb-button');
    document.getElementById("trivagoIframeContainer").style.display = "none";
    // Hide the Trivago iframe
    currentTicker.style.display = "none";
        currentTicker = document.getElementById("trivagoIframeContainer"); // Set current ticker to Day ticker
        currentTicker.style.display = "block";
    Array.from(trivagoLogos).forEach(logo => logo.style.display = "block");
    Array.from(airbnbLogos).forEach(logo => logo.style.display = "none");
    searchBtn.style.backgroundColor = flightColor;
    loginButton.style.backgroundColor = flightColor;
    topLeftLabel.style.setProperty('background-color', flightColor, 'important');
    likedPostsButton.style.setProperty('background-color', flightColor, 'important');
    regionPopupbutton.style.setProperty('background-color', flightColor, 'important');
    popupSavebtn.style.setProperty('background-color', flightColor, 'important');
    gotItBtn.style.setProperty('background-color', flightColor, 'important');
    searchBtn22.style.setProperty('background-color', flightColor, 'important');
    themebtn.style.setProperty('background-color', flightColor, 'important');
    const hoverStyle = document.createElement('style');
    hoverStyle.innerHTML = `
      #searchBtn:hover {
        animation: pulseShadow3 0.6s ease-in-out infinite alternate !important;
      }
    `;    popupClosebtn.style.backgroundColor = hotelColor;
    clearFiltersBtn.style.backgroundColor = flightColor;
    calendaricon2.style.right="59.9%";
    calendaricon.style.right="48%";
    document.getElementById("cabinClassContainer").style.display = "flex"
    document.getElementById("cabinClassContainer").style.display = "flex";
    document.getElementById("price_min").style.display = "none";
    document.getElementById("price_max").style.display = "none";
    document.getElementById("guestPopup").style.top = "300px";
    header.style.padding= "0px 0px";
    // Find the parent element
const guestPopup = document.getElementById("guestPopup");

// Create a new div element
const div = document.createElement("div");
div.className = "guest-row"; // Assign the class to the div

// Create a label element
const label = document.createElement("label");
label.setAttribute("for", "roomsPopup"); // Set the 'for' attribute
label.innerText = "Rooms:"; // Set the label text

// Create an input element
const input = document.createElement("input");
input.type = "number"; // Set the input type
input.id = "roomsPopup"; // Set the input ID
input.name = "roomsPopup"; // Set the input name
input.min = "1"; // Set the minimum value
input.value = "1"; // Set the default value

// Append the label and input to the div
div.appendChild(label);
div.appendChild(input);
div.style="margin-top: 0px";

// Append the div to the parent container
guestPopup.appendChild(div);

    theme.style.left = "25.3%";
    //daymarkerMaterial.set('#ff3232');
    searchBtn.style.display = "none";
    searchBtn22.style.display = "flex";
    searchBtn22.textContent = 'Search';
    topLeftLabel.innerHTML = `
  <img src="js/Adobe Express - file-2.png" style="width: 58px; height: 62px !important; display:flex; align-items: center; height: 28px; margin-right: -4px; margin-top: 10px;" alt="Earth Globe" />
 Search Flights
  <img src="js/300694_plane-plane-emoji-png-png-download (1).png" style="width: 30.5px; display:flex; align-items: center; height: 30px; margin-left: 8px; margin-top: -2px;" alt="Plane" />
`;
  }

  // Toggle iframe containers
  //document.getElementById('dayTicker').classList.toggle('hidden', isChecked);
  //document.getElementById('trivagoIframeContainer').classList.toggle('hidden', !isChecked);
});

document.getElementById('addLightsbutton3').addEventListener('click', () => {
    pinkThemeActive = !pinkThemeActive;  // Toggle pink theme mode

    const themeToggleChecked = document.getElementById('themeToggle').checked;
    const pinkButton = document.getElementById('addLightsbutton3');
    const airbnbLogos = document.getElementsByClassName("logo-airbnb");
    const calendardaytheme = document.querySelectorAll(".flatpickr-calendar .flatpickr-day.selected");
    const calendardaythemehover = document.querySelectorAll(".flatpickr-calendar .flatpickr-day:hover");
    const postViewLink = document.querySelectorAll(".post .view-link");
    const postLikeBtn = document.querySelectorAll(".like-button");
    const regionPopup = document.getElementById('regionPopup');

    // Ensure the button exists
    if (!pinkButton) {
        console.error("Pink Theme Button not found!");
        return;
    }

    if (pinkThemeActive) {
        pinkButton.textContent = "\u00A0\u00A0\u00A0Pink Theme";
        // Remove the main globe from the scene
        // Remove the original `globe` object from the scene
        /*if (scene.children.includes(globe)) {
            scene.remove(globe);
        }*/
        // Change all Airbnb logos
        Array.from(airbnbLogos).forEach(logo => {
            logo.src = "js/hotel-8.png";
        });

        // Apply pink color to calendar selected days
        calendardaytheme.forEach(day => day.style.setProperty('background-color', '#ED85D2', 'important'));
        calendardaytheme.forEach(day => day.style.setProperty('background', '#F56ED3', 'important'));
        calendardaythemehover.forEach(day => day.style.setProperty('background', '#F56ED3', 'important'));
        postLikeBtn.forEach(day => day.style.setProperty('background-color', '#F56ED3', 'important'));
        postViewLink.forEach(day => day.style.setProperty('background-color', '#F56ED3', 'important'));
        isUserPremium().then(isPremium => {
        if (!isPremium) {
          showPinkPremiumPopup(); // Show popup but still apply theme
        }
    });
        regionPopup.style.display = "none";
        // Zoom out the globe
        zoomOutGlobe();
        controls.enableZoom = true;
        controls.minDistance = 15;
        //controls.maxDistance = 30;
        const selectedHDRI = 'js/kloofendal_48d_partly_cloudy_puresky.jpg'

        loader.load(selectedHDRI, function(texture) {
            const rt = new THREE.WebGLCubeRenderTarget(texture.image.height);
            rt.fromEquirectangularTexture(renderer, texture);
            scene.background = rt.texture;
        });
        /*if (!globe2.geometry.attributes.position || globe2.geometry.attributes.position.count === 0) {
    console.warn("Globe2 geometry has invalid position attributes. Skipping material update.");
    return;
}*/
        //addCountryOutlines(); // Add the country outlines

        // Create Transparent Reflective Material for globe2
        /*globe2.material = new THREE.MeshPhysicalMaterial({
            color: new THREE.Color(0xffffff), // Neutral white to allow reflections
            transparent: true,
            opacity: 0.3, // Semi-transparent like glass
            metalness: 1.0, // Fully metallic for high reflectivity
            roughness: 0.1, // Slight roughness to give a realistic feel
            envMapIntensity: 1.5, // Enhances reflections
            clearcoat: 1.0, // Extra glossy surface
            clearcoatRoughness: 0.1,
            reflectivity: 1.0 // Maximum reflectivity
        });
        scene.environment = scene.background;
        globe2.geometry.computeBoundingSphere();
        globe2.geometry.computeVertexNormals();*/
        //scene.background = nightbackgroundTexture;
        //earthMaterial.uniforms.map.value = dayTexture;

    } else {
        pinkButton.textContent = "\u00A0\u00A0\u00A0Blue Theme";

        // Change all Airbnb logos back
        Array.from(airbnbLogos).forEach(logo => {
            logo.src = "js/hotel-7.png";
        });

        // Revert colors
        calendardaytheme.forEach(day => day.style.setProperty('background-color', '#5fcaff', 'important'));
        calendardaythemehover.forEach(day => day.style.setProperty('background-color', '#00aaff', 'important'));
        postLikeBtn.forEach(day => day.style.setProperty('background-color', '#00aaff', 'important'));
        postViewLink.forEach(day => day.style.setProperty('background-color', '#00aaff', 'important'));
        revertToPreviousTheme(); // Revert theme if "Undo" is clicked
        //scene.background = nightbackgroundTexture;
        //earthMaterial.uniforms.map.value = nightTexture;
        // Restore the original globe
        //scene.add(globe);
        removeCountryOutlines(); // Remove the country outlines
        // Reset globe2 material to normal
        /*globe2.material = new THREE.MeshPhongMaterial({
            shininess: 15,
            map: earthMaterial.uniforms.map.value, // Ensure it uses the correct texture
            specularMap: specularMap,
            bumpMap: bumpMap,
            bumpScale: 0.05,
            normalMap: normalMap,
            blending: THREE.AdditiveBlending,
            specular: new THREE.Color('grey')
        });

        globe2.geometry.computeBoundingSphere();
        globe2.geometry.computeVertexNormals();
        globe.geometry.computeBoundingSphere();
        globe.geometry.computeVertexNormals();*/
        if (previousTheme === "day") {
        earthMaterial.uniforms.map.value = dayTexture;
    } else if (previousTheme === "night") {
        earthMaterial.uniforms.map.value = nightTexture;
    }
        //scene.environment = scene.background;
        scene.background = nightbackgroundTexture;
        earthMaterial.uniforms.map.value = dayTexture;

    }
// Apply marker color logic
if (pinkThemeActive) {
        markerMaterial.color.set(pinkthememarkerMaterial);
    } else {
        if (currentmarkerMaterial === "day") {
            markerMaterial.color.set(daymarkerMaterial);
        } else if (currentmarkerMaterial === "night") {
            markerMaterial.color.set(nightmarkerMaterial);
        }
    }
    if (pinkThemeActive) {
    document.body.classList.add('pink-theme-active'); // Activate Pink Theme
} else {
    document.body.classList.remove('pink-theme-active'); // Remove Pink Theme
}

    document.getElementById('themeToggle').dispatchEvent(new Event('change'));
});

document.getElementById('themeToggle2').addEventListener('change', (event) => {
  const isChecked = event.target.checked;

  const airbnbLogos = document.getElementsByClassName("logo-country");
  const trivagoLogos = document.getElementsByClassName("logo-city");
  // Toggle search bar button style
  const searchBtn = document.getElementById('searchBtn');
  const cityBtn = document.getElementById('cityBtn');
  cityBtn.style.display = "block";
  const countryBtn = document.getElementById('countryBtn');
  //const locationTypeWrapper = document.createElement('locationTypeWrapper');
  const locationTypeWrapper = document.createElement('locationTypeWrapper');
  
  //let currentTicker = document.getElementById('dayTicker');
  if (isChecked) {
    //searchBtn.classList.remove('airbnb-button');
    //searchBtn.classList.add('trivago-button');
    // Hide the day ticker
    //currentTicker.style.display = "none";
        //currentTicker = document.getElementById("trivagoIframeContainer"); // Set current ticker to Trivago iframe
        //currentTicker.style.display = "block";
    // Hide all Airbnb logos
  Array.from(airbnbLogos).forEach(logo => logo.style.display = "block");
  Array.from(trivagoLogos).forEach(logo => logo.style.display = "none");
    //document.getElementById("trivagoIframeContainer").style.display = "block";
    //searchBtn.style.backgroundColor = '#00aaff';
    //const regionPopupButton = document.querySelector('#regionPopup button'); // Selects the button inside #regionPopup
//regionPopupButton.style.backgroundColor = '#00aaff';
//daymarkerMaterial.set('#00aaff');
countryBtn.style.display = "block";
cityBtn.style.display = "none";
locationTypeWrapper.value = 'country'
console.log(locationTypeWrapper.value)

  } else {
    //searchBtn.classList.remove('trivago-button');
    //searchBtn.classList.add('airbnb-button');
    //document.getElementById("trivagoIframeContainer").style.display = "none";
    // Hide the Trivago iframe
    //currentTicker.style.display = "none";
        //currentTicker = document.getElementById("dayTicker"); // Set current ticker to Day ticker
        //currentTicker.style.display = "block";
    Array.from(trivagoLogos).forEach(logo => logo.style.display = "block");
    Array.from(airbnbLogos).forEach(logo => logo.style.display = "none");
    //searchBtn.style.backgroundColor = '#00aaff';
    //daymarkerMaterial.set('#ff3232');
    //const regionPopupButton = document.querySelector('#regionPopup button'); // Selects the button inside #regionPopup
    //regionPopupButton.style.backgroundColor = '#00aaff';
    //searchBtn.textContent = 'Search';
    countryBtn.style.display = "none";
cityBtn.style.display = "block";
locationTypeWrapper.value = 'city'
console.log(locationTypeWrapper.value)
  }

  // Toggle iframe containers
  //document.getElementById('dayTicker').classList.toggle('hidden', isChecked);
  //document.getElementById('trivagoIframeContainer').classList.toggle('hidden', !isChecked);
});
// Show popup on clicking the Add Guests button
document.getElementById('openGuestPopup').addEventListener('click', function () {
    const guestPopup = document.getElementById('guestPopup');
    guestPopup.classList.remove('hidden');
});

// Save selected guests and rooms
document.getElementById('saveGuests').addEventListener('click', function () {
    const adults = document.getElementById('adultsPopup').value;
    const children = document.getElementById('no_of_children').value;
    const rooms = document.getElementById('roomsPopup').value;

    // Update the Add Guests button text
    const addGuestsButton = document.getElementById('openGuestsPopup');
    addGuestsButton.textContent = `${adults} Adults, ${children} Children, ${rooms} Room(s)`;

    // Hide the popup
    const guestPopup = document.getElementById('guestPopup');
    guestPopup.classList.add('hidden');
});

// Close the popup
document.getElementById('closePopup').addEventListener('click', function () {
    const guestPopup = document.getElementById('guestPopup');
    guestPopup.classList.add('hidden');
});
document.querySelector('.languageSelect-btn').addEventListener('click', function () {
  const languageDropdown = document.getElementById('languageSelect');
  if (languageDropdown.style.display === 'block') {
    languageDropdown.style.display = 'none';
  } else {
    languageDropdown.style.display = 'block';
  }
});

// Optional: Close the dropdown when clicking outside
document.addEventListener('click', function (event) {
  const button = document.querySelector('.languageSelect-btn');
  const dropdown = document.getElementById('languageSelect');
  if (!button.contains(event.target) && dropdown.style.display === 'block') {
    dropdown.style.display = 'none';
  }
});
document.addEventListener('click', function (event) {
  const button = document.getElementById('openGuestPopup');
  const dropdown = document.getElementById('openGuestPopup');
  if (!button.contains(event.target) && dropdown.style.display === 'block') {
    dropdown.style.display = 'none';
  }
});
document.addEventListener('click', function (event) {
  const button = document.getElementById('backgroundDropdown');
  const dropdown = document.getElementById('backgroundDropdown');
  if (!button.contains(event.target) && dropdown.style.display === 'block') {
    dropdown.style.display = 'none';
  }
});


//document.getElementById('themeToggle').style.display = "block";

  // Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
/*import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import {
    getAuth,
    onAuthStateChanged,
    signInWithPopup,
    GoogleAuthProvider,
    signOut,
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword
} from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBP9WtBgIHmpavBQHnG0LxXcyfK7GM5_Q4",
  authDomain: "horizon-flights.firebaseapp.com",
  projectId: "horizon-flights",
  storageBucket: "horizon-flights.firebasestorage.app",
  messagingSenderId: "173542786157",
  appId: "1:173542786157:web:073fb82c209555d9432b64",
  measurementId: "G-4KJF5LVT0R"
};

  // Initialize Firebase
const app = initializeApp(firebaseConfig);

  // Initialize Firebase Authentication
const auth = getAuth(app);

  // Handle Login/Logout
  // Handle login/logout and show liked posts
  // Add an event listener to the login button
  document.getElementById('loginButton').addEventListener('click', () => {
    const user = firebase.auth().currentUser;

    if (user) {
        // User is logged in, handle logout
        firebase.auth().signOut().then(() => {
            alert('Logged out successfully.');
            updateLoginButton(null); // Update the button to show "Login"
            updatelikedPostsButton(null);
        }).catch(error => console.error('Error during logout:', error));
    } else {
        // Show login modal with options
        const loginContainer = document.createElement('div');
        loginContainer.setAttribute('id', 'loginContainer');
        loginContainer.style.position = 'fixed';
        loginContainer.style.top = '50%';
        loginContainer.style.left = '50%';
        loginContainer.style.transform = 'translate(-50%, -50%)';
        loginContainer.style.backgroundColor = 'rgba(255, 255, 255, 0.15)';
        loginContainer.style.padding = '20px';
        loginContainer.style.borderRadius = '10px';
        loginContainer.style.boxShadow = '0 4px 8px rgba(0, 0, 0, 0.2)';
        loginContainer.style.textAlign = 'center';
        loginContainer.style.zIndex = '22012';

        // Google Login Button
        const googleButton = document.createElement('button');
        googleButton.innerHTML = `
            <img src="js/transparent-google-logo-google-logo-blue-circle-with-g-1710875609249.png" alt="Google Icon" style="width: 40px; height: 40px; margin-right: 10px;">
            Continue with Google
        `;
        googleButton.style.backgroundColor = '#4285F4';
        googleButton.style.color = 'white';
        googleButton.style.border = 'none';
        googleButton.style.padding = '10px 20px';
        googleButton.style.borderRadius = '5px';
        googleButton.style.cursor = 'pointer';
        googleButton.style.marginBottom = '-4px';
        googleButton.style.marginTop = '7px';
        googleButton.style.display = 'flex';

        googleButton.addEventListener('click', () => {
            const provider = new firebase.auth.GoogleAuthProvider();
            firebase.auth().signInWithPopup(provider)
                .then(result => {
                    alert(`Logged in as ${result.user.displayName}`);
                    updateLoginButton(result.user);
                    updatelikedPostsButton(result.user);
                    document.body.removeChild(loginContainer); // Remove modal
                })
                .catch(error => console.error('Login error:', error));
        });

        // Email/Password Login Form
        const emailForm = document.createElement('form');
        emailForm.innerHTML = `
            <input type="email" id="emailInput" placeholder="Enter your email" style="display: block; width: 90%; margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" required>
            <input type="password" id="passwordInput" placeholder="Enter your password" style="display: block; width: 90%; margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" required>
            <button type="submit" id="emailoginbutton" style="background-color: #00aaff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Login</button>
        `;

        emailForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passwordInput').value;

            firebase.auth().signInWithEmailAndPassword(email, password)
                .then(result => {
                    alert(`Logged in as ${result.user.email}`);
                    updateLoginButton(result.user);
                    updatelikedPostsButton(result.user);
                    document.body.removeChild(loginContainer); // Remove modal
                })
                .catch(error => {
                    console.error('Login error:', error);
                });
        });

        // "New to Horizon? Sign up here" Button
        const signupButton = document.createElement('button');
        signupButton.innerText = 'New to Horizon? Sign up here';
        signupButton.style.fontSize = '14px';
        signupButton.style.color = '#007BFF';
        signupButton.style.backgroundColor = 'transparent';
        signupButton.style.border = 'none';
        signupButton.style.cursor = 'pointer';
        signupButton.style.marginTop = '10px';

        signupButton.addEventListener('click', () => {
            // Show sign-up form modal
            const signupContainer = document.createElement('div');
            signupContainer.setAttribute('id', 'signupContainer');
            signupContainer.style.position = 'fixed';
            signupContainer.style.top = '50%';
            signupContainer.style.left = '50%';
            signupContainer.style.transform = 'translate(-50%, -50%)';
            signupContainer.style.backgroundColor = 'white';
            signupContainer.style.padding = '20px';
            signupContainer.style.borderRadius = '10px';
            signupContainer.style.boxShadow = '0 4px 8px rgba(0, 0, 0, 0.2)';
            signupContainer.style.textAlign = 'center';
            signupContainer.style.zIndex = '1000';

            const signupForm = document.createElement('form');
            signupForm.innerHTML = `
                <input type="email" id="signupEmailInput" placeholder="Enter your email" style="display: block; width: 100%; margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" required>
                <input type="password" id="signupPasswordInput" placeholder="Enter your password" style="display: block; width: 100%; margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" required>
                <button type="submit" style="background-color: #FF5A5F; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Sign Up</button>
            `;

            signupForm.addEventListener('submit', (e) => {
                e.preventDefault();

                const email = document.getElementById('signupEmailInput').value;
                const password = document.getElementById('signupPasswordInput').value;

                firebase.auth().createUserWithEmailAndPassword(email, password)
                    .then(result => {
                        alert(`Account created for ${result.user.email}`);
                        updateLoginButton(result.user);
                        updatelikedPostsButton(result.user);
                        document.body.removeChild(signupContainer); // Remove sign-up modal
                        document.body.removeChild(loginContainer); // Remove login modal
                    })
                    .catch(err => console.error('Account creation error:', err));
            });

            // Close Button for Signup Modal
            const closeSignupButton = document.createElement('span');
            closeSignupButton.innerHTML = '&times;';
            closeSignupButton.style.position = 'absolute';
            closeSignupButton.style.top = '5px';
            closeSignupButton.style.right = '10px';
            closeSignupButton.style.cursor = 'pointer';
            closeSignupButton.style.fontSize = '20px';
            closeSignupButton.style.color = 'rgba(255, 255, 255, 1);';
            closeSignupButton.style.top = '0px';




            closeSignupButton.addEventListener('click', () => {
                document.body.removeChild(signupContainer); // Close sign-up modal
            });

            signupContainer.appendChild(closeSignupButton);
            signupContainer.appendChild(signupForm);
            document.body.appendChild(signupContainer);
        });

        // Close Button for Login Modal
        const closeButton2 = document.createElement('span');
        closeButton2.innerHTML = '&times;';
        closeButton2.style.position = 'absolute';
        closeButton2.style.top = '0px';
        closeButton2.style.color = 'white';
        closeButton2.style.right = '9px';
        closeButton2.style.cursor = 'pointer';
        closeButton2.style.fontSize = '20px';

        closeButton2.addEventListener('click', () => {
            document.body.removeChild(loginContainer); // Close modal
        });

        loginContainer.appendChild(closeButton2);
        loginContainer.appendChild(googleButton);
        const orText = document.createElement('p');
        orText.innerText = 'or';
        orText.style.fontFamily = 'system-ui'; // Set the font family
        orText.style.color = 'rgba(255, 255, 255, 1)'; // Set the color
        loginContainer.appendChild(orText); // Append the styled <p> element
        loginContainer.appendChild(emailForm);
        loginContainer.appendChild(signupButton);

        document.body.appendChild(loginContainer);
    }
});

// Update button text based on login state
function updateLoginButton(user) {
    const loginButton = document.getElementById('loginButton');
    if (user) {
        loginButton.innerHTML = `
            <img src="js/profile-icon2.png" alt="Profile Icon" style="width: 24px; height: 24px; margin-right: 8px;"> Logout`;
    } else {
        loginButton.innerHTML = `
            <img src="js/profile-icon.png" alt="Profile Icon" style="width: 24px; height: 24px; margin-right: 8px;"> Login`;
    }
}



// Update button text based on login state
function updatelikedPostsButton(user) {
    const likedPostsButton = document.getElementById('likedPostsButton');
    if (user) {
        // Show "Logout" when user is logged in
        likedPostsButton.innerHTML = `
            <img src="js/heart-2.png" alt="liked posts Icon" style="width: 24px; display:flex; align-items: center; height: 24px; margin-right: 0px; margin-top: 1.5px;">`;
    } else {
        // Show "Login" when no user is logged in
        likedPostsButton.innerHTML = `
            <img src="js/heart.png" alt="liked posts Icon" style="width: 24px; display:flex; align-items: center; height: 24px; margin-right: 0px; margin-top: 1.5px;">`;
    }
}

// Set initial button state on page load
firebase.auth().onAuthStateChanged(user => {
    updateLoginButton(user); // Update button based on current auth state
});*/
// Import Firebase and required services
/*import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
import {
    getAuth,
    onAuthStateChanged,
    signInWithPopup,
    GoogleAuthProvider,
    signOut,
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword
} from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";

// Firebase configuration
const firebaseConfig = {
    apiKey: "AIzaSyBP9WtBgIHmpavBQHnG0LxXcyfK7GM5_Q4",
    authDomain: "horizon-flights.firebaseapp.com",
    projectId: "horizon-flights",
    storageBucket: "horizon-flights.appspot.com",
    messagingSenderId: "173542786157",
    appId: "1:173542786157:web:073fb82c209555d9432b64",
    measurementId: "G-4KJF5LVT0R"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);

// Initialize Firebase Authentication
const auth = getAuth(app);

// Handle Login/Logout when the login button is clicked
document.getElementById("loginButton").addEventListener("click", () => {
    const user = auth.currentUser;

    if (user) {
        // User is logged in, handle logout
        signOut(auth)
            .then(() => {
                alert("Logged out successfully.");
                updateLoginButton(null); // Update the button to show "Login"
                updatelikedPostsButton(null);
            })
            .catch((error) => console.error("Error during logout:", error));
    } else {
        // Show login modal with options
        const loginContainer = document.createElement("div");
        loginContainer.setAttribute("id", "loginContainer");
        loginContainer.style.position = "fixed";
        loginContainer.style.top = "50%";
        loginContainer.style.left = "50%";
        loginContainer.style.transform = "translate(-50%, -50%)";
        loginContainer.style.backgroundColor = "rgba(255, 255, 255, 0.15)";
        loginContainer.style.padding = "20px";
        loginContainer.style.borderRadius = "10px";
        loginContainer.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.2)";
        loginContainer.style.textAlign = "center";
        loginContainer.style.zIndex = "22012";

        // Google Login Button
        const googleButton = document.createElement("button");
        googleButton.innerHTML = `
            <img src="js/transparent-google-logo-google-logo-blue-circle-with-g-1710875609249.png" alt="Google Icon" style="width: 40px; height: 40px; margin-right: 10px;">
            Continue with Google
        `;
        googleButton.style.backgroundColor = "#4285F4";
        googleButton.style.color = "white";
        googleButton.style.border = "none";
        googleButton.style.padding = "10px 20px";
        googleButton.style.borderRadius = "5px";
        googleButton.style.cursor = "pointer";
        googleButton.style.marginBottom = "-4px";
        googleButton.style.marginTop = "7px";
        googleButton.style.display = "flex";

        googleButton.addEventListener("click", () => {
            const provider = new GoogleAuthProvider();
            signInWithPopup(auth, provider)
                .then((result) => {
                    alert(`Logged in as ${result.user.displayName}`);
                    updateLoginButton(result.user);
                    updatelikedPostsButton(result.user);
                    document.body.removeChild(loginContainer); // Remove modal
                })
                .catch((error) => console.error("Login error:", error));
        });

        // Email/Password Login Form
        const emailForm = document.createElement("form");
        emailForm.innerHTML = `
            <input type="email" id="emailInput" placeholder="Enter your email" style="display: block; width: 90%; margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" required>
            <input type="password" id="passwordInput" placeholder="Enter your password" style="display: block; width: 90%; margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" required>
            <button type="submit" id="emailLoginButton" style="background-color: #00aaff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Login</button>
        `;

        emailForm.addEventListener("submit", (e) => {
            e.preventDefault();

            const email = document.getElementById("emailInput").value;
            const password = document.getElementById("passwordInput").value;

            signInWithEmailAndPassword(auth, email, password)
                .then((result) => {
                    alert(`Logged in as ${result.user.email}`);
                    updateLoginButton(result.user);
                    updatelikedPostsButton(result.user);
                    document.body.removeChild(loginContainer); // Remove modal
                })
                .catch((error) => {
                    console.error("Login error:", error);
                });
        });

        // Append elements to the login modal
        loginContainer.appendChild(googleButton);
        loginContainer.appendChild(document.createElement("br"));
        loginContainer.appendChild(emailForm);
        document.body.appendChild(loginContainer);
    }
});

// Update Login Button State
function updateLoginButton(user) {
    const loginButton = document.getElementById("loginButton");
    if (user) {
        loginButton.innerHTML = `
            <img src="js/profile-icon2.png" alt="Profile Icon" style="width: 24px; height: 24px; margin-right: 8px;"> Logout`;
    } else {
        loginButton.innerHTML = `
            <img src="js/profile-icon.png" alt="Profile Icon" style="width: 24px; height: 24px; margin-right: 8px;"> Login`;
    }
}

// Update Liked Posts Button State
function updatelikedPostsButton(user) {
    const likedPostsButton = document.getElementById("likedPostsButton");
    if (user) {
        likedPostsButton.innerHTML = `
            <img src="js/heart-2.png" alt="Liked Posts Icon" style="width: 24px; display: flex; align-items: center; height: 24px; margin-right: 0px; margin-top: 1.5px;">`;
    } else {
        likedPostsButton.innerHTML = `
            <img src="js/heart.png" alt="Liked Posts Icon" style="width: 24px; display: flex; align-items: center; height: 24px; margin-right: 0px; margin-top: 1.5px;">`;
    }
}

// Track Authentication State Changes
onAuthStateChanged(auth, (user) => {
    updateLoginButton(user); // Update button state based on auth state
    updatelikedPostsButton(user);
});*/


// Get references to elements
/*const loginButton = document.getElementById('loginButton');
const dropdownMenu = document.getElementById('dropdownMenu');
const loginLogoutLink = document.getElementById('loginLogoutLink');

// Toggle dropdown visibility
loginButton.addEventListener('click', (event) => {
  event.stopPropagation(); // Prevent event from bubbling up
  dropdownMenu.classList.toggle('show');
});

// Close the dropdown when clicking outside of it
document.addEventListener('click', () => {
  dropdownMenu.classList.remove('show');
});

// Handle login/logout functionality
loginLogoutLink.addEventListener('click', (event) => {
  event.preventDefault(); // Prevent default link behavior
  const user = firebase.auth().currentUser;

  if (user) {
    // Logout
    firebase.auth().signOut().then(() => {
      alert('Logged out successfully.');
      updateDropdownMenu(null);
    }).catch(error => console.error('Error during logout:', error));
  } else {
    // Login
    const provider = new firebase.auth.GoogleAuthProvider();
    firebase.auth().signInWithPopup(provider)
      .then(result => {
        alert(`Logged in as ${result.user.displayName}`);
        updateDropdownMenu(result.user);
      }).catch(error => console.error('Login error:', error));
  }
});

// Update dropdown menu based on user state
function updateDropdownMenu(user) {
  if (user) {
    loginLogoutLink.textContent = 'Logout';
  } else {
    loginLogoutLink.textContent = 'Login';
  }
}

// Set initial dropdown state
firebase.auth().onAuthStateChanged(user => {
  updateDropdownMenu(user);
});*/






// Show loading screen and switch SVGs
document.addEventListener('DOMContentLoaded', () => {
  const loadingScreen = document.getElementById('loadingScreen');
  const loader1 = document.getElementById('loader1');
  const loader2 = document.getElementById('loader2');
  // Show first loader for 5 seconds
  setTimeout(() => {
    loader1.style.display = 'none';
    loader2.style.display = 'block'; // Show second loader
  }, 5000);

  // Hide loading screen after 10 seconds
  setTimeout(() => {
    loadingScreen.style.display = 'none';
  }, 10000);
});

// Show instructions after clicking the Submit Region button
document.getElementById('submitRegion').addEventListener('click', () => {
  const instructionsOverlay = document.getElementById('instructionsOverlay');
  const gotItBtn = document.getElementById('gotItBtn');

  // Show the instructions overlay
  instructionsOverlay.classList.remove('hidden');

  // Delay showing "Got It" button until instructions are shown
  setTimeout(() => {
    gotItBtn.classList.remove('hidden');
  }, 30000); // Delay for visual effect

  let currentStep = 0;
  const steps = document.querySelectorAll('.instruction-step');

  // Initially hide all steps
  steps.forEach(step => step.classList.add('hidden'));

  // Show the first step
  steps[currentStep].classList.remove('hidden');

  // Cycle through steps every 5 seconds
  const showNextStep = () => {
    steps[currentStep].classList.add('hidden');
    currentStep++;
    if (currentStep < steps.length) {
      steps[currentStep].classList.remove('hidden');
    } else {
      clearInterval(stepInterval); // Stop cycling after the last step
    }
  };

  const stepInterval = setInterval(showNextStep, 15000);

  // Close instructions when "Got It" button is clicked
  gotItBtn.addEventListener('click', () => {
    instructionsOverlay.classList.add('hidden'); // Hide instructions overlay
    gotItBtn.classList.add('hidden'); // Hide "Got It" button
    clearInterval(stepInterval); // Stop cycling steps
    const selectedRegion = document.getElementById('regionSelect').value;
    panToRegion(selectedRegion);
    controls.autoRotate = true; // Resume autorotation
    const confirmationMessage = document.getElementById('confirmationMessage');
    confirmationMessage.style.display = 'none'; // Show confirmation message
    // Create a flight path and animate the plane
    const { flightPath, curve, distance } = createFlightPath(fromVector, toVector, earthRadius * 1.1);

// Load and animate the plane
const loader = new GLTFLoader();
loader.load('js/cartoon_low_poly_private_jet/scene.gltf', function (gltf) {
    const plane = gltf.scene;
    scene.add(plane);
    //plane.scale.set(0.1, 0.1, 0.1);

    // Update plane materials
    plane.traverse((child) => {
        if (child.isMesh) {
            const materialName = child.material.name;

            // Update specific materials
            if (materialName === 'body') child.material.color.set(0xffffff);
            if (materialName === 'orange') child.material.color.set(0xffffff);
            if (materialName === 'glass') child.material.color.set(0x000000);
            if (materialName === 'Jet__0') child.material.color.set(0xaaaaaa);
        }
    });
    if (animatePlane(plane, curve, 5000, distance)) {
        // Ensure the animation is running
        animatePlane(plane, curve, 5000, distance).start();
    }
});
    setTimeout(() => {
      confirmationMessage.style.display = 'none';
    }, 20000); // Hide confirmation message after 20 seconds
  });
});



// Start loading process as soon as the page starts loading
// Use window.onload to ensure the script runs when the page is fully loaded
  /*window.onload = function () {
    console.log('Page loaded, showing overlay.');
    const overlay = document.getElementById('loading-overlay');

// Ensure it's visible
overlay.style.display = 'block';
overlay.style.visibility = 'visible';  // Reset visibility in case it's hidden
overlay.style.pointerEvents = 'auto'; // Allow interaction if needed

    // Show the first loader for 5 seconds, then switch to the second loader
    setTimeout(showSecondLoader, 5000);  // Wait 5 seconds before switching to the second loader
  };*/


const earthRadius = 5.1; // Adjust this to match your globe's size
const textureLoader = new THREE.TextureLoader();
let dayTexture = textureLoader.load("js/Earth_Diffuse.jpg");
const LightsTexture = textureLoader.load("js/earth.jpg");
const bumpMap = textureLoader.load("js/Earth-16K-Bump.png");
const normalMap = textureLoader.load('js/Earth_Normal.jpg'); // Use a realistic normal map
const specularMap = textureLoader.load("js/Earth_Specular.jpg");
let earthMaterial = new THREE.ShaderMaterial({
  uniforms: {
    // Day texture, bump map, normal map, specular map, etc.
    map: { value: dayTexture },
    bumpMap: { value: bumpMap },
    normalMap: { value: normalMap },
    specularMap: { value: specularMap },
    bumpScale: { value: 0.05 },
    specularColor: { value: new THREE.Color('grey') },  // Specular color
    shininess: { value: 15 },
    // Custom uniforms for glow, scale, bias, etc.
    glowColor: { value: new THREE.Color(0x0cd1eb) },  // Glow color
    scale: { type: "f", value: -1.0 },  // Scale for glow
    bias: { type: "f", value: 1.0 },  // Bias for glow effect
    power: { type: "f", value: 3.3 },  // Power of glow intensity
    time: { type: "f", value: 0 },  // Time for animation effects
    isHover: { value: false },  // Whether the globe is being hovered over
  },
      vertexShader: document.getElementById('vertexShader').textContent,
      fragmentShader: document.getElementById('fragmentShader').textContent,
    });
    let globe2;
    function createEarthGlow() {
    const R = 5.099
    const texture2 = textureLoader.load("js/glow.png");

    const spriteMaterial = new THREE.SpriteMaterial({
      map: texture2,
      color: 0x4390d1,
      transparent: true,
      opacity: 1.5,
      depthWrite: false,
    });
    const sprite = new THREE.Sprite(spriteMaterial);
    sprite.scale.set(R * 3.0, R * 3.0, 1);
    globe2.add(sprite);
  };
  function createEarthAperture() {
    const AeroSphere = {
      uniforms: {
        coeficient: {
          value: 1.0,
        },
        power: {
          value: 3,
        },
        glowColor: {
          value: new THREE.Color(0x4390d1),
        },
      },
      vertexShader: document.getElementById('aeroVertexShader').textContent,
      fragmentShader: document.getElementById('aeroFragmentShader').textContent,
    };
  const apmaterial = new THREE.ShaderMaterial({
      uniforms: AeroSphere.uniforms,
      vertexShader: AeroSphere.vertexShader,
      fragmentShader: AeroSphere.fragmentShader,
      blending: THREE.NormalBlending,
      transparent: true,
      depthWrite: false,
    });
    // Setting the radius, width segments, and height segments
const sphere = new THREE.SphereGeometry(
  5.099,  // radius
  128.1,        // widthSegments
  128.1         // heightSegments
);
    const mesh = new THREE.Mesh(sphere, apmaterial);
     globe2.add(mesh);
  }


  //async function createMarkupPoint(options) {
  

  const renderer = new THREE.WebGLRenderer({ antialias: true });
  //renderer.setSize(innerWidth, innerHeight);
  //renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setPixelRatio(window.devicePixelRatio);
  document.body.appendChild(renderer.domElement);
  
  // Label Renderer
  const labelRenderer = new CSS2DRenderer();
  labelRenderer.setSize(innerWidth, innerHeight);
  labelRenderer.domElement.style.position = 'absolute';
  labelRenderer.domElement.style.top = '0px';
  document.body.appendChild(labelRenderer.domElement);
  
  // Controls
  let controls = new OrbitControls(camera, labelRenderer.domElement);
  //controls.enableZoom = true;
  controls.enablePan = false;
  //controls.enableDamping = true; // Smooth the motion
  controls.enableDamping = true;
  controls.dampingFactor = 0.05;
  //controls.dampingFactor = 0.25;
  controls.enableZoom = true;
  controls.minDistance = 15;
  controls.maxDistance = 30;
  controls.autoRotate = true;
  controls.autoRotateSpeed = 0.5;
  controls.enabled = true;
renderer.domElement.addEventListener('mousedown', function(event) {
    event.preventDefault(); // Prevent default behavior
    controls.enabled = true; // Enable dragging
});

renderer.domElement.addEventListener('mouseup', function() {
    controls.enabled = true; // Ensure controls are active after drag
});


   // Lighting - Reduced intensity to reduce glare
    /*const ambientLight = new THREE.AmbientLight(0xffffff, 0.6); // Soft ambient light
    scene.add(ambientLight);

    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.4); // Reduced intensity
    directionalLight.position.set(5, 5, 5); // Adjust position
    scene.add(directionalLight);*/
  
  // Global Uniforms
  const globalUniforms = {
    time: { value: 0 },
  };
  
  // Handle Window Resize
  window.addEventListener('resize', onWindowResize);
  
  function onWindowResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
    labelRenderer.setSize(window.innerWidth, window.innerHeight);
}
	  window.addEventListener('resize', () => {
    if (window.renderer && window.camera) {
        const newWidth = globeContainer.clientWidth;
        const newHeight = globeContainer.clientHeight;
        window.renderer.setSize(newWidth, newHeight);
        window.camera.aspect = newWidth / newHeight;
        window.camera.updateProjectionMatrix();
    }
});
let isDay = true; // Track whether it's currently day or night
	  //let dayTexture, nightTexture;
	  let rt;

	  let texture;

/*document.getElementById('newsButton').addEventListener('click', function() {
  if (isDay) {
    const newsOverlaynighttheme = document.getElementById('newsOverlaynighttheme');  
    const newsOverlay = document.getElementById('newsOverlay');

    newsOverlaynighttheme.style.display = 'flex';  // Show the night theme news overlay
    newsOverlay.style.display = 'none';  // Hide the day theme news overlay

    const closeNewsButton = document.getElementById('closeNewsButton');
    closeNewsButton.style.display = 'flex';  // Show the close button

  } else {
    const newsOverlay = document.getElementById('newsOverlay');
    const newsOverlaynighttheme = document.getElementById('newsOverlaynighttheme');

    newsOverlay.style.display = 'flex';  // Show the day theme news overlay
    newsOverlaynighttheme.style.display = 'none';  // Hide the night theme news overlay

    const closeNewsButton = document.getElementById('closeNewsButton');
    closeNewsButton.style.display = 'flex';  // Show the close button
  }

  // Toggle day/night mode
  isDay = !isDay;
}); // This closes the addEventListener function correctly
*/
	  /*document.getElementById('newsButton').addEventListener('click', function() {
  const newsOverlayDay = document.getElementById('newsOverlay');
  const newsOverlayNight = document.getElementById('newsOverlaynighttheme');
  const closeNewsButton = document.getElementById('closeNewsButton');
		  if (isDay) {
    // Show day theme news overlay
    newsOverlayDay.style.display = 'flex';
    newsOverlayNight.style.display = 'none';
  } else {
    // Show night theme news overlay
    newsOverlayNight.style.display = 'flex';
    newsOverlayDay.style.display = 'none';
  }

  // Display the close button in both cases
  closeNewsButton.style.display = 'flex';

	  });*/
    document.getElementById('newsButton').addEventListener('click', function () {
    const newsOverlay = document.getElementById('newsOverlay');
    const closeNewsButton = document.getElementById('closeNewsButton');
    const newsButton = document.getElementById('newsButton');
    if (newsButton.textContent === "\u00A0\u00A0\u00A0Travel Blog") {
      newsButton.textContent = "\u00A0\u00A0\u00A0Travel Blog";
    } else {
      newsButton.textContent = "\u00A0\u00A0\u00A0Travel Blog";
    }
    // Set the content dynamically
    newsOverlay.innerHTML = `
        <div class="blog-container" style="padding: 20px; background: rgba(255, 255, 255, 0.15); border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); max-width: 800px; margin: auto; color: rgba(255, 255, 255, 1); overflow-y: auto; position: relative; top: 65px; max-height: 74%;">
            <h1 style="margin-bottom: 20px; color: rgba(255, 255, 255, 1);">Top 10 Hotels in So Paulo for Under 100</h1>
            <p style="margin-bottom: 20px;">Looking for a luxurious yet affordable stay in So Paulo? Heres our curated list of budget-friendly hotels where comfort meets affordability. Perfect for solo travelers, couples, or families!</p>
            
            <h2 style="margin-bottom: 15px; color: rgba(255, 255, 255, 1);">1. Hotel Fasano So Paulo</h2>
            <img src="js/hotel-fasano-rio-de-janeiro.jpg" alt="Hotel Fasano So Paulo" style="width: 100%; height: auto; border-radius: 10px; margin-bottom: 15px;">
            <p style="margin-bottom: 15px;">Stay in the heart of So Paulo with rooms starting at just 95. Enjoy a rooftop pool, world-class dining, and exceptional hospitality.</p>
            <p style="margin-bottom: 30px;"><a href="https://www.booking.com/hotel-fasano" target="_blank" style="color: rgba(255, 255, 255, 1); text-decoration: underline;">Book now on Booking.com</a></p>

            <h2 style="margin-bottom: 15px; color: rgba(255, 255, 255, 1);">2. Selina Madalena So Paulo</h2>
            <img src="js/selina-coworking-madalena-building.jpg" alt="Selina Madalena So Paulo" style="width: 100%; height: auto; border-radius: 10px; margin-bottom: 15px;">
            <p style="margin-bottom: 15px;">Trendy, vibrant, and budget-friendly. Rooms start at 60, offering coworking spaces and a buzzing social scene.</p>
            <p style="margin-bottom: 30px;"><a href="https://www.hostelworld.com/selina-madalena" target="_blank" style="color: rgba(255, 255, 255, 1); text-decoration: underline;">Check prices on Hostelworld</a></p>

            <h3 style="margin-bottom: 15px; color: rgba(255, 255, 255, 1);">Other Noteworthy Hotels:</h3>
            <ul style="margin-left: 20px; margin-bottom: 30px;">
                <li style="margin-bottom: 10px; color: rgba(255, 255, 255, 1);"><strong>Renaissance So Paulo Hotel</strong>  90/night. 
                    <a href="https://www.marriott.com/renaissance-sp" target="_blank" style="color: rgba(255, 255, 255, 1); text-decoration: underline;">Book on Marriott</a>
                </li>
                <li style="margin-bottom: 10px; color: rgba(255, 255, 255, 1);"><strong>Mercure So Paulo Jardins</strong>  75/night. 
                    <a href="https://www.booking.com/mercure-jardins" target="_blank" style="color: rgba(255, 255, 255, 1); text-decoration: underline;">Reserve on Booking.com</a>
                </li>
                <li style="margin-bottom: 10px; color: rgba(255, 255, 255, 1);"><strong>Radisson Paulista</strong>  80/night. 
                    <a href="https://www.radisson.com/paulista" target="_blank" style="color: rgba(255, 255, 255, 1); text-decoration: underline;">View deals on Radisson</a>
                </li>
            </ul>

            <h2 style="margin-bottom: 15px; color: rgba(255, 255, 255, 1);">Why So Paulo?</h2>
            <p style="margin-bottom: 30px;">So Paulo offers a dynamic mix of culture, food, and vibrant nightlife. Staying at these budget-friendly hotels ensures you can explore more while spending less on accommodations.</p>
            
            <h2 style="margin-bottom: 15px; color: rgba(255, 255, 255, 1);">Ready to Book?</h2>
            <p style="margin-bottom: 30px;">Dont wait! These deals wont last long. Click the links to book your perfect stay in So Paulo.</p>

            <!-- New Blog Posts -->
    <h2 style="margin-bottom: 15px; color: rgba(255, 255, 255, 1);">A Beginners Guide to Booking Cheap Flights</h2>
    <img src="js/cheap-flights-guide.jpg" alt="Booking Cheap Flights" style="width: 100%; height: auto; border-radius: 10px; margin-bottom: 15px;">
    <p style="margin-bottom: 15px;">Master the art of finding cheap flights with these insider tips and tricks. Save money and travel smarter!</p>
    <p style="margin-bottom: 30px;"><a href="A_Beginners_Guide_to_Booking_Cheap_Flights.html" target="_blank" style="color: rgba(255, 255, 255, 1); text-decoration: underline;">Read More</a></p>

    <h2 style="margin-bottom: 15px; color: rgba(255, 255, 255, 1);">Affordable Winter Getaways Around the World</h2>
    <img src="js/winter-getaways--.jpg" alt="Winter Getaways" style="width: 100%; height: auto; border-radius: 10px; margin-bottom: 15px;">
    <p style="margin-bottom: 15px;">Escape the cold or embrace it! Here are the best budget-friendly winter holiday destinations for 2025.</p>
    <p style="margin-bottom: 30px;"><a href="Affordable_Winter_Getaways_Around_the_World.html" target="_blank" style="color: rgba(255, 255, 255, 1); text-decoration: underline;">Read More</a></p>

    <h2 style="margin-bottom: 15px; color: rgba(255, 255, 255, 1);">Best Cities for Solo Travel in 2025</h2>
    <img src="js/solo-travel-cities--.jpg" alt="Solo Travel" style="width: 100%; height: auto; border-radius: 10px; margin-bottom: 15px;">
    <p style="margin-bottom: 15px;">From Tokyo to Lisbon, explore the safest and most exciting cities for solo travelers in 2025.</p>
    <p style="margin-bottom: 30px;"><a href="Best_Cities_for_Solo_Travel_in_2025.html" target="_blank" style="color: rgba(255, 255, 255, 1); text-decoration: underline;">Read More</a></p>

    <h2 style="margin-bottom: 15px; color: rgba(255, 255, 255, 1);">Hidden Gems in Morocco for Budget Travellers</h2>
    <img src="js/morocco-hidden-gems--.jpg" alt="Hidden Gems in Morocco" style="width: 100%; height: auto; border-radius: 10px; margin-bottom: 15px;">
    <p style="margin-bottom: 15px;">Explore Morocco beyond Marrakech! These hidden spots will make your trip unforgettable and affordable.</p>
    <p style="margin-bottom: 30px;"><a href="Hidden_Gems_in_Morocco_for_Budget_Travellers.html" target="_blank" style="color: rgba(255, 255, 255, 1); text-decoration: underline;">Read More</a></p>

    <h2 style="margin-bottom: 15px; color: rgba(255, 255, 255, 1);">The Best Beaches in the Caribbean and How to Get There</h2>
    <img src="js/caribbean-beaches--.jpg" alt="Caribbean Beaches" style="width: 100%; height: auto; border-radius: 10px; margin-bottom: 15px;">
    <p style="margin-bottom: 15px;">Crystal clear waters, white sand, and tropical vibes  find out how to visit the best Caribbean beaches affordably.</p>
    <p style="margin-bottom: 30px;"><a href="Best_Beaches_in_the_Caribbean_How_to_Get_There.html" target="_blank" style="color: rgba(255, 255, 255, 1); text-decoration: underline;">Read More</a></p>

    <h2 style="margin-bottom: 15px; color: rgba(255, 255, 255, 1);">Travel Hacks: Save Money on Flights and Hotels</h2>
    <img src="js/travel-hacks--.jpg" alt="Travel Hacks" style="width: 100%; height: auto; border-radius: 10px; margin-bottom: 15px;">
    <p style="margin-bottom: 15px;">Maximize your travel budget with these expert hacks for flights, hotels, and hidden discounts.</p>
    <p style="margin-bottom: 30px;"><a href="Travel_Hacks_Save_Money_on_Flights_and_Hotels.html" target="_blank" style="color: rgba(255, 255, 255, 1); text-decoration: underline;">Read More</a></p>
        </div>
    `;

    // Show the overlay and close button
    newsOverlay.style.display = 'flex';
    closeNewsButton.style.display = 'flex';
});

// Close button functionality
document.getElementById('closeNewsButton').addEventListener('click', function () {
    const newsOverlay = document.getElementById('newsOverlay');
    const closeNewsButton = document.getElementById('closeNewsButton');
    if (newsButton.textContent === "\u00A0\u00A0\u00A0Travel Blog") {
      newsButton.textContent = "\u00A0\u00A0\u00A0Travel Blog";
    } else {
      newsButton.textContent = "\u00A0\u00A0\u00A0Travel Blog";
    }
    // Hide the overlay and close button
    newsOverlay.style.display = 'none';
    closeNewsButton.style.display = 'none';
});


		  
	
  //const selectedRegion = document.getElementById('regionSelect').value;

		  /*document.addEventListener("DOMContentLoaded", function() {
			  
  // Your existing event listeners and code go here
			  
  document.getElementById('submitRegion').addEventListener('click', function() {
  // Close the initial region popup
  document.getElementById('regionPopup').style.display = 'none';

  // Show the confirmation message
  document.getElementById('confirmationMessage').style.display = 'block';

  // Hide the confirmation message after 5 seconds
  setTimeout(function() {
    document.getElementById('confirmationMessage').style.display = 'none';
  }, 10000);
// Pan to the selected region
  panToRegion(selectedRegion);
});
});*/
	    

 /*  // Always visible region select button
  document.getElementById('regionSelectBtn').style.display = 'block';

  document.getElementById('regionSelectBtn').addEventListener('click', function() {
    // Check if dropdown already exists to avoid adding multiple
    if (!document.getElementById('regionSelectDropdown')) {
      // Create the dropdown menu with regions
      let regionSelect = document.createElement('select');
      regionSelect.id = 'regionSelectDropdown';
      regionSelect.innerHTML = `
        <option value="africa">Africa</option>
        <option value="europe">Europe</option>
        <option value="america">America</option>
        <option value="south america">South America</option>
        <option value="carribbean">Carribbean</option>
        <option value="asia">Asia</option>
	<option value="world">World</option>
      `;
      
      this.insertAdjacentElement('afterend', regionSelect);

// Ensure it's visible and styled correctly
    regionSelect.style.display = 'block';

      // Pan the camera to the selected region when changed
      regionSelect.addEventListener('change', function() {
        let selectedRegion = this.value;
        panToRegion(selectedRegion); // Call pan function with selected region
      });
    }
  });
*/
// Function to stop all existing tweens
function stopAllTweens() {
    TWEEN.getAll().forEach(function(tween) {
        tween.stop(); // Stop each tween
    });
}/*
  // Function to pan the camera to the selected region
  // Function to pan the camera to the selected region
	function panToRegion(region) {
    let position;
    let zoomLevel;

    // Reset zoom to default value before transitioning
    camera.zoom = 1;
    camera.updateProjectionMatrix(); // Apply the reset zoom value

    switch (region) {
        case 'africa':
            position = { x: 12.0, y: 0, z: 1.74 }; // Increased the x-value to move further right
            zoomLevel = 1.5; // Adjust zoom level as needed
            break;
        case 'europe':
            // Moved slightly to the right (increase in x) and zoomed in more
            position = { x: 3.5, y: 2.91, z: 0.55 }; // Shifted right
            zoomLevel = 2.0; // Slightly more zoomed in
            break;
        case 'america':
            position = { x: 0, y: 2.55, z: 4.42 };
            zoomLevel = 2.0;
            break;
        case 'south america':
            position = { x: 1.5, y: -0.5, z: 4.3 }; // Increased x value to move further right
            zoomLevel = 1.7;
            break;
        case 'carribbean':
            position = { x: 0.65, y: 2.0, z: 4.6 }; // Adjusted for Caribbean
            zoomLevel = 2.4;
            break;
        case 'asia':
            position = { x: -0.89, y: 3.28, z: -3.92 };
            zoomLevel = 1.9;
            break;
        case 'world':
            position = { x: 0, y: 0, z: 10 }; // Zoomed-out, general view of the world
            zoomLevel = 0.5; // Reduced zoom level to show the entire Earth
            break;
        default:
            console.log('Region not recognized');
            return;
    }

    // Stop auto-rotation after panning
    controls.autoRotate = false;

    // Animate camera panning and zooming
    animateCameraPan(position.x, position.y, position.z, zoomLevel);
}

function animateCameraPan(x, y, z, zoomLevel) {
    new TWEEN.Tween(camera.position)
        .to({ x: x, y: y, z: z }, 2000) // Smoothly pan over 2 seconds
        .easing(TWEEN.Easing.Quadratic.InOut)
        .onUpdate(function () {
            camera.lookAt(0, 0, 0);
        })
        .start();

    // Add zooming to the pan
    new TWEEN.Tween(camera)
        .to({ zoom: zoomLevel }, 2000) // Adjust zoom over the same duration
        .easing(TWEEN.Easing.Quadratic.InOut)
        .onUpdate(function () {
            camera.updateProjectionMatrix(); // Important to update the camera matrix for zoom to take effect
        })
        .onComplete(function () {
            // After zoom and panning complete, restart slow auto-rotation
            setTimeout(function () {
                controls.autoRotate = true;
                controls.autoRotateSpeed = 0.25; // Slow rotation speed
            }, 500);
        })
        .start();
}*/
//const earthRadius = 5.1; // Adjust this to match your globe's size
//const textureLoader = new THREE.TextureLoader();

	  const cloudTexture2 = textureLoader.load("js/Earth_Cloud.jpg");
	  const cloudGeometry = new THREE.SphereGeometry(earthRadius * 1.005, 64, 64);
const cloudMaterial2 = new THREE.MeshPhongMaterial({
  map: cloudTexture2, // Use a high-quality cloud texture with transparency
  transparent: true,
  color: new THREE.Color('#FFFFFF'),
  opacity: 0.17 // Adjust for subtle effect
});
const cloudMesh2 = new THREE.Mesh(cloudGeometry, cloudMaterial2);
//scene.add(cloudMesh2);
function animateClouds() {
    cloudMesh2.rotation.y += 0.00027; // Adjust rotation speed
    requestAnimationFrame(animateClouds);
}
animateClouds();

	  
/*document.getElementById('searchBtn').addEventListener('click', () => {
  const where = document.getElementById('where').value;
  const when = document.getElementById('when').value;
  const guests = document.getElementById('guests').value;

  // Show results iframe
  const iframeSrc = generateAirbnbUrl(where, when, guests);
  document.getElementById('resultsIframe').src = iframeSrc;

  // Adjust layout
  document.getElementById('content').style.display = 'flex';
});*/

/*function generateAirbnbUrl(where, when, guests) {
  return `https://www.airbnb.com/s/${where}/homes?checkin=${when}&guests=${guests}`;
}
  function loadMarkersForRegion(region) {
  const markersData = getMarkersDataForRegion(region);
  markersData.forEach(marker => {
    addMarkerToGlobe(marker);
  });
}*/

	 /* document.getElementById('newsButton').addEventListener('click', function() {
  const newsOverlay = document.getElementById('newsOverlay');
  newsOverlay.style.display = 'flex';  // Show the news iframe
const closeNewsButton = document.getElementById('closeNewsButton');
  closeNewsButton.style.display = 'flex';  // Show the news iframe
});*/

document.getElementById('closeNewsButton').addEventListener('click', function() {
  document.getElementById('newsOverlay').style.display = 'none';  // Close the news iframe
document.getElementById('newsOverlaynighttheme').style.display = 'none';
document.getElementById('closeNewsButton').style.display = 'none';  // Close the news iframe
});
	  // Function to close the news overlay when clicking outside the iframe
function closeNewsOverlayOnClick(event) {
  const newsOverlay = document.getElementById('newsOverlay');
  const newsIframe = document.getElementById('newsIframe');

  // Check if the click was outside the news overlay iframe
  if (newsOverlay.style.display === 'block' && !newsIframe.contains(event.target)) {
    newsOverlay.style.display = 'none'; // Hide the overlay
  }
}

// Function to close the night theme overlay
function closeNewsOverlayNightOnClick(event) {
  const newsOverlayNight = document.getElementById('newsOverlaynighttheme');
  const newsIframeNight = document.getElementById('newsIframenighttheme');

  // Check if the click was outside the night theme overlay iframe
  if (newsOverlayNight.style.display === 'block' && !newsIframeNight.contains(event.target)) {
    newsOverlayNight.style.display = 'none'; // Hide the night theme overlay
  }
}

// Add event listeners to close overlays when clicking outside
document.addEventListener('click', closeNewsOverlayOnClick);
document.addEventListener('click', closeNewsOverlayNightOnClick);


	  
const cloudTexture = new THREE.TextureLoader().load('https://mrdoob.com/lab/javascript/webgl/clouds/cloud10.png')
  const cloudMaterial = new THREE.ShaderMaterial({
  uniforms: {
    cloudTexture: { type: 't', value: cloudTexture }
  },
  vertexShader: `
    varying vec2 vUv;
    void main() {
      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `,
  fragmentShader: `
    uniform sampler2D cloudTexture;
    varying vec2 vUv;
    void main() {
      vec4 textureColor = texture2D(cloudTexture, vUv);
      textureColor.a *= 0.9;  // Adjust opacity
      gl_FragColor = vec4(textureColor.rgb, textureColor.a);
    }
  `,
  transparent: true
});

// Create geometry and apply the shader material
const cloudGeo = new THREE.PlaneGeometry(800, 800);
const cloudMesh = new THREE.Mesh(cloudGeo, cloudMaterial);

// Position the clouds in the scene
//cloudMesh.position.set(-100, -100, -500);// Add clouds after texture is loaded
//cloudMesh.position.set(-200, -100, -700);// Add clouds after texture is loaded
  cloudMesh.position.set(-700, -100, -1000);// Add clouds after texture is loaded
// const daymarkerMaterial = '#ff3232';
 // const nightmarkerMaterial = '#FE8C02';
	  //const daymarkerMaterial = new THREE.Color('#ff3232');
//const nightmarkerMaterial = new THREE.Color('#FE8C02');
	  let daymarkerMaterial = new THREE.Color('#00BFFF');
    let lightsmarkerMaterial = new THREE.Color('#00eeff');
    let pinkthememarkerMaterial = new THREE.Color('#F56ED3');
    let GlassthememarkerMaterial = new THREE.Color('#FFFFFF');
let nightmarkerMaterial = new THREE.Color('#00BFFF');
/*let daymarkerMaterial = new THREE.Color('#1E90FF'); // DodgerBlue (Brighter Cyan-Blue)
let lightsmarkerMaterial = new THREE.Color('#00FFFF'); // Aqua (High Visibility Cyan)
let pinkthememarkerMaterial = new THREE.Color('#FF1493'); // DeepPink (Stronger Pink)
let GlassthememarkerMaterial = new THREE.Color('#FFD700'); // White (No Change)
let nightmarkerMaterial = new THREE.Color('#00AFFF');*/// Bright Azure (More Vibrant Night Blue)
	  //const daymarkerMaterial = new THREE.Color('#00FF00');
//const nightmarkerMaterial = new THREE.Color('#FFFFFF');

const markerMaterial2 = new THREE.MeshBasicMaterial({
    color: daymarkerMaterial,
    onBeforeCompile: (shader) => {
      shader.uniforms.time = globalUniforms.time;
      shader.vertexShader = `
      	attribute float phase;
        varying float vPhase;
        ${shader.vertexShader}
      `.replace(
        `#include <begin_vertex>`,
        `#include <begin_vertex>
        	vPhase = phase; // de-synch of ripples
        `
      );
      shader.fragmentShader = `
      	uniform float time;
        varying float vPhase;
      	${shader.fragmentShader}
      `.replace(
        `vec4 diffuseColor = vec4( diffuse, opacity );`,
        `
        vec2 lUv = (vUv - 0.5) * 2.;
        float val = 0.;
        float lenUv = length(lUv);
        val = max(val, 1. - step(0.25, lenUv)); // central circle
        val = max(val, step(0.4, lenUv) - step(0.5, lenUv)); // outer circle

        float tShift = fract(time * 0.5 + vPhase);
        val = max(val, step(0.4 + (tShift * 0.6), lenUv) - step(0.5 + (tShift * 0.5), lenUv)); // ripple

        if (val < 0.5) discard;

        vec4 diffuseColor = vec4( diffuse, opacity );`
      );
    },
  });
  markerMaterial2.defines = { USE_UV: '' };

    // Track loaded textures
let texturesLoaded = 0;
const totalTextures = 4; // Update this if you have more or fewer textures

function checkTexturesLoaded() {
  texturesLoaded++;
  if (texturesLoaded === totalTextures) {
    animate(); // Start animation after all textures are loaded
  }
}
	   // Check if the user is on a mobile device
    if (window.innerWidth <= 768) {  // This checks for mobile devices based on screen width
        camera.position.set(20, 0.5, 15).setLength(20);     // Set the camera's z position to 25 for mobile device
        //ocument.getElementById('header').style.display = 'none';
    } else {
        camera.position.set(20, 0.5, 15).setLength(16);    // Default z position for desktop or larger screens
        //document.getElementById('header').style.display = 'block';
    }
	  
    //let dayTexture, nightTexture;
    //let isDay = true; // Track whether it's currently day or night

// Load Textures
//const textureLoader = new THREE.TextureLoader();

// Background Texture
   /* const loader = new THREE.TextureLoader();
loader.load('textures/TCom_Aerials0006_3_L.jpg', function (texture) {
  const rt = new THREE.WebGLCubeRenderTarget(texture.image.height);
  rt.fromEquirectangularTexture(renderer, texture);
  //scene.background = rt.texture;
});*/

	  // Load the Cube Map
      const cubeTextureLoader = new THREE.CubeTextureLoader();
	  const isMobile = /Mobi/i.test(navigator.userAgent);

/*const cubeMap = cubeTextureLoader.load([
  isMobile ? 'js/px.webp' : 'js/px.png', // Right face
  isMobile ? 'js/nx.webp' : 'js/nx.png', // Left face
  isMobile ? 'js/py.webp' : 'js/py.png', // Top face
  isMobile ? 'js/ny.webp' : 'js/ny.png', // Bottom face
  isMobile ? 'js/pz.webp' : 'js/pz.png', // Front face
  isMobile ? 'js/nz.webp' : 'js/nz.png'  // Back face
]);*/
	  // Load Cube Maps for Background
    //const cubeTextureLoader = new THREE.CubeTextureLoader();
   /* const dayCubeMap = cubeTextureLoader.load([
     isMobile ? 'js/px.webp' : 'js/px.png', // Right face
  isMobile ? 'js/nx.webp' : 'js/nx.png', // Left face
  isMobile ? 'js/py.webp' : 'js/py.png', // Top face
  isMobile ? 'js/ny.webp' : 'js/ny.png', // Bottom face
  isMobile ? 'js/pz.webp' : 'js/pz.png', // Front face
  isMobile ? 'js/nz.webp' : 'js/nz.png'  // Back face
    ]);
	  const dayCubeMap2 = cubeTextureLoader.load([
     isMobile ? 'textures/px___(1).webp' : 'textures/px___(1).png', // Right face
  isMobile ? 'textures/py___(1).webp' : 'textures/py___(1).png', // Left face
  isMobile ? 'textures/py___(1).webp' : 'textures/py___(1).png', // Top face
  isMobile ? 'textures/ny___(1).webp' : 'textures/ny___(1).png', // Bottom face
  isMobile ? 'textures/pz___(1).webp' : 'textures/pz___(1).png', // Front face
  isMobile ? 'textures/nz___(1).webp' : 'textures/nz___(1).png'  // Back face
    ]);
    const nightCubeMap = cubeTextureLoader.load([
      isMobile ? 'js/px_(1).webp' : 'textures/px_(1).png', // Right face
  isMobile ? 'js/nx_(1).webp' : 'textures/nx_(1).png', // Left face
  isMobile ? 'js/py_(1).webp' : 'textures/py_(1).png', // Top face
  isMobile ? 'js/ny_(1).webp' : 'textures/ny_(1).png', // Bottom face
  isMobile ? 'js/pz_(1).webp' : 'textures/pz_(1).png', // Front face
  isMobile ? 'js/nz_(1).webp' : 'textures/nz_(1).png'  // Back face
    ]);*/
	  /*const nightCubeMap = cubeTextureLoader.load([
      isMobile ? 'js/px (1).webp' : 'js/px (1).png', // Right face
  isMobile ? 'js/nx (1).webp' : 'js/nx (1).png', // Left face
  isMobile ? 'js/py (1).webp' : 'js/py (1).png', // Top face
  isMobile ? 'js/ny (1).webp' : 'js/ny (1).png', // Bottom face
  isMobile ? 'js/pz (1).webp' : 'js/pz (1).png', // Front face
  isMobile ? 'js/nz (1).webp' : 'js/nz (1).png'  // Back face
    ]);*/

    // Set Initial Background Cube Map
   // scene.background = dayCubeMap;
   // scene.background = new THREE.Color(0x87CEEB); // Light sky blue
	 // Create a gradient for the daytime scene background
const canvas = document.createElement('canvas');
canvas.width = 1024;
canvas.height = 1024;

const context = canvas.getContext('2d');

// Create gradient from light sky blue to deep space blue
const gradient = context.createRadialGradient(512, 512, 100, 512, 512, 512);
gradient.addColorStop(0, '#87CEEB');  // Light sky blue near Earth
gradient.addColorStop(1, '#4682B4');  // Deep space blue at edges
context.fillStyle = gradient;
context.fillRect(0, 0, canvas.width, canvas.height);

// Create a texture from the canvas
const daybackgroundTexture = new THREE.CanvasTexture(canvas);

// Create a gradient for the night scene background
const canvas2 = document.createElement('canvas');
canvas2.width = 1024;
canvas2.height = 1024;

const context2 = canvas2.getContext('2d');  // Use the correct 'canvas2'

// Create gradient from dark blue to slightly lighter blue
const gradient2 = context2.createRadialGradient(512, 512, 100, 512, 512, 512);
gradient2.addColorStop(0, '#000033');  // Darker blue (center near Earth)
gradient2.addColorStop(1, '#000066');  // Slightly lighter blue for edges (space)
context2.fillStyle = gradient2;
context2.fillRect(0, 0, canvas2.width, canvas2.height);

// Create a texture from the canvas
const nightbackgroundTexture = new THREE.CanvasTexture(canvas2);
	  // Load Textures
  //const textureLoader = new THREE.TextureLoader();
  //const dayTexture = textureLoader.load("//unpkg.com/three-globe/example/img/earth-blue-marble.jpg");
	 //const dayTexture = textureLoader.load("js/Earth_Diffuse.jpg");
//const dayTexture = textureLoader.load("https://github.com/Shange-Fagan/Airbnb-Assistant/releases/download/pictures_for_earth_texture_high_res/world_shaded_43k.jpg");
    //const dayTexture = textureLoader.load("textures/earth-blue-marble-with-clouds.jpeg");
//const dayTexture = textureLoader.load("textures/8k_earth_daymap.jpg");
  let nightTexture = textureLoader.load("js/Earth-Night-16K.png");
  
/*if (maxTextureSize >= 16384) {
  nightTexture = textureLoader.load("./earth-night-12k.jpg"); // Use 16K if supported
}*/
	  //const nightTexture = textureLoader.load("//unpkg.com/three-globe/example/img/earth-night.jpg");
	  //const nightTexture = textureLoader.load("https://github.com/Shange-Fagan/Airbnb-Assistant/releases/download/pictures_for_earth_texture/earth-night-16k.jpg");
	  //const nightTexture = textureLoader.load("js/8k_earth_nightmap.jpg");
  //const bumpMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-topology.png");
  //const specularMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-water.png");
	  //const specularMap = textureLoader.load("js/Earth_Specular.jpg");
const dayBumpMap = textureLoader.load("js/Earth-16K-Bump.png");
	  //const normalMap = textureLoader.load('js/Earth_Normal.jpg'); // Use a realistic normal map
const nightBumpMap = textureLoader.load("js/Earth-16K-Bump.png");

	  //const textureLoader = new THREE.TextureLoader();

// Load the texture
/*const dayTexture = textureLoader.load(
  'js/Earth_Diffuse.jpg',
  function (texture) {
    console.log('Texture loaded successfully');
  },
  undefined,
  function (err) {
    console.error('An error occurred loading the texture: ', err);
  }
);*/


// Ensure correct wrapping
dayTexture.wrapS = THREE.ClampToEdgeWrapping;
dayTexture.wrapT = THREE.ClampToEdgeWrapping;

// Use appropriate filtering
dayTexture.minFilter = THREE.LinearFilter; // Smooths texture when zoomed
dayTexture.magFilter = THREE.LinearFilter;
dayTexture.anisotropy = renderer.capabilities.getMaxAnisotropy(); // Increases texture quality at glancing angles


	  // Ensure correct wrapping
nightTexture.wrapS = THREE.ClampToEdgeWrapping;
nightTexture.wrapT = THREE.ClampToEdgeWrapping;

// Use appropriate filtering
nightTexture.minFilter = THREE.LinearFilter;
nightTexture.magFilter = THREE.LinearFilter;
nightTexture.anisotropy = renderer.capabilities.getMaxAnisotropy(); // Increases texture quality at glancing angles

  
	  const shaderMaterial2 = new THREE.ShaderMaterial({
  uniforms: {
    dayTexture: { type: 't', value: dayTexture },
    nightTexture: { type: 't', value: nightTexture },
    transition: { value: 0 } // 0 for day, 1 for night
  },
  vertexShader: `
    varying vec2 vUv;
    void main() {
      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `,
  fragmentShader: `
    uniform sampler2D dayTexture;
    uniform sampler2D nightTexture;
    uniform float transition; // Smooth transition factor
    varying vec2 vUv;
    void main() {
      vec4 day = texture2D(dayTexture, vUv);
      vec4 night = texture2D(nightTexture, vUv);
      gl_FragColor = mix(day, night, transition);
    }
  `,
});

	// Set the background of the scene
        //scene.add(cloudMesh);
	scene.background = daybackgroundTexture;
// Toggle between Day/Night Textures and Cube Map
   /* function toggleDayNight() {
      if (isDay) {
	        // Check if the user is on a mobile device
    if (window.innerWidth <= 768) {  // This checks for mobile devices based on screen width
        document.getElementById("nightTicker").style.display = "none";
	    document.getElementById("dayTicker").style.display = "none";
	    document.getElementById("mobileTicker").style.display = "block";
	    // Set the transition to night
        new TWEEN.Tween(shaderMaterial2.uniforms.transition)
        .to({ value: 1 }, 20000)  // Smooth transition over 2 seconds
        .start();
        globe2.material.map = nightTexture;
      //scene.background = nightCubeMap;
        // Set a dark blue color for the night theme background
        //scene.background = new THREE.Color(0x000033); // Dark blue
      scene.background = nightbackgroundTexture;
	//scene.add(starField); // Add stars for the night
        scene.remove(cloudMesh); // Remove clouds for night
        markerMaterial.color.set(nightmarkerMaterial);
        document.getElementById("toggleButton").textContent = "Switch to Day";
    } else {
        // Set the transition to night
         new TWEEN.Tween(shaderMaterial2.uniforms.transition)
         .to({ value: 1 }, 20000)  // Smooth transition over 2 seconds
         .start();
        globe2.material.map = nightTexture;
      //scene.background = nightCubeMap;
        // Set a dark blue color for the night theme background
        //scene.background = new THREE.Color(0x000033); // Dark blue
      scene.background = nightbackgroundTexture;
	//scene.add(starField); // Add stars for the night
        scene.remove(cloudMesh); // Remove clouds for night
        markerMaterial.color.set(nightmarkerMaterial);
        document.getElementById("toggleButton").textContent = "Switch to Day";
        document.getElementById("dayTicker").style.display = "none";
        document.getElementById("nightTicker").style.display = "block";
	    	document.getElementById("mobileTicker").style.display = "none";

    }
        
      } else {
	      // Check if the user is on a mobile device
    if (window.innerWidth <= 768) {  // This checks for mobile devices based on screen width
        document.getElementById("nightTicker").style.display = "none";
	    document.getElementById("dayTicker").style.display = "none";
	    document.getElementById("mobileTicker").style.display = "block";
	    // Set the transition to day
        new TWEEN.Tween(shaderMaterial2.uniforms.transition)
        .to({ value: 0 }, 20000)  // Smooth transition over 2 seconds
        .start();
        globe2.material.map = dayTexture;
        //scene.background = dayCubeMap;
        // Set a solid blue color for the background
        //scene.background = new THREE.Color(0x87CEEB); // Light sky blue
	scene.background = daybackgroundTexture;
	//scene.remove(starField); // Remove stars in the day
        scene.add(cloudMesh); // Add clouds back for day
        markerMaterial.color.set(daymarkerMaterial);
        document.getElementById("toggleButton").textContent = "Switch to Night";
    } else {
	// Set the transition to day
        new TWEEN.Tween(shaderMaterial2.uniforms.transition)
        .to({ value: 0 }, 20000)  // Smooth transition over 2 seconds
        .start();
        globe2.material.map = dayTexture;
        //scene.background = dayCubeMap;
        // Set a solid blue color for the background
        //scene.background = new THREE.Color(0x87CEEB); // Light sky blue
	scene.background = daybackgroundTexture;
	//scene.remove(starField); // Remove stars in the day
        scene.add(cloudMesh); // Add clouds back for day
        markerMaterial.color.set(daymarkerMaterial);
        document.getElementById("toggleButton").textContent = "Switch to Night";
        document.getElementById("dayTicker").style.display = "block";
        document.getElementById("nightTicker").style.display = "none";
	document.getElementById("mobileTicker").style.display = "none";
		}
      }
      globe2.material.needsUpdate = true;
      isDay = !isDay;
    }

	// Add Event Listener to the Toggle Button
	    document.getElementById('toggleButton').addEventListener('click', toggleDayNight);
*/
let currentTexture = "night"; // Initialize with the default texture state ("day" or "night")
let currentmarkerMaterial = "night";
	  function toggleDayNight() {
  // Ensure `isDay` is properly toggled
  if (isDay) {
    // Switching from Day to Night
    if (window.innerWidth <= 768) {  // Mobile device
      document.getElementById("nightTicker").style.display = "none";
      document.getElementById("dayTicker").style.display = "none";
      document.getElementById("mobileTicker").style.display = "none";
    } else {  // Desktop
      //document.getElementById("dayTicker").style.display = "none";
      //document.getElementById("nightTicker").style.display = "block";
      console.log("Switching to Night Mode");
        if (currentTicker === document.getElementById("dayTicker")) {
            currentTicker.style.display = "none"; // Keep the current ticker visible
            document.getElementById("nightTicker").style.display = "none";
        }
      document.getElementById("mobileTicker").style.display = "none";
    }

    // Smooth transition to night
    new TWEEN.Tween(shaderMaterial2.uniforms.transition)
      .to({ value: 1 }, 20000)  // Smooth transition over 20 seconds
      .start();

      function createStars() {
  const vertices = [];
    const colors = [];

    for (let i = 0; i < 500; i++) {
        const vertex = new THREE.Vector3();
        vertex.x = 800 * Math.random() - 300;
        vertex.y = 800 * Math.random() - 300;
        vertex.z = 800 * Math.random() - 300;
        vertices.push(vertex.x, vertex.y, vertex.z);

        // Adding white color for each vertex
        const color = new THREE.Color(1, 1, 1);
        colors.push(color.r, color.g, color.b);
    }

    // Create a buffer geometry for the stars
    const around = new THREE.BufferGeometry();
    around.setAttribute('position', new THREE.BufferAttribute(new Float32Array(vertices), 3));
    around.setAttribute('color', new THREE.BufferAttribute(new Float32Array(colors), 3));
    // Create a material for the stars
    const aroundMaterial = new THREE.PointsMaterial({
        size: 2,
        sizeAttenuation: true,  // Enable size attenuation
        color: 0x4d76cf,        // Blue shade
        transparent: true,
        opacity: 1,
        map: new THREE.TextureLoader().load('js/gradient.png', () => {
    console.log('Gradient texture loaded directly');
  }) // Ensure texture is available in your context
    });

    // Create the Points object
    const aroundPoints = new THREE.Points(around, aroundMaterial);
    aroundPoints.name = "";  // 'Starry sky' in Chinese
    aroundPoints.scale.set(1, 1, 1);
    scene.add(aroundPoints);
  }
    // Update globe and scene for night
    //globe2.material.map = nightTexture;
    earthMaterial.uniforms.map.value = nightTexture;
    currentTexture = "night";
    scene.background = nightbackgroundTexture;
    scene.remove(cloudMesh);  // Remove clouds for night
    //createStars();
    //scene.add(aroundPoints);

  //markerMaterial.color.set(nightmarkerMaterial);
  markerMaterial.color.set(nightmarkerMaterial);
  currentmarkerMaterial = "night";
  // Switching from Day to Night
  handleThemeChange("night");
  /*const searchBtn = document.getElementById('searchBtn');
  searchBtn.style.backgroundColor = '#00aaff';
    const regionPopupButton = document.querySelector('#regionPopup button'); // Selects the button inside #regionPopup
regionPopupButton.style.backgroundColor = '#00aaff';
const loginButton = document.getElementById('loginButton');
loginButton.style.backgroundColor = '#00aaff';
const likedPostsButton = document.getElementById('likedPostsButton');
likedPostsButton.style.backgroundColor = '#00aaff';
const topLeftLabel = document.getElementById('topLeftLabel');
topLeftLabel.style.backgroundColor = '#00aaff';*/
// Add styles to inputs and selects on focus and hover
const header = document.getElementById('header');
const inputsAndSelects = header.querySelectorAll('input, select'); // Select all inputs and selects inside the header
/* Keyframes for box shadow pulse animation */
inputsAndSelects.forEach((element) => {
  // Add focus style
  element.addEventListener('focus', () => {
    element.style.boxShadow = '0 0 9px rgb(255, 169, 21)';
    //element.style.animation = 'pulseShadow2 0.6s ease-in-out infinite alternate';
  });

  element.addEventListener('hover', () => {
    element.style.boxShadow = '0 0 9px rgb(255, 169, 21)';
    //element.style.animation = 'pulseShadow2 0.6s ease-in-out infinite alternate';
  });

  // Remove focus style on blur
  element.addEventListener('blur', () => {
    element.style.boxShadow = 'none';
    element.style.animation = 'none';
  });

  // Add hover style
  element.addEventListener('mouseover', () => {
    element.style.boxShadow = '0 0 9px rgb(255, 169, 21)';
    //element.style.animation = 'pulseShadow2 0.6s ease-in-out infinite alternate';
  });

  // Remove hover style
  element.addEventListener('mouseout', () => {
    element.style.boxShadow = 'none';
    element.style.animation = 'none';
  });
});
    // Update button text to switch back to Day
    document.getElementById("toggleButton").textContent = "\u00A0\u00A0\u00A0Day Theme";
  } else {
    // Switching from Night to Day
    if (window.innerWidth <= 768) {  // Mobile device
      document.getElementById("nightTicker").style.display = "none";
      document.getElementById("dayTicker").style.display = "none";
      document.getElementById("mobileTicker").style.display = "block";
    } else {  // Desktop
      //document.getElementById("dayTicker").style.display = "block";
      console.log("Switching to Day Mode");
        if (currentTicker === document.getElementById("dayTicker")) {
            currentTicker.style.display = "block"; // Keep the current ticker visible
        }
      document.getElementById("nightTicker").style.display = "none";
      document.getElementById("mobileTicker").style.display = "none";
    }

    // Smooth transition to day
    new TWEEN.Tween(shaderMaterial2.uniforms.transition)
      .to({ value: 0 }, 20000)  // Smooth transition over 20 seconds
      .start();

    // Update globe and scene for day
    earthMaterial.uniforms.map.value = dayTexture;
    currentTexture = "day"; // Update the current texture state
    //globe2.material.map = dayTexture;

    scene.background = daybackgroundTexture;

    /*const selectedHDRI = 'js/autumn_field_puresky.jpg'

        loader.load(selectedHDRI, function(texture) {
            const rt = new THREE.WebGLCubeRenderTarget(texture.image.height);
            rt.fromEquirectangularTexture(renderer, texture);
            scene.background = rt.texture;
        });*/
    //scene.add(cloudMesh);  // Add clouds for day
  markerMaterial.color.set(daymarkerMaterial);
  currentmarkerMaterial = "day";
 // Switching from Night to Day
 handleThemeChange("day");
  /*const searchBtn = document.getElementById('searchBtn');
  searchBtn.style.backgroundColor = '#00aaff';
    const regionPopupButton = document.querySelector('#regionPopup button'); // Selects the button inside #regionPopup
regionPopupButton.style.backgroundColor = '#00aaff';
const loginButton = document.getElementById('loginButton');
loginButton.style.backgroundColor = '#00aaff';
const likedPostsButton = document.getElementById('likedPostsButton');
likedPostsButton.style.backgroundColor = '#00aaff';
const topLeftLabel = document.getElementById('topLeftLabel');
topLeftLabel.style.backgroundColor = '#00aaff';*/
// Add styles to inputs and selects on focus and hover
const header = document.getElementById('header');
const inputsAndSelects = header.querySelectorAll('input, select'); // Select all inputs and selects inside the header

inputsAndSelects.forEach((element) => {
  // Add focus style
  element.addEventListener('focus', () => {
    element.style.boxShadow = '0 0 9px rgb(255, 169, 21)';
    //element.style.animation = 'pulseShadow2 0.6s ease-in-out infinite alternate';
  });

  element.addEventListener('hover', () => {
    element.style.boxShadow = '0 0 9px rgb(255, 169, 21)';
    //element.style.animation = 'pulseShadow2 0.6s ease-in-out infinite alternate';
  });

  // Remove focus style on blur
  element.addEventListener('blur', () => {
    element.style.boxShadow = 'none';
    element.style.animation = 'none';
  });

  // Add hover style
  element.addEventListener('mouseover', () => {
    element.style.boxShadow = '0 0 9px rgb(255, 169, 21)';
    //element.style.animation = 'pulseShadow2 0.6s ease-in-out infinite alternate';
  });

  // Remove hover style
  element.addEventListener('mouseout', () => {
    element.style.boxShadow = 'none';
    element.style.animation = 'none';
  });
});

    // Update button text to switch back to Night
    document.getElementById("toggleButton").textContent = "\u00A0\u00A0\u00A0Night Theme";
  }

  // Ensure globe material updates
  //globe2.material.needsUpdate = true;
  earthMaterial.needsUpdate = true;

  // Toggle the `isDay` state after the transition
  isDay = !isDay
  //updateTheme(isDay);
}
function handleThemeChange(theme) {
  const posts = document.querySelectorAll(".post");

  // Define styles for each theme
  const themeStyles = {
    day: {
      backgroundColor: "rgba(255, 255, 255, 0.15)",
      color: "white",
      boxShadow: "0 2px 5px rgba(0, 0, 0, 0.3)",
      borderColor: "#ddd",
    },
    night: {
      backgroundColor: "rgba(255, 255, 255, 0.15)",
      color: "white",
      boxShadow: "0 2px 5px rgba(0, 0, 0, 0.3)",
      borderColor: "#ddd",
    },
  };

  // Get the appropriate styles based on the theme
  const styles = themeStyles[theme];

  // Apply styles to each post
  posts.forEach(post => {
    post.style.position = "relative";
    post.style.top = "5px";
    post.style.left = "5px";
    post.style.width = "300px";
    post.style.height = "500px";
    post.style.backgroundColor = styles.backgroundColor;
    post.style.color = styles.color;
    post.style.border = `1px solid ${styles.borderColor}`;
    post.style.borderRadius = "8px";
    post.style.overflow = "hidden";
    post.style.boxShadow = styles.boxShadow;
    post.style.padding = "15px";
    post.style.flexDirection = "column";
    post.style.alignItems = "center";
    post.style.marginBottom = "20px";
    post.style.justifySelf = "center";
  });
}

/*function toggleLightstheme() {
  earthMaterial.uniforms.map.value = LightsTexture;
}
function toggleLightstheme() {
  if (getElementById('addLightsbutton').isChecked) {
    earthMaterial.uniforms.map.value = LightsTexture;
    } else {
      earthMaterial.uniforms.map.value = LightsTexture;
        }
    }*/
  // Get the button element and check if it's checked  
 // Define the textures globally
// Function to show the premium popup and grey out screen
function showPremiumPopup() {
    if (document.getElementById("premiumPopup")) return; // Prevent duplicates

    // Greyed-out overlay to prevent interactions
    const overlay = document.createElement("div");
    overlay.setAttribute("id", "premiumOverlay");
    overlay.style.position = "fixed";
    overlay.style.top = "0";
    overlay.style.left = "0";
    overlay.style.width = "100vw";
    overlay.style.height = "100vh";
    overlay.style.backgroundColor = "rgba(173, 216, 230, 0.2)"; // Dark overlay
    overlay.style.zIndex = "22012";

    // Premium Popup
    const premiumPopup = document.createElement("div");
    premiumPopup.setAttribute("id", "premiumPopup");
    premiumPopup.style.position = "fixed";
    premiumPopup.style.top = "50%";
    premiumPopup.style.left = "50%";
    premiumPopup.style.transform = "translate(-50%, -50%)";
    premiumPopup.style.backgroundColor = "rgba(0, 128, 255, 0.2)";
    premiumPopup.style.padding = "20px";
    premiumPopup.style.borderRadius = "10px";
    premiumPopup.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.2)";
    premiumPopup.style.textAlign = "center";
    premiumPopup.style.zIndex = "22013";
    premiumPopup.style.width = "350px";

    // Close Button
    const closeButton = document.createElement("span");
    closeButton.innerHTML = "&times;";
    closeButton.style.position = "absolute";
    closeButton.style.top = "5px";
    closeButton.style.right = "10px";
    closeButton.style.cursor = "pointer";
    closeButton.style.fontSize = "20px";
    closeButton.style.color = "#FFFFFF";

    closeButton.addEventListener("click", () => {
        revertToPreviousTheme(); // Revert theme if closed
        scene.background = nightbackgroundTexture;
    });

    premiumPopup.appendChild(closeButton);

    // Title
    const title = document.createElement("h3");
    title.innerText = "Upgrade to Premium";
    title.style.color = "#FFFFFF";
    premiumPopup.appendChild(title);

    // Description
    const description = document.createElement("p");
    description.innerHTML = "Transform your travel experience with the Jetsetter Theme and other exclusive perks!<br><br>"
                       + "Unlock stunning visuals and luxury themes that make booking flights a first-class experience.<br><br>"
                       + " Upgrade now and travel in style!";
    description.style.fontSize = "14px";
    description.style.color = "#FFFFFF";
    premiumPopup.appendChild(description);

    // Upgrade Button
    const upgradeButton = document.createElement("button");
    upgradeButton.innerText = "Upgrade Now";
    upgradeButton.style.backgroundColor = "#00aaff";
    upgradeButton.style.color = "white";
    upgradeButton.style.border = "none";
    upgradeButton.style.padding = "10px 20px";
    upgradeButton.style.borderRadius = "5px";
    upgradeButton.style.cursor = "pointer";
    upgradeButton.style.marginTop = "10px";

    upgradeButton.addEventListener("click", () => {
      handlePremiumSignup('Jetsetter Theme');
    });

    premiumPopup.appendChild(upgradeButton);

    document.body.appendChild(overlay);
    document.body.appendChild(premiumPopup);
}
function showPinkPremiumPopup() {
    if (document.getElementById("pinkPremiumPopup")) return; // Prevent duplicates

    // Greyed-out overlay to prevent interactions
    const overlay = document.createElement("div");
    overlay.setAttribute("id", "pinkPremiumOverlay");
    overlay.style.position = "fixed";
    overlay.style.top = "0";
    overlay.style.left = "0";
    overlay.style.width = "100vw";
    overlay.style.height = "100vh";
    overlay.style.backgroundColor = "rgba(255, 182, 193, 0.2)"; // Light pink overlay
    overlay.style.zIndex = "22012";

    // Premium Popup
    const pinkPremiumPopup = document.createElement("div");
    pinkPremiumPopup.setAttribute("id", "pinkPremiumPopup");
    pinkPremiumPopup.style.position = "fixed";
    pinkPremiumPopup.style.top = "50%";
    pinkPremiumPopup.style.left = "50%";
    pinkPremiumPopup.style.transform = "translate(-50%, -50%)";
    pinkPremiumPopup.style.backgroundColor = "rgba(255, 192, 203, 0.2)"; // Light pink background
    pinkPremiumPopup.style.padding = "20px";
    pinkPremiumPopup.style.borderRadius = "10px";
    pinkPremiumPopup.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.2)";
    pinkPremiumPopup.style.textAlign = "center";
    pinkPremiumPopup.style.zIndex = "22013";
    pinkPremiumPopup.style.width = "350px";

    // Close Button
    const closeButton = document.createElement("span");
    closeButton.innerHTML = "&times;";
    closeButton.style.position = "absolute";
    closeButton.style.top = "5px";
    closeButton.style.right = "10px";
    closeButton.style.cursor = "pointer";
    closeButton.style.fontSize = "20px";
    closeButton.style.color = "#FFFFFF";

    closeButton.addEventListener("click", () => {
    const pinkButton = document.getElementById('addLightsbutton3');
    const airbnbLogos = document.getElementsByClassName("logo-airbnb");
    pinkButton.textContent = "\u00A0\u00A0\u00A0Blue Theme";
    // Change all Airbnb logos back
    Array.from(airbnbLogos).forEach(logo => {
                logo.src = "js/hotel-7.png";
            });
    pinkThemeActive = false; // Revert theme flag
    document.body.classList.remove('pink-theme-active'); // Remove pink theme styles

    revertToPreviousTheme(); // Revert other styles
    scene.background = nightbackgroundTexture;
    earthMaterial.uniforms.map.value = nightTexture;
    
    // Reset UI elements that were styled by the pink theme
    const calendardaytheme = document.querySelectorAll(".flatpickr-calendar .flatpickr-day.selected");
    const calendardaythemehover = document.querySelectorAll(".flatpickr-calendar .flatpickr-day:hover"); // Changed to querySelectorAll
    const postLikeBtn = document.querySelectorAll(".post .view-link");
    const postViewLink = document.querySelectorAll(".like-button");

    // Check if elements exist before calling forEach
    if (calendardaytheme.length > 0) {
        calendardaytheme.forEach(day => day.style.setProperty('background-color', '#5fcaff', 'important'));
    }
    if (calendardaythemehover.length > 0) {
        calendardaythemehover.forEach(day => day.style.setProperty('background-color', '#00aaff', 'important'));
    }
    if (postLikeBtn.length > 0) {
        postLikeBtn.forEach(btn => btn.style.setProperty('background-color', '#00aaff', 'important'));
    }
    if (postViewLink.length > 0) {
        postViewLink.forEach(link => link.style.setProperty('background-color', '#00aaff', 'important'));
    }

    // Reset marker colors
    if (currentmarkerMaterial === "day") {
        markerMaterial.color.set(daymarkerMaterial);
    } else if (currentmarkerMaterial === "night") {
        markerMaterial.color.set(nightmarkerMaterial);
    }

    // Ensure theme changes are reflected immediately
    document.getElementById('themeToggle').dispatchEvent(new Event('change'));

    console.log("Pink Theme Active:", pinkThemeActive); // Debugging log
});



    pinkPremiumPopup.appendChild(closeButton);

    // Title
    const title = document.createElement("h3");
    title.innerText = "Unlock the Pink Theme ";
    title.style.color = "#FFFFFF";
    pinkPremiumPopup.appendChild(title);

    // Description
    const description = document.createElement("p");
    description.innerHTML = "Transform your travel experience with the Pink Theme and other exclusive perks!<br><br>"
                       + "Unlock stunning visuals and luxury themes that make booking flights a first-class experience.<br><br>"
                       + " Upgrade now and travel in style!";
    description.style.fontSize = "14px";
    description.style.color = "#FFFFFF";
    pinkPremiumPopup.appendChild(description);

    // Upgrade Button
    const upgradeButton = document.createElement("button");
    upgradeButton.innerText = "Upgrade Now";
    upgradeButton.style.backgroundColor = "#FF69B4";
    upgradeButton.style.color = "white";
    upgradeButton.style.border = "none";
    upgradeButton.style.padding = "10px 20px";
    upgradeButton.style.borderRadius = "5px";
    upgradeButton.style.cursor = "pointer";
    upgradeButton.style.marginTop = "10px";

    upgradeButton.addEventListener("click", () => {
      handlePremiumSignup('Pink Theme');
    });

    pinkPremiumPopup.appendChild(upgradeButton);

    document.body.appendChild(overlay);
    document.body.appendChild(pinkPremiumPopup);
}
let previousTheme = "day"; // Default to "day" or dynamically detect current theme
let previousMarker = "day"; // Default to "day" or detect current marker state
// Function to zoom in smoothly (restore default zoom)
function zoomInGlobe() {
    const zoomInLevel = 1; // Adjust zoom level to return to original state
    const targetPosition = { x: 0, y: 0, z: 1.74}; // Default position for zooming in

    animateCameraPan(targetPosition.x, targetPosition.y, targetPosition.z, zoomInLevel);
}
// Function to revert back to previous theme if user cancels upgrade
function revertToPreviousTheme() {
  scene.add(globe); // Bring back main globe
    const lightsButton = document.getElementById('addLightsbutton');
    previousTheme = currentTexture; // Store previous theme
    previousMarker = currentmarkerMaterial; // Store previous marker
    // Restore the globe to the default texture (day or night)
    /*const defaultTexture = isNightMode ? nightTexture : dayTexture; 
    earthMaterial.uniforms.map.value = defaultTexture;
    earthMaterial.uniforms.map.needsUpdate = true;*/

    if (previousMarker === "day") {
        markerMaterial.color.set(daymarkerMaterial);
    } else if (previousMarker === "night") {
        markerMaterial.color.set(nightmarkerMaterial);
    }

    // Zoom in the globe when reverting theme
    zoomInGlobe();

    lightsButton.textContent = "Jetsetter Theme";

    removePremiumPopup(); // Remove the popup and overlay
    removePinkPremiumPopup(); // Remove the popup and overlay
    removebluePremiumPopup();
    //scene.add(globe); // Bring back main globe
    removeCountryOutlines(); // Clear all outlines
    /*globe2.earthMaterial = new THREE.ShaderMaterial({
  uniforms: {
    // Day texture, bump map, normal map, specular map, etc.
    map: { value: dayTexture },
    bumpMap: { value: bumpMap },
    normalMap: { value: normalMap },
    specularMap: { value: specularMap },
    bumpScale: { value: 0.05 },
    specularColor: { value: new THREE.Color('grey') },  // Specular color
    shininess: { value: 15 },
    // Custom uniforms for glow, scale, bias, etc.
    glowColor: { value: new THREE.Color(0x0cd1eb) },  // Glow color
    scale: { type: "f", value: -1.0 },  // Scale for glow
    bias: { type: "f", value: 1.0 },  // Bias for glow effect
    power: { type: "f", value: 3.3 },  // Power of glow intensity
    time: { type: "f", value: 0 },  // Time for animation effects
    isHover: { value: false },  // Whether the globe is being hovered over
  },
      vertexShader: document.getElementById('vertexShader').textContent,
      fragmentShader: document.getElementById('fragmentShader').textContent,
    });*/
    if (previousTheme === "day") {
        earthMaterial.uniforms.map.value = dayTexture;
    } else if (previousTheme === "night") {
        earthMaterial.uniforms.map.value = nightTexture;
    }
    earthMaterial.uniforms.map.needsUpdate = true;
    //earthMaterial.uniforms.map.value = nightTexture;
    document.getElementById("toggleButton4").textContent = "\u00A0\u00A0\u00A0Globe Theme"; // Reset button text
    isCustomGlobeActive = false; // Mark theme as inactive
    earthMaterial.uniforms.map.value = dayTexture;
}

// Function to remove the premium popup and overlay
function removePremiumPopup() {
    const overlay = document.getElementById("premiumOverlay");
    const popup = document.getElementById("premiumPopup");

    if (overlay) document.body.removeChild(overlay);
    if (popup) document.body.removeChild(popup);
}
// Function to remove the premium popup and overlay
function removePinkPremiumPopup() {
    const overlay = document.getElementById("pinkPremiumOverlay");
    const popup = document.getElementById("pinkPremiumPopup");

    if (overlay) document.body.removeChild(overlay);
    if (popup) document.body.removeChild(popup);
}
// Function to remove the premium popup and overlay
function removebluePremiumPopup() {
    const overlay = document.getElementById("bluePremiumOverlay");
    const popup = document.getElementById("bluePremiumPopup");

    if (overlay) document.body.removeChild(overlay);
    if (popup) document.body.removeChild(popup);
}
// Function to check if the user is premium (Firebase)
// Function to check if the user is premium (Firebase)
async function isUserPremium() {
    if (!firebase.apps.length) {
        console.error(" Firebase is not initialized!");
        return false;
    }

    const user = firebase.auth().currentUser;
    if (!user) return false;

    try {
        const doc = await firebase.firestore().collection("users").doc(user.uid).get();
        if (!doc.exists) return false;

        const data = doc.data();
        return data.isPremium === true || data.stripePaymentStatus === 'paid'; 
    } catch (error) {
        console.error(" Error checking premium status:", error);
        return false;
    }
}


// Function to handle premium upgrade via Firebase Payment
async function handlePremiumSignup(theme) {
    try {
        const response = await fetch("https://us-central1-horizon-flights.cloudfunctions.net/flightSearchAPI", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ theme: theme })
        });

        const session = await response.json();
        if (session.url) {
            window.location.href = session.url; // Redirect user to Stripe Checkout
        } else {
            alert("Payment failed. Please try again.");
        }
    } catch (error) {
        console.error("Error:", error);
        alert("An error occurred. Please try again later.");
    }
}

// Function to zoom out smoothly
function zoomOutGlobe() {
    const zoomOutLevel = 0.65; // Adjust zoom level for desired zoom out effect
    const targetPosition = { x: 7, y: 0, z: 7 }; // Position for zooming out
    controls.enableZoom = true;
    controls.minDistance = 15;
  //controls.maxDistance = 30;
    animateCameraPan(targetPosition.x, targetPosition.y, targetPosition.z, zoomOutLevel);
}
// Event Listener for the "Blue Theme" button
document.getElementById('addLightsbutton').addEventListener('click', () => {
    const lightsButton = document.getElementById('addLightsbutton');
    const regionPopup = document.getElementById('regionPopup');
    previousTheme = currentTexture; // Store previous theme
    previousMarker = currentmarkerMaterial; // Store previous marker

    if (lightsButton.textContent === "Jetsetter Theme") {
      isUserPremium().then(isPremium => {
        if (!isPremium) {
            showPremiumPopup(); // Show popup but still apply theme
        }
    });
        regionPopup.style.display = "none";
        earthMaterial.uniforms.map.value = LightsTexture;
        markerMaterial.color.set(lightsmarkerMaterial);
        const selectedHDRI = 'js/kloofendal_48d_partly_cloudy_puresky.jpg'

        loader.load(selectedHDRI, function(texture) {
            const rt = new THREE.WebGLCubeRenderTarget(texture.image.height);
            rt.fromEquirectangularTexture(renderer, texture);
            scene.background = rt.texture;
        });

        // Zoom out the globe
        zoomOutGlobe();
        controls.enableZoom = true;
        controls.minDistance = 15;
        //controls.maxDistance = 30;
        lightsButton.textContent = "Jetsetter Theme";
    } else {
        revertToPreviousTheme(); // Revert theme if "Undo" is clicked
        scene.background = nightbackgroundTexture;
        earthMaterial.uniforms.map.value = dayTexture;

    }

    earthMaterial.uniforms.map.needsUpdate = true;
});
/*function toggleLightstheme() {
  // Get the button element
  const lightsButton = document.getElementById('addLightsbutton');

  if (lightsButton.textContent === "Blue Theme") {
    // If the lights button is clicked, overlay the lights texture on top of the current state
    if (currentTexture === "day") {
      earthMaterial.uniforms.map.value = LightsTexture; // Apply lights texture (day + lights)
      console.log("Lights theme activated on day texture");
    } else if (currentTexture === "night") {
      earthMaterial.uniforms.map.value = LightsTexture; // Apply lights texture (night + lights)
      console.log("Lights theme activated on night texture");
    }
    markerMaterial.color.set(lightsmarkerMaterial);
    lightsButton.textContent = "Undo";
    // Check if the user is premium before applying the theme
    if (!isUserPremium()) {
            showPremiumPopup();
            //return; // Stop further execution unless they upgrade
        }

  } else {
    // If the lights button is toggled off, revert to the current texture (day or night)
    if (currentTexture === "day") {
      earthMaterial.uniforms.map.value = dayTexture; // Revert to day texture
      console.log("Reverted to day texture");
    } else if (currentTexture === "night") {
      earthMaterial.uniforms.map.value = nightTexture; // Revert to night texture
      console.log("Reverted to night texture");
    }
    if (currentmarkerMaterial === "day") {
      markerMaterial.color.set(daymarkerMaterial);
      console.log("Reverted to day texture");
    } else if (currentmarkerMaterial === "night") {
      markerMaterial.color.set(nightmarkerMaterial);
      console.log("Reverted to night texture");
    }
    lightsButton.textContent = "Blue Theme";
  }

  // Ensure uniforms update
  earthMaterial.uniforms.map.needsUpdate = true;
}*/
// Function to check if the user is premium (Firebase)
// Add Event Listener to the Toggle Button
function toggleLightstheme2() {
  // Get the button element
  const lightsButton = document.getElementById('addLightsbutton2');

  if (lightsButton.textContent === "\u00A0\u00A0\u00A0Atmosphere") {
    // If the lights button is clicked, overlay the lights texture on top of the current state
    if (currentTexture === "day") {
      scene.add(cloudMesh2); // Apply lights texture (day + lights)
      //scene.add(cloudMesh);
      console.log("clouds added activated on day texture");
    } else if (currentTexture === "night") {
      scene.add(cloudMesh2); // Apply lights texture (night + lights)
      //scene.add(cloudMesh);
      console.log("clouds added activated on night texture");
    }
    //markerMaterial.color.set(lightsmarkerMaterial);
    lightsButton.textContent = "\u00A0\u00A0\u00A0Atmosphere";
  } else {
    // If the lights button is toggled off, revert to the current texture (day or night)
    if (currentTexture === "day") {
      scene.remove(cloudMesh2); // Apply lights texture (day + lights)
      //scene.remove(cloudMesh);
      //earthMaterial.uniforms.map.value = dayTexture; // Revert to day texture
      previousTheme = currentTexture; // Store previous theme
      if (previousTheme === "day") {
        earthMaterial.uniforms.map.value = dayTexture;
    } else if (previousTheme === "night") {
        earthMaterial.uniforms.map.value = nightTexture;
    }
      console.log("Reverted to day texture");
    } else if (currentTexture === "night") {
      scene.remove(cloudMesh2); // Apply lights texture (day + lights)
      earthMaterial.uniforms.map.value = nightTexture; // Revert to night texture
      console.log("Reverted to night texture");
    }
    if (currentmarkerMaterial === "day") {
      markerMaterial.color.set(daymarkerMaterial);
      console.log("Reverted to day texture");
    } else if (currentmarkerMaterial === "night") {
      markerMaterial.color.set(nightmarkerMaterial);
      console.log("Reverted to night texture");
    }
    lightsButton.textContent = "\u00A0\u00A0\u00A0Atmosphere";
  }

  // Ensure uniforms update
  earthMaterial.uniforms.map.needsUpdate = true;
}

// Add Event Listener to the Toggle Button
document.getElementById('addLightsbutton2').addEventListener('click', toggleLightstheme2);
function toggleChristmasTheme() {
  // Get the button element
  const toggleChristmasThemeBtn = document.getElementById('toggleChristmastheme');

  // Guard against missing globeViz element
  const globeViz = document.getElementById('globeViz');

  if (toggleChristmasThemeBtn.textContent === "Christmas") {
    // If the toggleChristmasThemeBtn button is clicked,
    // Remove the current globe
    scene.remove(globe2);

    let currentColorIndex = 0; // Start with the first color
    globeViz.style.display = 'block';
    // Array of globe colors (or image URLs if using textures)
    const globeColors = [
      'js/Red_Christmas_Texture_Darkened_1920x1080.png', // Red globe texture
      'js/Blue_Christmas_Texture_Darkened_1920x1080.png', // Blue globe texture
      'js/Green_Christmas_Texture_Darkened_1920x1080.png'  // Green globe texture
    ];

    // Fetch and add the Christmas-themed globe
    fetch('./datasets/ne_110m_admin_0_countries.geojson')
      .then((res) => res.json())
      .then((countries) => {
        // Use the same geometry settings as `globe2`
        const earthRadius = 5.1
        const sphereWidth = earthRadius;
        const sphereHeight = 128.1;
        const sphereDepth = 128.1;

        const christmasGeometry = new THREE.SphereGeometry(
          sphereWidth,
          sphereHeight,
          sphereDepth
        );
        const christmasGlobe = new Globe(globeViz)
          .globeImageUrl(globeColors[currentColorIndex]) // Start with the first color
          .hexPolygonsData(countries.features)
          .hexPolygonResolution(3)
          .hexPolygonMargin(0.3)
          .hexPolygonUseDots(true)
          .hexPolygonColor(({ properties }) => {
            // Alternate between golden shades for a dynamic effect
            return Math.random() > 0.5 ? '#FFD700' : '#DAA520';
          })
          .backgroundColor('#87CEEB') // Set background color to blue
            // Access controls and enable auto-rotation
        const controls = christmasGlobe.controls();
        controls.autoRotate = true; // Enable auto-rotation
        controls.autoRotateSpeed = 0.25; // Set the rotation speed (default is 2)

            // Render loop for the globe
        function animate() {
          controls.update(); // Update controls for rotation
          requestAnimationFrame(animate); // Keep animating
        }
        animate();

        christmasGlobe.geometry = christmasGeometry;
        
        // Toggle globe colors every 2 seconds (or any preferred interval)
        const colorInterval = setInterval(() => {
          currentColorIndex = (currentColorIndex + 1) % globeColors.length; // Cycle colors
          christmasGlobe.globeImageUrl(globeColors[currentColorIndex]);
          console.log(`Globe color changed to: ${globeColors[currentColorIndex]}`);
        }, 4000);

        console.log("Christmas theme added");
      });

    // Update the button text
    toggleChristmasThemeBtn.textContent = "Remove";
  } else {
    // Clear the globe container safely
    while (globeViz.firstChild) {
      globeViz.removeChild(globeViz.firstChild);
    }
    globeViz.style.display = 'none';
    // Add back the default globe
    scene.add(globe2);

    // Clear the color interval to stop toggling colors
    const colorInterval = toggleChristmasThemeBtn.getAttribute('data-color-interval');
    if (colorInterval) {
      clearInterval(colorInterval);
    }

    // Update the button text
    toggleChristmasThemeBtn.textContent = "Christmas";
  }

  // Ensure uniforms update (if required by your material)
  if (earthMaterial?.uniforms?.map) {
    earthMaterial.uniforms.map.needsUpdate = true;
  }
}

// Add Event Listener to the Toggle Button
document.addEventListener('DOMContentLoaded', () => {
  document
    .getElementById('toggleChristmastheme')
    .addEventListener('click', toggleChristmasTheme);
});


// Add Event Listener to the Toggle Button
document.getElementById('toggleButton').addEventListener('click', toggleDayNight);
let currentBackground = "night"; // Default background
const loader = new THREE.TextureLoader();
// Show/Hide Dropdown Menu
let isCustomGlobeActive = false; // Track if a custom globe theme is applied

// Show/Hide Dropdown Menu on Globe Theme Button Click
document.getElementById('toggleButton4').addEventListener('click', () => {
    if (isCustomGlobeActive) {
        resetGlobeTheme(); // If a theme is active, reset it
    } else {
        document.getElementById('backgroundDropdown2').classList.toggle('hidden'); // Show menu
    }
});

// Function to Remove Main Globe
function removeMainGlobe() {
    if (scene.children.includes(globe)) {
        scene.remove(globe);
    }
}

// Function to Apply Country Outlines with Fill
function addCountryOutlines(outlineColor, fillColor, fillOpacity) {
    if (countryLinesGroup.children.length > 0) return; // Prevent duplicate outlines

    fetch('js/ne_110m_admin_0_countries.geojson')
        .then(response => response.json())
        .then(data => {
            data.features.forEach(feature => {
                if (feature.geometry.type === "MultiPolygon" || feature.geometry.type === "Polygon") {
                    const coords = feature.geometry.coordinates;

                    coords.forEach(polygon => {
                        const points = [];
                        polygon.forEach(coord => {
                            const lon = coord[0];
                            const lat = coord[1];
                            const position = latLngToVector3(lat, lon, earthRadius + 0.02); // Slight offset for visibility
                            points.push(new THREE.Vector3(position.x, position.y, position.z));
                        });

                        // **OUTLINE MATERIAL**
                        const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
                        const lineMaterial = new THREE.LineBasicMaterial({
                            color: outlineColor,
                            linewidth: 5,  // Make it more visible
                            opacity: 1.0
                        });
                        const lineMesh = new THREE.LineLoop(lineGeometry, lineMaterial);
                        countryLinesGroup.add(lineMesh);

                        // **FILLED MATERIAL**
                        const shape = new THREE.Shape(points.map(p => new THREE.Vector2(p.x, p.y)));
                        const fillGeometry = new THREE.ShapeGeometry(shape);
                        const fillMaterial = new THREE.MeshPhysicalMaterial({
                            color: fillColor,
                            transparent: true,
                            opacity: fillOpacity,
                            metalness: 1.0,  // Make it glossy
                            roughness: 0.2, // Adjust shininess
                            reflectivity: 1.0, // Make it highly reflective
                            side: THREE.DoubleSide
                        });
                        const fillMesh = new THREE.Mesh(fillGeometry, fillMaterial);
                        countryLinesGroup.add(fillMesh);
                    });
                }
            });

            globe2.add(countryLinesGroup);
        })
        .catch(error => console.error('Error loading GeoJSON:', error));
}



// Function to Update Globe2 Material
function updateGlobeMaterial(color, metalness, roughness, transparency, envMapIntensity) {
    if (!globe2.geometry.attributes.position || globe2.geometry.attributes.position.count === 0) {
        console.warn("Globe2 geometry has invalid position attributes. Skipping material update.");
        return;
    }
    // Load HDRI Background
const loader = new THREE.TextureLoader();
loader.load('js/kloofendal_48d_partly_cloudy_puresky.jpg', function (texture) {
    const rt = new THREE.WebGLCubeRenderTarget(texture.image.height);
    rt.fromEquirectangularTexture(renderer, texture);
    scene.background = rt.texture; // Set HDRI as background
});
    var envMap = new THREE.TextureLoader().load('envMap.png');
envMap.mapping = THREE.SphericalReflectionMapping;
globe2.earthMaterial = new THREE.ShaderMaterial({
  uniforms: {
    color: { value: new THREE.Color(color) },  // Set color based on theme
    metalness: { value: 1.0 },  // Controls reflectivity
    roughness: { value: 0.0 },  // Controls smoothness
    transparent: { value: transparency > 0 }, // Enable transparency if needed
    opacity: { value: transparency },  // Adjust transparency
    envMap: { value: envMap },  // Use HDRI for reflections
    envMapIntensity: { value: 5.0 }, // Strength of reflections
    clearcoat: { value: 1 },  // Glossy effect
    clearcoatRoughness: { value: 0 },  // Ensure max smoothness
    reflectivity: { value: 1 },  // Max reflections
    //transmission: { value: 0.2 },  // For a slight glass-like effect
    side: { value: THREE.DoubleSide },  // Ensure reflections on both sides
    // Custom uniforms for glow and animation effects
    glowColor: { value: new THREE.Color(0x0cd1eb) },  // Glow color
    scale: { type: "f", value: -1.0 },  // Scale for glow
    bias: { type: "f", value: 1.0 },  // Bias for glow effect
    power: { type: "f", value: 3.3 },  // Power of glow intensity
    time: { type: "f", value: 0 },  // Time for animation effects
    isHover: { value: false },  // Whether the globe is being hovered over
  },
  vertexShader: document.getElementById('vertexShader').textContent,
  fragmentShader: document.getElementById('fragmentShader').textContent,
});

    globe2.earthMaterial.needsUpdate = true;
    globe2.geometry.computeBoundingSphere();
    globe2.geometry.computeVertexNormals();
}
function showcustomglobethemePremiumPopup() {
    if (document.getElementById("premiumPopup")) return; // Prevent duplicates

    // Greyed-out overlay to prevent interactions
    const overlay = document.createElement("div");
    overlay.setAttribute("id", "premiumOverlay");
    overlay.style.position = "fixed";
    overlay.style.top = "0";
    overlay.style.left = "0";
    overlay.style.width = "100vw";
    overlay.style.height = "100vh";
    overlay.style.backgroundColor = "rgba(255, 255, 255, 0.10)"; // Dark overlay
    overlay.style.zIndex = "22012";

    // Premium Popup
    const premiumPopup = document.createElement("div");
    premiumPopup.setAttribute("id", "premiumPopup");
    premiumPopup.style.position = "fixed";
    premiumPopup.style.top = "50%";
    premiumPopup.style.left = "50%";
    premiumPopup.style.transform = "translate(-50%, -50%)";
    premiumPopup.style.backgroundColor = "rgba(255, 215, 0, 0.15)"; // Light gold background
    premiumPopup.style.padding = "20px";
    premiumPopup.style.borderRadius = "10px";
    premiumPopup.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.2)";
    premiumPopup.style.textAlign = "center";
    premiumPopup.style.zIndex = "22013";
    premiumPopup.style.width = "350px";

    // Close Button
    const closeButton = document.createElement("span");
    closeButton.innerHTML = "&times;";
    closeButton.style.position = "absolute";
    closeButton.style.top = "5px";
    closeButton.style.right = "10px";
    closeButton.style.cursor = "pointer";
    closeButton.style.fontSize = "20px";
    closeButton.style.color = "#FFFFFF";

    closeButton.addEventListener("click", () => {
        revertToPreviousTheme(); // Revert theme if closed
        scene.background = nightbackgroundTexture;
    });

    premiumPopup.appendChild(closeButton);

    // Title
    const title = document.createElement("h3");
    title.innerText = " Upgrade to Premium";
    title.style.color = "#FFFFFF";
    premiumPopup.appendChild(title);

    // Description
    const description = document.createElement("p");
    description.innerHTML = "Unlock <b>exclusive globe themes</b> and elevate your travel experience! <br><br><br>"
                      + "Customize your globe view with <b>luxury designs</b> and <b>immersive visuals</b> <br>"
                      + "that make booking flights even more exciting.<br><br>"
                      + " <b>Upgrade now to explore the world in style!</b>";
    description.style.fontSize = "14px";
    description.style.color = "#FFFFFF";
    premiumPopup.appendChild(description);

    // Upgrade Button
    const upgradeButton = document.createElement("button");
    upgradeButton.innerText = "Upgrade Now";
    upgradeButton.style.backgroundColor = "rgba(255, 215, 0, 0.7)";
    upgradeButton.style.color = "white";
    upgradeButton.style.border = "none";
    upgradeButton.style.padding = "10px 20px";
    upgradeButton.style.borderRadius = "5px";
    upgradeButton.style.cursor = "pointer";
    upgradeButton.style.marginTop = "10px";

    upgradeButton.addEventListener("click", () => {
        //handlePremiumSignup(); // Handle upgrade
    });

    premiumPopup.appendChild(upgradeButton);

    document.body.appendChild(overlay);
    document.body.appendChild(premiumPopup);
}
function showcustompinkglobethemePremiumPopup() {
  if (document.getElementById("pinkPremiumPopup")) return; // Prevent duplicates

// Greyed-out overlay to prevent interactions
const overlay = document.createElement("div");
overlay.setAttribute("id", "pinkPremiumOverlay");
overlay.style.position = "fixed";
overlay.style.top = "0";
overlay.style.left = "0";
overlay.style.width = "100vw";
overlay.style.height = "100vh";
overlay.style.backgroundColor = "rgba(255, 182, 193, 0.2)"; // Light pink overlay
overlay.style.zIndex = "22012";

// Premium Popup
const pinkPremiumPopup = document.createElement("div");
pinkPremiumPopup.setAttribute("id", "pinkPremiumPopup");
pinkPremiumPopup.style.position = "fixed";
pinkPremiumPopup.style.top = "50%";
pinkPremiumPopup.style.left = "50%";
pinkPremiumPopup.style.transform = "translate(-50%, -50%)";
pinkPremiumPopup.style.backgroundColor = "rgba(255, 192, 203, 0.2)"; // Light pink background
pinkPremiumPopup.style.padding = "20px";
pinkPremiumPopup.style.borderRadius = "10px";
pinkPremiumPopup.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.2)";
pinkPremiumPopup.style.textAlign = "center";
pinkPremiumPopup.style.zIndex = "22013";
pinkPremiumPopup.style.width = "350px";

// Close Button
const closeButton = document.createElement("span");
closeButton.innerHTML = "&times;";
closeButton.style.position = "absolute";
closeButton.style.top = "5px";
closeButton.style.right = "10px";
closeButton.style.cursor = "pointer";
closeButton.style.fontSize = "20px";
closeButton.style.color = "#FFFFFF";


    closeButton.addEventListener("click", () => {
        revertToPreviousTheme(); // Revert theme if closed
        scene.background = nightbackgroundTexture;
    });

    pinkPremiumPopup.appendChild(closeButton);

    // Title
    const title = document.createElement("h3");
    title.innerText = " Upgrade to Premium";
    title.style.color = "#FFFFFF";
    pinkPremiumPopup.appendChild(title);

    // Description
    const description = document.createElement("p");
    description.innerHTML = "Unlock <b>exclusive globe themes</b> and elevate your travel experience! <br><br><br>"
                      + "Customize your globe view with <b>luxury designs</b> and <b>immersive visuals</b> <br>"
                      + "that make booking flights even more exciting.<br><br>"
                      + " <b>Upgrade now to explore the world in style!</b>";
    description.style.fontSize = "14px";
    description.style.color = "#FFFFFF";
    pinkPremiumPopup.appendChild(description);

    // Upgrade Button
    const upgradeButton = document.createElement("button");
    upgradeButton.innerText = "Upgrade Now";
    upgradeButton.style.backgroundColor = "#FF69B4";
    upgradeButton.style.color = "white";
    upgradeButton.style.border = "none";
    upgradeButton.style.padding = "10px 20px";
    upgradeButton.style.borderRadius = "5px";
    upgradeButton.style.cursor = "pointer";
    upgradeButton.style.marginTop = "10px";

    upgradeButton.addEventListener("click", () => {
        //handlePremiumSignup(); // Handle upgrade
    });

    pinkPremiumPopup.appendChild(upgradeButton);

    document.body.appendChild(overlay);
    document.body.appendChild(pinkPremiumPopup);
}
function showcustomblueglobethemePremiumPopup() {
  if (document.getElementById("bluePremiumPopup")) return; // Prevent duplicates

  // Greyed-out overlay to prevent interactions
  const overlay = document.createElement("div");
  overlay.setAttribute("id", "bluePremiumOverlay");
  overlay.style.position = "fixed";
  overlay.style.top = "0";
  overlay.style.left = "0";
  overlay.style.width = "100vw";
  overlay.style.height = "100vh";
  overlay.style.backgroundColor = "rgba(173, 216, 230, 0.2)"; // Light blue overlay
  overlay.style.zIndex = "22012";

  // Premium Popup
  const bluePremiumPopup = document.createElement("div");
  bluePremiumPopup.setAttribute("id", "bluePremiumPopup");
  bluePremiumPopup.style.position = "fixed";
  bluePremiumPopup.style.top = "50%";
  bluePremiumPopup.style.left = "50%";
  bluePremiumPopup.style.transform = "translate(-50%, -50%)";
  bluePremiumPopup.style.backgroundColor = "rgba(0, 128, 255, 0.2)"; // Light blue background
  bluePremiumPopup.style.padding = "20px";
  bluePremiumPopup.style.borderRadius = "10px";
  bluePremiumPopup.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.2)";
  bluePremiumPopup.style.textAlign = "center";
  bluePremiumPopup.style.zIndex = "22013";
  bluePremiumPopup.style.width = "350px";

  // Close Button
  const closeButton = document.createElement("span");
  closeButton.innerHTML = "&times;";
  closeButton.style.position = "absolute";
  closeButton.style.top = "5px";
  closeButton.style.right = "10px";
  closeButton.style.cursor = "pointer";
  closeButton.style.fontSize = "20px";
  closeButton.style.color = "#FFFFFF";

  closeButton.addEventListener("click", () => {
        revertToPreviousTheme(); // Revert theme if closed
        scene.background = nightbackgroundTexture;
    });

    bluePremiumPopup.appendChild(closeButton);

    // Title
    const title = document.createElement("h3");
    title.innerText = " Upgrade to Premium";
    title.style.color = "#FFFFFF";
    bluePremiumPopup.appendChild(title);

    // Description
    const description = document.createElement("p");
    description.innerHTML = "Unlock <b>exclusive globe themes</b> and elevate your travel experience! <br><br><br>"
                      + "Customize your globe view with <b>luxury designs</b> and <b>immersive visuals</b> <br>"
                      + "that make booking flights even more exciting.<br><br>"
                      + " <b>Upgrade now to explore the world in style!</b>";
    description.style.fontSize = "14px";
    description.style.color = "#FFFFFF";
    bluePremiumPopup.appendChild(description);

    // Upgrade Button
    const upgradeButton = document.createElement("button");
    upgradeButton.innerText = "Upgrade Now";
    upgradeButton.style.backgroundColor = "#00aaff";
    upgradeButton.style.color = "white";
    upgradeButton.style.border = "none";
    upgradeButton.style.padding = "10px 20px";
    upgradeButton.style.borderRadius = "5px";
    upgradeButton.style.cursor = "pointer";
    upgradeButton.style.marginTop = "10px";

    upgradeButton.addEventListener("click", () => {
        //handlePremiumSignup(); // Handle upgrade
    });

    bluePremiumPopup.appendChild(upgradeButton);

    document.body.appendChild(overlay);
    document.body.appendChild(bluePremiumPopup);
}

// ** Apply Pink Theme - Glossy Pink Globe **
document.getElementById('pinkButton').addEventListener('click', function () {
  markerMaterial.color.set(pinkthememarkerMaterial);
  if (!isUserPremium()) {
    //showcustompinkglobethemePremiumPopup(); // Show popup but still apply theme
        }
        addCountryOutlines(0xff69b4, 0xff69b4, 0.5); // Pink outlines and semi-transparent fill
  // Zoom out the globe
  zoomOutGlobe();
  applyGlobeTheme(0xFF69B4, 0.9, 0.2, 1.0, 1.5, 0xFF69B4); // Glossy Pink with Pink Outlines
});

// ** Apply Glass Theme - Transparent Reflective Globe **
document.getElementById('glassButton').addEventListener('click', function () {
  markerMaterial.color.set(GlassthememarkerMaterial);
  if (!isUserPremium()) {
    //showcustomglobethemePremiumPopup(); // Show popup but still apply theme
        }
  // Zoom out the globe
  zoomOutGlobe();
  addCountryOutlines(0xFFD700, 0xFFD700, 0.6); // Gold outlines and semi-transparent fill
    // Apply Gold Theme: Reflective metallic gold with glowing country outlines
    applyGlobeTheme(0xFFD700, 1.0, 0.2, 1.0, 2.0, 0xFFD700); // Gold Reflective
});

// ** Apply Blue Theme - Glossy Blue Globe **
document.getElementById('blueButton').addEventListener('click', function () {
  if (!isUserPremium()) {
    //showcustomblueglobethemePremiumPopup(); // Show popup but still apply theme
        }
  // Zoom out the globe
  zoomOutGlobe();
  addCountryOutlines(0x00BFFF, 0x00BFFF, 0.6); // Bright blue outlines and semi-transparent fill
  applyGlobeTheme(0x00BFFF, 0.9, 0.2, 1.0, 1.5, 0x00BFFF); // Glossy Blue with Blue Outlines
});

// Function to Apply a Globe Theme
function applyGlobeTheme(globeColor, metalness, roughness, transparency, envMapIntensity, outlineColor) {
    removeMainGlobe(); // Remove the original globe
    updateGlobeMaterial(globeColor, metalness, roughness, transparency, envMapIntensity);
    //applyCountryOutlines(outlineColor); // Apply outlines with the chosen color
    // Update country outlines with the theme's outline color
    removeCountryOutlines();
    addCountryOutlines(outlineColor, 0.3);
    isCustomGlobeActive = true; // Mark theme as active
    document.getElementById("toggleButton4").textContent = "\u00A0\u00A0\u00A0Globe Theme"; // Update button text
    document.getElementById('backgroundDropdown2').classList.add('hidden'); // Hide dropdown after selection
}

// ** Reset Globe to Default when Clicking "Globe Theme " Again **
function resetGlobeTheme() {
    scene.add(globe); // Bring back main globe
    removeCountryOutlines(); // Clear all outlines
    if (currentmarkerMaterial === "day") {
            markerMaterial.color.set(daymarkerMaterial);
        } else if (currentmarkerMaterial === "night") {
            markerMaterial.color.set(nightmarkerMaterial);
        }
        globe2.earthMaterial = new THREE.ShaderMaterial({
  uniforms: {
    // Day texture, bump map, normal map, specular map, etc.
    map: { value: dayTexture },
    bumpMap: { value: bumpMap },
    normalMap: { value: normalMap },
    specularMap: { value: specularMap },
    bumpScale: { value: 0.05 },
    specularColor: { value: new THREE.Color('grey') },  // Specular color
    shininess: { value: 15 },
    // Custom uniforms for glow, scale, bias, etc.
    glowColor: { value: new THREE.Color(0x0cd1eb) },  // Glow color
    scale: { type: "f", value: -1.0 },  // Scale for glow
    bias: { type: "f", value: 1.0 },  // Bias for glow effect
    power: { type: "f", value: 3.3 },  // Power of glow intensity
    time: { type: "f", value: 0 },  // Time for animation effects
    isHover: { value: false },  // Whether the globe is being hovered over
  },
      vertexShader: document.getElementById('vertexShader').textContent,
      fragmentShader: document.getElementById('fragmentShader').textContent,
    });
    if (previousTheme === "day") {
        earthMaterial.uniforms.map.value = dayTexture;
    } else if (previousTheme === "night") {
        earthMaterial.uniforms.map.value = nightTexture;
    }
    earthMaterial.uniforms.map.value = dayTexture;
    document.getElementById("toggleButton4").textContent = "\u00A0\u00A0\u00A0Globe Theme"; // Reset button text
    isCustomGlobeActive = false; // Mark theme as inactive
}




// Show/Hide Dropdown Menu
document.getElementById('toggleButton3').addEventListener('click', () => {
    document.getElementById('backgroundDropdown').classList.toggle('hidden');
});
document.addEventListener("DOMContentLoaded", function() {

document.getElementById('dayButton').addEventListener('click', function() {
      scene.background = daybackgroundTexture;
      document.getElementById("toggleButton3").textContent = "\u00A0\u00A0\u00A0Background";
});
document.getElementById('nightButton').addEventListener('click', function() {
      scene.background = nightbackgroundTexture;
      document.getElementById("toggleButton3").textContent = "\u00A0\u00A0\u00A0Background";
});
document.getElementById('customButton').addEventListener('click', function() {
    openCustomBackgroundMenu();
});
function showcustombackdropPremiumPopup() {
    if (document.getElementById("premiumPopup")) return; // Prevent duplicates

    // Greyed-out overlay to prevent interactions
    const overlay = document.createElement("div");
    overlay.setAttribute("id", "premiumOverlay");
    overlay.style.position = "fixed";
    overlay.style.top = "0";
    overlay.style.left = "0";
    overlay.style.width = "100vw";
    overlay.style.height = "100vh";
    overlay.style.backgroundColor = "rgba(173, 216, 230, 0.2)"; // Dark overlay
    overlay.style.zIndex = "22012";

    // Premium Popup
    const premiumPopup = document.createElement("div");
    premiumPopup.setAttribute("id", "premiumPopup");
    premiumPopup.style.position = "fixed";
    premiumPopup.style.top = "50%";
    premiumPopup.style.left = "50%";
    premiumPopup.style.transform = "translate(-50%, -50%)";
    premiumPopup.style.backgroundColor = "rgba(0, 128, 255, 0.2)";
    premiumPopup.style.padding = "20px";
    premiumPopup.style.borderRadius = "10px";
    premiumPopup.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.2)";
    premiumPopup.style.textAlign = "center";
    premiumPopup.style.zIndex = "22013";
    premiumPopup.style.width = "350px";

    // Close Button
    const closeButton = document.createElement("span");
    closeButton.innerHTML = "&times;";
    closeButton.style.position = "absolute";
    closeButton.style.top = "5px";
    closeButton.style.right = "10px";
    closeButton.style.cursor = "pointer";
    closeButton.style.fontSize = "20px";
    closeButton.style.color = "#FFFFFF";

    closeButton.addEventListener("click", () => {
        revertToPreviousTheme(); // Revert theme if closed
        scene.background = nightbackgroundTexture;
    });

    premiumPopup.appendChild(closeButton);

    // Title
    const title = document.createElement("h3");
    title.innerText = "Upgrade to Premium ";
    title.style.color = "#FFFFFF";
    premiumPopup.appendChild(title);

    // Description
    const description = document.createElement("p");
    description.innerHTML = "Transform your travel experience with exclusive custom backdrops!<br><br>"
                       + "Unlock stunning visuals and premium themes that take your flight booking journey to the next level.<br><br>"
                       + " Upgrade now and explore in style!";
    description.style.fontSize = "14px";
    description.style.color = "#FFFFFF";
    premiumPopup.appendChild(description);

    // Upgrade Button
    const upgradeButton = document.createElement("button");
    upgradeButton.innerText = "Upgrade Now";
    upgradeButton.style.backgroundColor = "#00aaff";
    upgradeButton.style.color = "white";
    upgradeButton.style.border = "none";
    upgradeButton.style.padding = "10px 20px";
    upgradeButton.style.borderRadius = "5px";
    upgradeButton.style.cursor = "pointer";
    upgradeButton.style.marginTop = "10px";

    upgradeButton.addEventListener("click", () => {
      handlePremiumSignup('Custom Backdrops');
    });

    premiumPopup.appendChild(upgradeButton);

    document.body.appendChild(overlay);
    document.body.appendChild(premiumPopup);
}
document.getElementById('applycustomHDRI').addEventListener('click', function() {
  const regionPopup = document.getElementById('regionPopup');
  applyCustomBackground();
  isUserPremium().then(isPremium => {
        if (!isPremium) {
          showcustombackdropPremiumPopup(); // Show popup but still apply theme
        }
    });
        regionPopup.style.display = "none";

  // Zoom out the globe
  zoomOutGlobe();
  controls.enableZoom = true;
  controls.minDistance = 15;
  //controls.maxDistance = 30;
});
// Open Custom Background Menu
function openCustomBackgroundMenu() {
        document.getElementById('customBackgroundMenu').classList.remove('hidden');
}

// Apply Custom HDRI Background
function applyCustomBackground() {
    const selectedHDRI = document.getElementById('customHDRI').value;

    loader.load(selectedHDRI, function(texture) {
        const rt = new THREE.WebGLCubeRenderTarget(texture.image.height);
        rt.fromEquirectangularTexture(renderer, texture);
        scene.background = rt.texture;
    });

    document.getElementById("toggleButton3").textContent = "\u00A0\u00A0\u00A0Background";
    document.getElementById('customBackgroundMenu').classList.add('hidden');
}


// Function to Load HDRI Background
function loadHDRIBackground(texturePath) {
    loader.load(texturePath, function(texture) {
        const rt = new THREE.WebGLCubeRenderTarget(texture.image.height);
        rt.fromEquirectangularTexture(renderer, texture);
        scene.background = rt.texture;
    });
}

// Show Paywall Popup
function showPremiumPaywall() {
    const popup = document.createElement("div");
    popup.innerHTML = `
        <div class="premium-popup">
            <h2>Upgrade to Premium</h2>
            <p>Custom HDRI backgrounds are a premium feature. Subscribe to access! </p>
            <button onclick="subscribeToPremium()">Upgrade Now</button>
            <button onclick="closePremiumPopup()">Close</button>
        </div>
    `;
    document.body.appendChild(popup);
}

// Function to Subscribe (Example)
function subscribeToPremium() {
    localStorage.setItem("userPremium", "true");
    closePremiumPopup();
}

// Function to Close Paywall Popup
function closePremiumPopup() {
    document.querySelector(".premium-popup").remove();
}
});
//document.getElementById('toggleButton').addEventListener('click', () => {
    //isDay = !isDay; // Toggle the state
    //toggleDayNight(isDay); // Update theme based on new state
//});
//const { DateTime } = luxon;

  // Function to determine if it's day or night based on current time
//function checkDayNight() {
    //const currentTime = DateTime.now(); // Get current time in user's local timezone
    //const hour = currentTime.hour;

    // Assuming day is between 6 AM and 6 PM
    //return hour >= 6 && hour < 18;
//}

// Set initial `isDay` state based on Luxon
//isDay = checkDayNight();
//toggleDayNight(isDay); // Call your function to apply the initial theme

		/*// Load Textures
  //const textureLoader = new THREE.TextureLoader();
  const dayTexture = textureLoader.load("//unpkg.com/three-globe/example/img/earth-blue-marble.jpg");
  const nightTexture = textureLoader.load("//unpkg.com/three-globe/example/img/earth-night.jpg");
  const bumpMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-topology.png");
  const specularMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-water.png");
const dayBumpMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-topology.png");
const nightBumpMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-topology.png");
  */
  // Globe Material
	const sphereWidth = earthRadius;
  const sphereHeight = 128.1;
  const sphereDepth = 128.1;
  const geometry = new THREE.SphereGeometry(
    sphereWidth,
    sphereHeight,
    sphereDepth
  );

  const sphereWidth2 = 5.099;
  const sphereHeight2 = 128.1;
  const sphereDepth2 = 128.1;
  const geometry2 = new THREE.SphereGeometry(
    sphereWidth2,
    sphereHeight2,
    sphereDepth2
  );
  //const textureLoader = new THREE.TextureLoader();
  const shaderMaterial = new THREE.ShaderMaterial({});

  const material = new THREE.ShaderMaterial({
    vertexShader: `
                varying vec2 vertexUV;
                varying vec3 vertexNormal;
                   void main() {
                        vertexUV = uv;
                        vertexNormal = normalize(normalMatrix * normal);
                       gl_Position = projectionMatrix
                       * modelViewMatrix
                       * vec4(position, 1);
                     }
                    `,
    fragmentShader: `
                    uniform sampler2D globeTexture;
                    uniform sampler2D bumpMap;
                    uniform sampler2D bumpScale;
                    uniform sampler2D specularMap;
                    uniform sampler2D specular;
                    uniform sampler2D shininess;
                    varying vec2 vertexUV;
                    varying vec3 vertexNormal;
                     void main() {
                     float intensity = 1.05 - dot(
                     vertexNormal, vec3(0, 0, 1.0));
                     vec3 atmosphere = (vec3(0.3, 0.6, 1.0))
                     * pow(intensity, 1.5);
                        gl_FragColor = vec4(atmosphere +texture2D(globeTexture, vertexUV).xyz, 1.0),
                         vec4(atmosphere +texture2D(bumpMap, vertexUV).xyz, 2.0);
                     }
                    `,

    uniforms: {
      /*"color": { value: new THREE.Color( 0xffffff ) },
  			"diffuse": { value: new THREE.Color( 0xffffff ) },*/
      specular: { value: new THREE.Color("grey") },
      /*"emissive": { value: new THREE.Color( 0x000000 ) },
  			"opacity": { value: 1 },*/
      shininess: { value: 15 },
      bumpMap: {
        value: new THREE.TextureLoader().load(
          "//unpkg.com/three-globe/example/img/earth-topology.png"
        ),
      },

      bumpScale: {
        value: 0,
      },

      specularMap: {
        value: new THREE.TextureLoader().load(
          "//unpkg.com/three-globe/example/img/earth-water.png"
        ),
      },
      globeTexture: {
        value: "",
      },
      /*bump: {
                          value: new THREE.TextureLoader().load("//unpkg.com/three-globe/example/img/earth-topology.png")
                          }*/
    },
  });

  /*const atmosphere = new THREE.Mesh(
    new THREE.SphereGeometry(5.1, 128.1, 128.1),
    new THREE.ShaderMaterial({
      vertexShader: `
                varying vec3 vertexNormal;
                   void main() {
                        vertexNormal = normalize(normalMatrix * normal);
                       gl_Position = projectionMatrix
                       * modelViewMatrix
                       * vec4(position, 1);
                     }
                    `,
      fragmentShader: `
                varying vec3 vertexNormal;
                    void main() {
                    float intensity = pow(0.6 - dot(
                     vertexNormal, vec3(0, 0, 1.0)), 2.0);
                     gl_FragColor = vec4(0.3, 0.6, 1.0, 1.0) * intensity;
                    }
                    `,
	    //transparent: true, 
      blending: THREE.AdditiveBlending,
      side: THREE.BackSide,
    })
  );
	  
	atmosphere.scale.set(1, 1, 1);	
	  */
  const material2 = new THREE.MeshPhongMaterial({
  //specular: 0x111111,
  //shininess: 5,
  shininess: 15,
  map: dayTexture, // Start with day texture
  specularMap: specularMap,
  bumpMap: dayBumpMap, // Start with day bump map
  bumpScale: 0.05,
normalMap: normalMap,
  blending: THREE.AdditiveBlending,
  /*specular: 0x222222,*/
  specular: new THREE.Color('grey'), // Color of reflection, subtle for realism
});
	  let globe = new THREE.Mesh(geometry2, material);
  //let globe2 = new THREE.Mesh(geometry, material2);
  /*scene.add(atmosphere);*/
  scene.add(globe);
  //scene.add(globe2);
// Function to set brightness based on texture
function updateMaterialBrightness(material, nightTexture, brightnessFactor = 10) {
  if (material2.map === nightTexture) {
    material2.map.encoding = THREE.sRGBEncoding; // Ensure correct encoding
    material2.map.needsUpdate = true; // Update the texture
    material2.color.setRGB(brightnessFactor, brightnessFactor, brightnessFactor); // Adjust brightness
  } else {
    material2.color.setRGB(1, 1, 1); // Reset brightness for non-night textures
  }
}

// Example Usage
//const dayTexture = new THREE.TextureLoader().load('path/to/dayTexture.jpg');
//let nightTexture = new THREE.TextureLoader().load('path/to/nightTexture.jpg');

// Set the initial texture
//material2.map = nightTexture; // Or dayTexture
material2.needsUpdate = true;

// Update brightness dynamically
updateMaterialBrightness(material2, nightTexture, 10); // Brightness = 150% for nightTexture


/*const genericMarkers = [
  { id: 1, position: [5.1, 1.2, 1.5], region: 'africa' },
  { id: 2, position: [5.1, 0.7, 1.8], region: 'europe' },
  { id: 3, position: [5.1, 0.9, 0], region: 'america' },
  { id: 4, position: [5.1, 1.6, 0.4], region: 'south america' },
  { id: 5, position: [5.1, 1, 2.3], region: 'middle east' },
  { id: 6, position: [5.1, 0.9, 3], region: 'asia' },
  { id: 7, position: [5.1, 0.9, 4], region: 'japan' },
  { id: 8, position: [5.1, 1.2, 0.2], region: 'carribbean' },
  { id: 9, position: [5.1, 0.6, 1.45], region: 'uk' },
];

// Initialize the globe and markers
function initGlobe() {
  //scene = new THREE.Scene();
  //camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 1000);
  //camera.position.set(0, 0, 20); // Adjust camera distance as needed

  //renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.getElementById('globe-container').appendChild(renderer.domElement);

  /*const controls = new OrbitControls(camera, labelRenderer.domElement);
  controls.enableDamping = true;
  controls.dampingFactor = 0.25;
  controls.enableZoom = true;
  controls.minDistance = 15;
  controls.maxDistance = 25;
  controls.autoRotate = true;
  controls.autoRotateSpeed = 0.5;*/

  // Create globe geometry and material
  //const globeGeometry = new THREE.SphereGeometry(5, 64, 64);
  //const textureLoader = new THREE.TextureLoader();
  //const globeMaterial = new THREE.MeshBasicMaterial({
    //map: textureLoader.load('js/Earth_Diffuse.jpg'),
  //});

  /*globe2 = new THREE.Mesh(geometry, material2);
  scene.add(globe2);

  // Load and display generic markers
  loadGenericMarkers();

  // Start the animation loop
  //animate();
}
// Function to load generic markers
// Function to load generic markers
function loadGenericMarkers() {

  // Marker material with custom shader for ripple effect
  const markerMaterial = new THREE.MeshBasicMaterial({
    color: daymarkerMaterial, // Ensure this color is defined
    onBeforeCompile: (shader) => {
      // Add custom uniform for time
      shader.uniforms.time = globalUniforms.time; // Ensure globalUniforms.time is defined

      // Modify vertex shader to include the phase attribute
      shader.vertexShader = `
        attribute float phase;
        varying float vPhase;
        ${shader.vertexShader}
      `.replace(
        `#include <begin_vertex>`,
        `#include <begin_vertex>
          vPhase = phase; // de-synch of ripples
        `
      );

      // Modify fragment shader to create ripple effects based on time
      shader.fragmentShader = `
        uniform float time;
        varying float vPhase;
        ${shader.fragmentShader}
      `.replace(
        `vec4 diffuseColor = vec4( diffuse, opacity );`,
        `
        vec2 lUv = (vUv - 0.5) * 2.;
        float val = 0.;
        float lenUv = length(lUv);
        val = max(val, 1. - step(0.25, lenUv)); // central circle
        val = max(val, step(0.4, lenUv) - step(0.5, lenUv)); // outer circle

        float tShift = fract(time * 0.5 + vPhase);
        val = max(val, step(0.4 + (tShift * 0.6), lenUv) - step(0.5 + (tShift * 0.5), lenUv)); // ripple

        if (val < 0.5) discard;

        vec4 diffuseColor = vec4( diffuse, opacity );`
      );
    },
  });

  // Define UV usage for the marker material
  markerMaterial.defines = { USE_UV: '' };

  // Marker geometry (planar markers with custom shader)
  const markerGeometry = new THREE.PlaneGeometry(0.2, 0.2); // Adjust size as needed

  // Create the instanced mesh for markers
  const markerCount = genericMarkers.length;
  const markerMesh = new THREE.InstancedMesh(markerGeometry, markerMaterial, markerCount);

  // Dummy object for setting transformations per instance
  const dummy = new THREE.Object3D();

  // Add phase array for random ripple timing per marker
  const phaseArray = [];

  // Loop through markers and set position/rotation/scale for each instance
  genericMarkers.forEach((marker, index) => {
    const [x, y, z] = marker.position;

    // Set position using spherical coordinates
    dummy.position.set(x, y, z);
  
    // Make the marker face outward from the globe (normal vector)
    dummy.lookAt(dummy.position.clone().normalize().multiplyScalar(5)); // Assuming radius 5 for the globe

    // Apply the transformation to the dummy
    dummy.updateMatrix();

    // Set matrix for the instanced mesh
    markerMesh.setMatrixAt(index, dummy.matrix);

    // Assign a random phase for ripple timing
    phaseArray.push(Math.random());
  });

  // Add phase attribute to the geometry
  markerGeometry.setAttribute('phase', new THREE.InstancedBufferAttribute(new Float32Array(phaseArray), 1));

  // Add markers to the scene
  scene.add(markerMesh);
};
	  // Function to clear existing markers
function clearExistingMarkers() {
  const markers = globe2.children.filter(obj => obj.name && obj.name.startsWith('marker-'));

  markers.forEach(marker => {
    // Dispose of the geometry and material to free up memory
    if (marker.geometry) marker.geometry.dispose();
    if (marker.material) {
      // If the material is an array (multi-material), dispose each
      if (Array.isArray(marker.material)) {
        marker.material.forEach(mat => mat.dispose());
      } else {
        marker.material.dispose();
      }
    }
    globe2.remove(marker);  // Remove the marker from the scene
  });
}

// Function to load detailed markers for a specific region
function loadDetailedMarkers(regionCoordinates) {
	// Clear existing markers if needed
  clearExistingMarkers();

  const detailedMarkers = getDetailedMarkersForRegion(regionCoordinates); // Get detailed markers
  detailedMarkers.forEach(marker => {
    const [x, y, z] = marker.position;
    const markerGeometry = new THREE.PlaneGeometry(0.1, 0.1);  // Flat marker
    const markerMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00, side: THREE.DoubleSide }); // Green for detailed markers
    const markerMesh = new THREE.Mesh(markerGeometry, markerMaterial);
    markerMesh.position.set(x, y, z);
    globe2.add(markerMesh);
  });
}
	

// Example: Get detailed markers for a region (dummy data)
function getDetailedMarkersForRegion(regionCoordinates) {
  return [
    { id: 101, position: [regionCoordinates.lat + 0.1, regionCoordinates.lon + 0.1, 1.5] },
    { id: 102, position: [regionCoordinates.lat + 0.2, regionCoordinates.lon + 0.2, 1.8] },
  ];
}

// Pan globe to a region
function panGlobeToRegion(regionCoordinates) {
  if (camera && controls) {
    const { x, y, z } = latLonToVector3(regionCoordinates.lat, regionCoordinates.lon, 20);
    camera.position.set(x, y, z);
    controls.update();

    // Load detailed markers for the searched region
    loadDetailedMarkers(regionCoordinates);
  } else {
    console.error('Camera or controls not initialized.');
  }
}

// Convert latitude and longitude to 3D vector coordinates
function latLonToVector3(lat, lon, radius) {
  const phi = (90 - lat) * (Math.PI / 180);
  const theta = (lon + 180) * (Math.PI / 180);
  const x = -(radius * Math.sin(phi) * Math.cos(theta));
  const y = radius * Math.cos(phi);
  const z = radius * Math.sin(phi) * Math.sin(theta);
  return { x, y, z };
}
// Placeholder for getRegionCoordinates function
function getRegionCoordinates(region) {
  const regions = {
    africa: { lat: 10, lon: 20 },
    europe: { lat: 50, lon: 10 },
    america: { lat: 40, lon: -100 },
    'south america': { lat: -10, lon: -55 },
    carribbean: { lat: 20, lon: -75 },
    asia: { lat: 30, lon: 100 },
    world: { lat: 0, lon: 0 },
  };
  return regions[region] || { lat: 0, lon: 0 };  // Default to world
}*/
	  // Markers Data
const markersData = [
  // Each marker has [radius, phi, theta] format for spherical positioning
  { id: 1, region: 'africa', position: [5.1, 1.2, 1.4], iframeSrc: "https://rss.app/embed/v1/list/aViQy1AA7saqQwdP" },
  { id: 2, region: 'europe', position: [5.1, 0.7, 1.8], iframeSrc: "https://rss.app/embed/v1/list/VSdABUR2Hoc9FvfL" },
  // Add other markers here...
  { id: 3, region: 'america', position: [5.1, 0.9, -0.15], iframeSrc: "https://rss.app/embed/v1/list/H70mWzoc5k4uZlkm" },
  { id: 4, region: 'south america', position: [5.1, 1.6, 0.4], iframeSrc: "https://rss.app/embed/v1/list/SHpWQD9ysobliT9H" },
  { id: 5, region: 'middle east', position: [5.1, 1, 2.3],iframeSrc: "https://rss.app/embed/v1/list/JCYAnBzooyfhbDvO" },
  { id: 6, region: 'asia', position: [5.1, 0.9, 3], iframeSrc: " https://rss.app/embed/v1/list/8oJAFwryVndrg9qh" },
  { id: 7, region: 'japan', position: [5.1, 0.9, 4], iframeSrc: "https://rss.app/embed/v1/list/8E3wZRO4bLOzNAB2" },
  { id: 8, region: 'carribbean', position: [5.1, 1.25, 0.15], iframeSrc: "https://rss.app/embed/v1/list/fCgGTq3kAHoZyiC4" },
  { id: 9, region: 'uk', position: [5.1, 0.64, 1.55], iframeSrc: "https://rss.app/embed/v1/list/VD7IhqKGV9q59zWu" },
  { id: 10, region: 'new york', position: [5.1, 0.9, 0.25], iframeSrc: "https://rss.app/embed/v1/list/xOKzp29XiJQsDy8s" },
  { id: 11, region: 'florida', position: [5.1, 1.077, 0.14], iframeSrc: "https://rss.app/embed/v1/list/1XOUd8JEO4xYARbx" },
  { id: 12, region: 'mexico', position: [5.1, 1.2, -0.2], iframeSrc: "https://rss.app/embed/v1/list/WsTF4RWpAxs7cW7E" },
  { id: 13, region: 'brazil', position: [5.1, 1.8, 0.7], iframeSrc: "https://rss.app/embed/v1/list/MQopXDcvCJgbVrJq" },
  { id: 14, region: 'argentina', position: [5.1, 2.2, 0.5], iframeSrc: "https://rss.app/embed/v1/list/N1io1zQOpLx05GCT" },
  { id: 15, region: 'nigeria', position: [5.1, 1.435, 1.7], iframeSrc: "https://rss.app/embed/v1/list/sXONZKLJdsFOmQ6U" },
  { id: 16, region: 'morocco', position: [5.1, 1.0, 1.65], iframeSrc: "https://rss.app/embed/v1/list/7PkBkOEXUzZ3wgTX" },
  { id: 17, region: 'ghana', position: [5.1, 1.42, 1.57], iframeSrc: "https://rss.app/embed/v1/list/cyaVVDgVwKRbGGk3" },
  { id: 18, region: 'ethiopia', position: [5.1, 1.435, 2.25], iframeSrc: "https://rss.app/embed/v1/list/qqUcYitAMkfTl9gc" },
  { id: 19, region: 'somali', position: [5.1, 1.5, 2.35], iframeSrc: "https://rss.app/embed/v1/list/eYJEDl0n6NQ0vbXQ" },
  { id: 20, region: 'egypt', position: [5.1, 1.1, 2.025], iframeSrc: "https://rss.app/embed/v1/list/1zENc8xlwLAD9N8j" },
  { id: 21, region: 'kenya', position: [5.1, 1.59, 2.2], iframeSrc: "https://rss.app/embed/v1/list/BheyyzLtzcza5gF7" },
  { id: 22, region: 'south africa', position: [5.1, 2.0, 2.05], iframeSrc: "https://rss.app/embed/v1/list/aGWKlWNxkC26vC5c" },
  { id: 23, class:"iframe-saudi",region: 'saudi arabia', position: [5.1, 1.15, 2.35],iframeSrc: "https://rss.app/embed/v1/list/Lf7XMimoFVElTq81" },
];
/*const genericMarkers = [
  { id: 1, position: [5.1, 1.2, 1.5], region: 'africa' },
  { id: 2, position: [5.1, 0.7, 1.8], region: 'europe' },
  { id: 3, position: [5.1, 0.9, 0], region: 'america' },
  { id: 4, position: [5.1, 1.6, 0.4], region: 'south america' },
  { id: 5, position: [5.1, 1, 2.3], region: 'middle east' },
  { id: 6, position: [5.1, 0.9, 3], region: 'asia' },
  { id: 7, position: [5.1, 0.9, 4], region: 'japan' },
  { id: 8, position: [5.1, 1.2, 0.2], region: 'carribbean' },
  { id: 9, position: [5.1, 0.6, 1.45], region: 'uk' },
];*/
	  // Convert latitude and longitude to 3D vector coordinates
/*function latLonToVector3(lat, lon, radius) {
  const phi = (90 - lat) * (Math.PI / 180);
  const theta = (lon + 180) * (Math.PI / 180);
  const x = -(radius * Math.sin(phi) * Math.cos(theta));
  const y = radius * Math.cos(phi);
  const z = radius * Math.sin(phi) * Math.sin(theta);
  return { x, y, z };
}*/
function latLngToVector3(lat, lng, radius) {
  const phi = (90 - lat) * (Math.PI / 180);
  const theta = (lng + 180) * (Math.PI / 180);

  const x = -(radius * Math.sin(phi) * Math.cos(theta));
  const y = radius * Math.cos(phi);
  const z = radius * Math.sin(phi) * Math.sin(theta);

  return new THREE.Vector3(x, y, z);
}


globe2 = new THREE.Mesh(geometry, earthMaterial);
// Initialize the globe and markers

  renderer.setSize(window.innerWidth, window.innerHeight);
  document.getElementById('globeContainer').appendChild(renderer.domElement);

  //globe2 = new THREE.Mesh(geometry, material2);
  scene.add(globe2);
// Load GeoJSON and add country outlines to the transparent globe
let countryLinesGroup = new THREE.Group(); // Store country outlines globally

/*function addCountryOutlines(color, fillOpacity) {
    if (countryLinesGroup.children.length > 0) return; // Prevent duplicate outlines

    fetch('js/ne_110m_admin_0_countries.geojson')
        .then(response => response.json())
        .then(data => {
            data.features.forEach(feature => {
                if (feature.geometry.type === "MultiPolygon" || feature.geometry.type === "Polygon") {
                    const coords = feature.geometry.coordinates;

                    coords.forEach(polygon => {
                        const points = [];
                        polygon.forEach(coord => {
                            const lon = coord[0];
                            const lat = coord[1];
                            const position = latLngToVector3(lat, lon, earthRadius + 0.01); // Offset for visibility
                            points.push(position);
                        });

                        // **OUTLINE MATERIAL**
                        const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
                        const lineMaterial = new THREE.LineBasicMaterial({
                            color: color, 
                            linewidth: 2 // Adjust width for better visibility
                        });
                        const lineMesh = new THREE.LineLoop(lineGeometry, lineMaterial);
                        countryLinesGroup.add(lineMesh);

                        // **FILLED MATERIAL**
                        const shape = new THREE.Shape(points.map(p => new THREE.Vector2(p.x, p.y)));
                        const extrudeSettings = { depth: 0.001, bevelEnabled: false };
                        const fillGeometry = new THREE.ExtrudeGeometry(shape, extrudeSettings);
                        const fillMaterial = new THREE.MeshBasicMaterial({
                            color: color,
                            transparent: true,
                            opacity: fillOpacity,
                            side: THREE.DoubleSide
                        });
                        const fillMesh = new THREE.Mesh(fillGeometry, fillMaterial);
                        countryLinesGroup.add(fillMesh);
                    });
                }
            });

            globe2.add(countryLinesGroup);
        })
        .catch(error => console.error('Error loading GeoJSON:', error));
}*/


// Function to draw country outlines
function drawOutline(polygon) {
    const points = [];
    
    polygon.forEach(coord => {
        const lon = coord[0];
        const lat = coord[1];
        const position = latLngToVector3(lat, lon, earthRadius + 0.01);
        points.push(position);
    });

    if (points.length < 3) return; // Ignore invalid polygons

    const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
    const lineMaterial = new THREE.LineBasicMaterial({ color: 0xffd700, linewidth: 2 }); // Gold outline
    const lineMesh = new THREE.LineLoop(lineGeometry, lineMaterial);
    countryLinesGroup.add(lineMesh);
}


// Function to remove the country outlines when the pink theme is off
function removeCountryOutlines() {
    if (countryLinesGroup) {
        globe2.remove(countryLinesGroup);
        countryLinesGroup.children = []; // Clear the group
    }
}


  createEarthGlow();
  createEarthAperture();
	 const dummy = new THREE.Object3D();
	  /*const markerGeometry = new THREE.PlaneGeometry(1.1, 1.1); // Adjust size as needed
    const markerMaterial = new THREE.MeshBasicMaterial({
    color: daymarkerMaterial,
    onBeforeCompile: (shader) => {
      shader.uniforms.time = globalUniforms.time;
      shader.vertexShader = `
      	attribute float phase;
        varying float vPhase;
        ${shader.vertexShader}
      `.replace(
        `#include <begin_vertex>`,
        `#include <begin_vertex>
        	vPhase = phase; // de-synch of ripples
        `
      );
      shader.fragmentShader = `
      	uniform float time;
        varying float vPhase;
      	${shader.fragmentShader}
      `.replace(
        `vec4 diffuseColor = vec4( diffuse, opacity );`,
        `
        vec2 lUv = (vUv - 0.5) * 2.;
        float val = 0.;
        float lenUv = length(lUv);
        val = max(val, 1. - step(0.25, lenUv)); // central circle
        val = max(val, step(0.4, lenUv) - step(0.5, lenUv)); // outer circle

        float tShift = fract(time * 0.5 + vPhase);
        val = max(val, step(0.4 + (tShift * 0.6), lenUv) - step(0.5 + (tShift * 0.5), lenUv)); // ripple

        if (val < 0.5) discard;

        vec4 diffuseColor = vec4( diffuse, opacity );`
      );
    },
  });
  markerMaterial.defines = { USE_UV: '' };
	  const markers = new THREE.InstancedMesh(markerGeometry, markerMaterial, markersData.length);*/
    // Creating Markers
    const markerGeometry = new THREE.PlaneGeometry(0.7, 0.7);
    const markerMaterial = new THREE.MeshBasicMaterial({
    color: daymarkerMaterial,
    onBeforeCompile: (shader) => {
      shader.uniforms.time = globalUniforms.time;
      shader.vertexShader = `
      	attribute float phase;
        varying float vPhase;
        ${shader.vertexShader}
      `.replace(
        `#include <begin_vertex>`,
        `#include <begin_vertex>
        	vPhase = phase; // de-synch of ripples
        `
      );
      shader.fragmentShader = `
      	uniform float time;
        varying float vPhase;
      	${shader.fragmentShader}
      `.replace(
        `vec4 diffuseColor = vec4( diffuse, opacity );`,
        `
        vec2 lUv = (vUv - 0.5) * 2.;
        float val = 0.;
        float lenUv = length(lUv);
        val = max(val, 1. - step(0.25, lenUv)); // central circle
        val = max(val, step(0.4, lenUv) - step(0.5, lenUv)); // outer circle

        float tShift = fract(time * 0.5 + vPhase);
        val = max(val, step(0.4 + (tShift * 0.6), lenUv) - step(0.5 + (tShift * 0.5), lenUv)); // ripple

        if (val < 0.5) discard;

        vec4 diffuseColor = vec4( diffuse, opacity );`
      );
    },
  });
    const markers = new THREE.InstancedMesh(markerGeometry, markerMaterial, markersData.length);
// Function to load generic markers
function loadGenericMarkers(markersData) {
  // Check if the scene, marker data, and necessary variables are available
  if (!scene || !markersData || markersData.length === 0) {
    console.warn('Scene or markers data not available');
    return;
  }
  console.log('Loading generic markers...');
// Marker Geometry and Material
// Adjust marker size dynamically based on zoom level

  // Create the marker geometry and material
  //const markerGeometry = new THREE.PlaneGeometry(1.1, 1.1);
//const markerGeometry = new THREE.PlaneGeometry(1.1, 1.1); // Adjust size as needed
/*const markerMaterial = new THREE.MeshBasicMaterial({
    color: daymarkerMaterial,
    onBeforeCompile: (shader) => {
      shader.uniforms.time = globalUniforms.time;
      shader.vertexShader = `
      	attribute float phase;
        varying float vPhase;
        ${shader.vertexShader}
      `.replace(
        `#include <begin_vertex>`,
        `#include <begin_vertex>
        	vPhase = phase; // de-synch of ripples
        `
      );
      shader.fragmentShader = `
      	uniform float time;
        varying float vPhase;
      	${shader.fragmentShader}
      `.replace(
        `vec4 diffuseColor = vec4( diffuse, opacity );`,
        `
        vec2 lUv = (vUv - 0.5) * 2.;
        float val = 0.;
        float lenUv = length(lUv);
        val = max(val, 1. - step(0.25, lenUv)); // central circle
        val = max(val, step(0.4, lenUv) - step(0.5, lenUv)); // outer circle

        float tShift = fract(time * 0.5 + vPhase);
        val = max(val, step(0.4 + (tShift * 0.6), lenUv) - step(0.5 + (tShift * 0.5), lenUv)); // ripple

        if (val < 0.5) discard;

        vec4 diffuseColor = vec4( diffuse, opacity );`
      );
    },
  });*/
  markerMaterial.defines = { USE_UV: '' };
  console.log('Creating generic markers...');
  // Create an object to keep track of generic markers for each region
  window.genericMarkers = window.genericMarkers || {};

if (window.innerWidth <= 768) {
  markerGeometry.scale(1.25, 1.25, 1.25); // Scale for mobile
}

// Creating Markers
const markers = new THREE.InstancedMesh(markerGeometry, markerMaterial, markersData.length);

const dummy = new THREE.Object3D();
markersData.forEach((data, index) => {
  const [radius, phi, theta] = data.position; // Spherical coordinates (radius, phi, theta)

  // Use setFromSphericalCoords for spherical positioning on the globe
  dummy.position.setFromSphericalCoords(radius, phi, theta);
  dummy.lookAt(dummy.position.clone().setLength(radius + 1)); // Ensure marker faces outward
  dummy.updateMatrix();
  markers.setMatrixAt(index, dummy.matrix);
// Log marker data
console.log(`Marker ${index}: radius=${radius}, phi=${phi}, theta=${theta}`);

  data.worldPosition = dummy.position.clone(); // Store position for interaction (optional)
});
// Log region and saving marker
const region = markersData[0]?.region; // Assuming markersData has region info
  if (region) {
    console.log(`Saving generic markers for region: ${region}`);
    window.genericMarkers[region] = markers;
  } else {
    console.warn('Region data not found in markersData');
  }
// Save the marker to the genericMarkers object based on region
genericMarkers[markersData.region] = markers;
// Add the markers to the scene
scene.add(markers);
}

  
  loadGenericMarkers(markersData);
// Labels, Raycasting, and Interactions (leave as is from your original logic)
// Assuming each marker has a reference in the HTML list and vice versa
function highlightMarker(markerId) {
    const marker = markers.find(m => m.id === markerId);  // Find the marker by ID
    if (marker) {
        marker.material.color.set('green');  // Highlight the marker in green
    }
}

document.querySelectorAll('.listing').forEach(listing => {
    listing.addEventListener('mouseover', () => {
        const markerId = listing.getAttribute('data-marker-id');  // Ensure the listings have a marker ID
        highlightMarker(markerId);
    });

    listing.addEventListener('mouseout', () => {
        const markerId = listing.getAttribute('data-marker-id');
        unhighlightMarker(markerId);  // Reset the marker's color
    });
});

function unhighlightMarker(markerId) {
    const marker = markers.find(m => m.id === markerId);
    if (marker) {
        marker.material.color.set('original_color');  // Reset to original color
    }
}



/*// Load detailed markers for a specific region
function loadDetailedMarkers(regionCoordinates) {
  clearExistingMarkers();

  const detailedMarkers = getDetailedMarkersForRegion(regionCoordinates);
  detailedMarkers.forEach(marker => {
    const { x, y, z } = latLonToVector3(marker.position[0], marker.position[1], 5.1);  // Adjust radius as needed
    // Marker Geometry and Material
const markerGeometry = new THREE.PlaneGeometry(0.025, 0.025);  // Use a smaller size, adjust as needed

// Optionally scale markers for mobile
if (window.innerWidth <= 768) {
  markerGeometry.scale(0.5, 0.5, 0.5);  // Smaller for mobile
}


    const markerMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00, side: THREE.DoubleSide });

    const markerMesh = new THREE.Mesh(markerGeometry, markerMaterial);
    markerMesh.position.set(x, y, z);
    markerMesh.name = `marker-${marker.id}`;  // Set a unique name

    globe2.add(markerMesh);
  });
*/
	  // Load detailed markers for a specific region (use regular Mesh for dynamic marker count)
// Load detailed markers for a specific region (use regular Mesh for dynamic marker count)
	   // Function to clear existing markers
function clearExistingMarkers() {
  const markers = scene.children.filter(obj => obj.name && obj.name.startsWith('marker-'));

  markers.forEach(marker => {
    // Dispose of the geometry and material to free up memory
    if (marker.geometry) marker.geometry.dispose();
    if (marker.material) {
      // If the material is an array (multi-material), dispose each
      if (Array.isArray(marker.material)) {
        marker.material.forEach(mat => mat.dispose());
      } else {
        marker.material.dispose();
      }
    }
    scene.remove(marker);  // Remove the marker from the scene
  });
}
async function loadDetailedMarkers(regionCoordinates) {
  clearExistingMarkers();  // Clear previously added markers

  // Fetch detailed markers dynamically for the region
  const detailedMarkers = await getDetailedMarkersForRegion(regionCoordinates); 

  // Iterate through the fetched markers and add them to the scene
  detailedMarkers.forEach((marker, index) => {
    const { lat, lng } = marker;  // Use latitude and longitude
    const { x, y, z } = latLngToVector3(lat, lng, earthRadius); // Convert to 3D coordinates

    // Create individual marker geometry and material
    const markerGeometry = new THREE.PlaneGeometry(0.7, 0.7);  // Use smaller size for detailed markers
    const markerMaterial = new THREE.MeshBasicMaterial({ color: 0x00aaff, side: THREE.DoubleSide });

    // Optionally scale markers for mobile
    if (window.innerWidth <= 768) {
      markerGeometry.scale(1.25, 1.25, 1.25);  // Smaller for mobile
    }

    const markerMesh = new THREE.Mesh(markerGeometry, markerMaterial);
    markerMesh.position.set(x, y, z);
    markerMesh.name = `marker-${marker.id}`;  // Set a unique name for each marker

    // Add the marker to the scene (on the globe)
    scene.add(markerMesh);  
  });
}

// Example: Get detailed markers for a region
// Get detailed markers for a region (can be dynamic or hardcoded)
// Fetch detailed markers dynamically from an API or backend service
async function getDetailedMarkersForRegion(region) {
  try {
    // Make an API request to fetch the markers data for the specific region
    const response = await fetch(`https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/get-markers?region=${region}&category=${category}`, {
  method: 'GET',
  credentials: 'include',  // If you need cookies or credentials
  headers: {
        'ngrok-skip-browser-warning': 'true',
    },
}).then(response => response.json())
  .then(markerLatLngs => {
    // Assume 'map' is your initialized Google Map or Mapbox map object

    // Loop through the marker data and add them to the map
    markerLatLngs.forEach(marker => {
      new Marker({
        position: { lat: marker.lat, lng: marker.lng },  // Use the lat/lng coordinates
        map: map,
        title: 'Airbnb Marker'
      });
    });
  })
  .catch(err => {
    console.error('Error fetching markers:', err);
  });
    // Parse the JSON response to get the markers data
    const markersData = await response.json(); 
console.log(response.json());
    return markersData; // Assuming the response contains an array of markers
  } catch (error) {
    console.error('Error fetching detailed markers for region:', error);
    return []; // Return an empty array if there's an error
  }
}




// Pan globe to a region
let currentRegion = null; // Keep track of the current region

// Function to hide a marker
function hideMarker(marker) {
  marker.visible = false;
}

// Function to show a marker
function showMarker(marker) {
  marker.visible = true;
}
// Pan globe to a region and handle marker visibility
function panGlobeToRegion(regionCoordinates, region) {
  if (camera && controls) {
    console.log(`Panning to region: ${region}`);  // Log selected region
    const { x, y, z } = latLngToVector3(regionCoordinates.lat, regionCoordinates.lng, 5.1);
    const targetPosition = new THREE.Vector3(x, y, z);

    new TWEEN.Tween(camera.position)
      .to(targetPosition, 2000)  // Smooth pan over 2 seconds
      .easing(TWEEN.Easing.Cubic.InOut)
      .onUpdate(() => controls.update())
      .start();
// Log camera movement
console.log(`Camera moving to: x=${x}, y=${y}, z=${z}`);
    // Hide the marker of the selected region after panning
    new TWEEN.Tween()
      .to({}, 2000)  // Add a delay equal to the camera pan
      .onComplete(() => {
        console.log(`Fetching and displaying detailed markers for region: ${region}`);
        // Fetch and display detailed markers for the selected region
        fetchMarkers(region);

        // Hide the current region's marker
        if (genericMarkers[region]) {
          console.log(`Hiding generic marker for region: ${region}`);
          hideMarker(genericMarkers[region]);
        } else {
          console.warn(`No generic marker found for region: ${region}`);
        }

        // If another region was previously selected, show its marker again
        if (currentRegion && currentRegion !== region && genericMarkers[currentRegion]) {
          console.log(`Showing generic marker for previously selected region: ${currentRegion}`);
          showMarker(genericMarkers[currentRegion]);
        }

        currentRegion = region; // Update the currently selected region
      })
      .start();
  } else {
    console.error('Camera or controls are not defined');
  }
}
	  // Function to pan the globe and load markers based on a location search
function searchForLocation(locationName) {
  const normalizedLocation = normalizeLocation2(locationName);  // Normalize input (e.g., lowercase)

  // Check if the location exists in the regions database
  const regionCoordinates = regions[normalizedLocation];
  
  if (regionCoordinates) {
    panGlobeToRegion(regionCoordinates);  // Pan the globe to the searched location
  } else {
    console.log('Location not found.');
  }
}
	  // Function to normalize the input location name
function normalizeLocation2(input) {
  return input.toLowerCase().trim();
}

// Get region coordinates based on region name
function getRegionCoordinates(region) {
  const regions = {
    "africa": { lat: 10, lng: 20 },
    "europe": { lat: 50, lng: 10 },
    "america": { lat: 40, lng: -100 },
    'south america': { lat: -10, lng: -55 },
    "carribbean": { lat: 20, lng: -75 },
    "asia": { lat: 30, lng: 100 },
    "world": { lat: 0, lng: 0 },
    "new york": { lat: 40.7128, lng: -74.0060 },
    "los angeles": { lat: 34.0522, lng: -118.2437 },
    "chicago": { lat: 41.8781, lng: -87.6298 },
    "miami": { lat: 25.7617, lng: -80.1918 },
    "san francisco": { lat: 37.7749, lng: -122.4194 },
    "washington dc": { lat: 38.9072, lng: -77.0369 },
    "london": { lat: 51.5074, lng: -0.1278 },
    "paris": { lat: 48.8566, lng: 2.3522 },
    "berlin": { lat: 52.5200, lng: 13.4050 },
    "rome": { lat: 41.9028, lng: 12.4964 },
    "madrid": { lat: 40.4168, lng: -3.7038 },
    "barcelona": { lat: 41.3851, lng: 2.1734 },
    "moscow": { lat: 55.7558, lng: 37.6173 },
    "tokyo": { lat: 35.6895, lng: 139.6917 },
    "beijing": { lat: 39.9042, lng: 116.4074 },
    "shanghai": { lat: 31.2304, lng: 121.4737 },
    "sydney": { lat: -33.8688, lng: 151.2093 },
    "melbourne": { lat: -37.8136, lng: 144.9631 },
    "rio de janeiro": { lat: -22.9068, lng: -43.1729 },
    "so paulo": { lat: -23.5505, lng: -46.6333 },
    "mexico city": { lat: 19.4326, lng: -99.1332 },
    "toronto": { lat: 43.651070, lng: -79.347015 },
    "vancouver": { lat: 49.2827, lng: -123.1207 },
    "montreal": { lat: 45.5017, lng: -73.5673 },
    "buenos aires": { lat: -34.6037, lng: -58.3816 },
    "cape town": { lat: -33.9249, lng: 18.4241 },
    "johannesburg": { lat: -26.2041, lng: 28.0473 },
    "cairo": { lat: 30.0444, lng: 31.2357 },
    "dubai": { lat: 25.2048, lng: 55.2708 },
    "istanbul": { lat: 41.0082, lng: 28.9784 },
    "delhi": { lat: 28.6139, lng: 77.2090 },
    "mumbai": { lat: 19.0760, lng: 72.8777 },
    "hong kong": { lat: 22.3193, lng: 114.1694 },
    "bangkok": { lat: 13.7563, lng: 100.5018 },
    "singapore": { lat: 1.3521, lng: 103.8198 },
    "kuala lumpur": { lat: 3.1390, lng: 101.6869 },
    "jakarta": { lat: -6.2088, lng: 106.8456 },
    "seoul": { lat: 37.5665, lng: 126.9780 },
    "lagos": { lat: 6.5244, lng: 3.3792 },
    "casablanca": { lat: 33.5731, lng: -7.5898 },
    "nairobi": { lat: -1.286389, lng: 36.817223 },
    "lima": { lat: -12.0464, lng: -77.0428 },
    "santiago": { lat: -33.4489, lng: -70.6693 },
    "athens": { lat: 37.9838, lng: 23.7275 },
    "lisbon": { lat: 38.7223, lng: -9.1393 },
    "vienna": { lat: 48.2082, lng: 16.3738 },
    "stockholm": { lat: 59.3293, lng: 18.0686 },
    "oslo": { lat: 59.9139, lng: 10.7522 },
    "helsinki": { lat: 60.1695, lng: 24.9354 },
    "warsaw": { lat: 52.2297, lng: 21.0122 },
    "zurich": { lat: 47.3769, lng: 8.5417 },
    "brussels": { lat: 50.8503, lng: 4.3517 },
    "amsterdam": { lat: 52.3676, lng: 4.9041 },
    "dublin": { lat: 53.3498, lng: -6.2603 },
    "copenhagen": { lat: 55.6761, lng: 12.5683 },
    "budapest": { lat: 47.4979, lng: 19.0402 },
    "prague": { lat: 50.0755, lng: 14.4378 },
    "doha": { lat: 25.276987, lng: 51.521067 },
    "jamaica": { lat: 18.1096, lng: -77.2975 } // Added Jamaica
  };
  return regions[region] || { lat: 0, lon: 0 };  // Default to world coordinates
}
	  
// Animation loop
//function animate() {
  //requestAnimationFrame(animate);
  //controls.update();
  //renderer.render(scene, camera);
//}

// Perform search and pan the globe
/*function performSearch(searchUrl, regionCoordinates) {

	// Ensure iframe exists before referencing
const iframe = document.getElementById('airbnbIframe');
if (iframe) {
  iframe.src = searchUrl;
} else {
  console.error('Iframe not found.');
}
	
  document.getElementById('container').classList.add('split-screen');
	
  panGlobeToRegion(regionCoordinates);
}*/

/*// Trigger search and globe pan when search button is clicked
document.getElementById('searchBtn').addEventListener('click', function () {
  const where = document.getElementById('where').value;
  const checkin = document.getElementById('checkin').value;
  const checkout = document.getElementById('checkout').value;
  const guests = document.getElementById('guests').value;
  const priceMin = document.getElementById('price_min').value;
  const priceMax = document.getElementById('price_max').value;

  if (!where || !checkin || !checkout || !guests) {
    alert('Please fill out all required fields.');
    return;
  }

  const searchUrl = `https://www.airbnb.com/s/${where}/homes?checkin=${checkin}&checkout=${checkout}&guests=${guests}&price_min=${priceMin}&price_max=${priceMax}`;
  const regionCoordinates = { lat: 50, lon: 10 };  // Example coordinates
  performSearch(searchUrl, regionCoordinates);
});*/
	/*  // When the user clicks search, generate the search URL and fetch the RSS feed
        document.getElementById('searchBtn').addEventListener('click', async function () {
            const location = document.getElementById('where').value;
            const checkin = document.getElementById('checkin').value;
            const checkout = document.getElementById('checkout').value;
            const guests = document.getElementById('guests').value;
            const priceMin = document.getElementById('price-min').value;
            const priceMax = document.getElementById('price-max').value;

            if (!location || !checkin || !checkout || !guests) {
                alert('Please fill out all required fields.');
                return;
            }

            // Generate the search URL dynamically
            const searchUrl = `https://www.airbnb.com/s/${location}/homes?checkin=${checkin}&checkout=${checkout}&guests=${guests}&price_min=${priceMin}&price_max=${priceMax}`;

            try {
                // Make a request to the Node.js server to get the RSS feed URL
                const response = await fetch(`https://airbnb-assistant-7e89835c55e1.herokuapp.com/get-rss?searchUrl=${encodeURIComponent(searchUrl)}`);
                const data = await response.json();

                if (data.placeId) {
			// Step 3: Generate the final RSS feed URL with the retrieved place_id
            const finalSearchUrl = `https://www.airbnb.com/s/${location}/homes?checkin=${checkin}&checkout=${checkout}&guests=${guests}&price_min=${priceMin}&price_max=${priceMax}&place_id=${data.placeId}`;
            const rssResponse = await fetch(`https://airbnb-assistant-7e89835c55e1.herokuapp.com/get-rss?searchUrl=${encodeURIComponent(finalSearchUrl)}`);
	       const rssData = await rssResponse.json();
			if (rssData.rssUrl) {
                    // Create an iframe and set its src to the RSS feed URL
                    const iframe = document.createElement('iframe');
                    iframe.src = data.rssUrl;
                    document.getElementById('left-container').innerHTML = '';  // Clear any previous content
                    document.getElementById('left-container').appendChild(iframe);
			} else {
                console.error('Failed to load RSS feed');
            }

		} else {
                    console.error('Failed to load RSS feed');
                }
            } catch (error) {
                console.error('Error fetching RSS feed:', error);
            }
        });
	  // Function to generate the dynamic RSS URL based on user input
function generateRssUrl(searchUrl) {
  // Extract parameters from the user input (e.g., searchUrl)
  const urlParams = new URLSearchParams(searchUrl);

  const checkin = urlParams.get('checkin') || '2024-09-25';
  const checkout = urlParams.get('checkout') || '2024-09-26';
  const adults = urlParams.get('adults') || '2';
  const placeId = urlParams.get('place_id') || 'ChIJU1NoiDs6BIQREZgJa760ZO0';  // Default place_id for Mexico
  
  // Replace the parameters in the RSS URL template
  const rssUrlTemplate = 'https://rss.app/new-rss-feed/rss-builder?cssGeneralTitle=div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20main%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20a%3Anth-child(1)&cssContainer=div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20main%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div&jsTimeout=auto&url=https%3A%2F%2Fwww.airbnb.com%2Fs%2FMexico%2Fhomes%3Ftab_id%3Dhome_tab%26refinement_paths%255B%255D%3D%252Fhomes%26adults%3D${adults}%26checkin%3D${checkin}%26checkout%3D${checkout}%26place_id%3D${placeId}';

  return rssUrlTemplate;
}

// Example usage:
const searchUrl = `https://www.airbnb.com/s/${location}/homes?checkin=${checkin}&checkout=${checkout}&guests=${guests}&price_min=${priceMin}&price_max=${priceMax}`;
const dynamicRssUrl = generateRssUrl(searchUrl);
console.log(dynamicRssUrl);  // Logs the updated RSS URL
*/
	  // When the user clicks search, generate the search URL and fetch the RSS feed
/*document.getElementById('searchBtn').addEventListener('click', async function () {
    const location = document.getElementById('where').value;
    const checkin = document.getElementById('checkin').value;
    const checkout = document.getElementById('checkout').value;
    const guests = document.getElementById('guests').value;
    const priceMin = document.getElementById('price_min').value;
    const priceMax = document.getElementById('price_max').value;

    // Ensure all required fields are filled out
    if (!location || !checkin || !checkout || !guests) {
        alert('Please fill out all required fields.');
        return;
    }

    // Generate the initial Airbnb search URL
    const searchUrl = `https://www.airbnb.com/s/${location}/homes?checkin=${checkin}&checkout=${checkout}&guests=${guests}&price_min=${priceMin}&price_max=${priceMax}`;

    try {
        // Fetch the placeId from the backend (which extracts it from Airbnb's page)
        const response = await fetch(`https://airbnb-assistant-7e89835c55e1.herokuapp.com/get-place-id?searchUrl=${encodeURIComponent(searchUrl)}`);
        const data = await response.json();

        if (data.placeId) {
            // Generate the final Airbnb search URL with the retrieved placeId
            const finalSearchUrl = `https://www.airbnb.com/s/${location}/homes?checkin=${checkin}&checkout=${checkout}&guests=${guests}&price_min=${priceMin}&price_max=${priceMax}&place_id=${data.placeId}`;
            
            // Fetch the RSS feed URL using the final search URL
            const rssResponse = await fetch(`https://airbnb-assistant-7e89835c55e1.herokuapp.com/get-rss?searchUrl=${encodeURIComponent(finalSearchUrl)}`);
            const rssData = await rssResponse.json();

            if (rssData.rssUrl) {
                // Create an iframe and set its src to the RSS feed URL
                const iframe = document.createElement('iframe');
                iframe.src = rssData.rssUrl; // Set the correct RSS feed URL here
                iframe.width = '100%';
                iframe.height = '500px';  // Adjust as necessary
                document.getElementById('left-container').innerHTML = '';  // Clear previous content
                document.getElementById('left-container').appendChild(iframe);
            } else {
                console.error('Failed to load RSS feed');
            }
        } else {
            console.error('Failed to retrieve place ID');
        }
    } catch (error) {
        console.error('Error fetching RSS feed:', error);
    }
});

// Function to generate the dynamic RSS URL based on user input
function generateRssUrl(searchUrl) {
    // Extract parameters from the user input (e.g., searchUrl)
    const urlParams = new URLSearchParams(searchUrl);

    const checkin = urlParams.get('checkin') || '2024-09-25';
    const checkout = urlParams.get('checkout') || '2024-09-26';
    const adults = urlParams.get('adults') || '2';
    const placeId = urlParams.get('place_id') || 'ChIJU1NoiDs6BIQREZgJa760ZO0';  // Default place_id for Mexico
    
    // Replace the parameters in the RSS URL template
    const rssUrlTemplate = `https://rss.app/new-rss-feed/rss-builder?cssGeneralTitle=div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20main%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20a%3Anth-child(1)&cssContainer=div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20main%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20div&jsTimeout=auto&url=${encodeURIComponent(searchUrl)}`;
    return rssUrlTemplate;
}*/
// When the user clicks search, generate the search URL and fetch the RSS feed
// When the user clicks search, generate the search URL and fetch Airbnb posts
// Function to update the spinner text
function updateSpinnerText(message) {
    const spinnerText = document.querySelector('.spinner-text');
    if (spinnerText) {
        spinnerText.innerText = message;
    }
}
document.getElementById('clearFiltersBtn').addEventListener('click', () => {
  // Reset input fields
  document.getElementById('from').value = '';
  document.getElementById('where').value = '';
  document.getElementById('checkin').value = '';
  document.getElementById('checkout').value = '';
  document.getElementById('adults').value = '';
  document.getElementById('price_min').value = '';
  document.getElementById('price_max').value = '';
  const overlay = document.getElementById('overlayContainer');
  const overlay2 = document.getElementById('overlayContainer2');
  overlay.style.setProperty("display", "none", "important");
  overlay2.style.setProperty("display", "none", "important");
    //overlay2.style.width = "0px";
    //overlay2.style.height = "0px";
   //overlay.style.width = "0px";
    //overlay.style.height = "0px";
  const theme2 = document.querySelector('.theme-switch2');
  const theme = document.querySelector('.theme-switch');
  document.addEventListener('DOMContentLoaded', () => {
    // Add a 10-second delay before simulating a click on the toggle button
    setTimeout(() => {
      const themeToggle2 = document.getElementById('themeToggle2');
        if (themeToggle2) {
            themeToggle2.click(); // Simulate a click on the toggle
        }
    }, 10000); // 10000 milliseconds = 10 seconds

// Add a 10-second delay before simulating a click on the toggle button
setTimeout(() => {
  const themeToggle = document.getElementById('themeToggle');
        if (themeToggle) {
            themeToggle.click(); // Simulate a click on the toggle
        }
    }, 10000); // 10000 milliseconds = 10 seconds
});
  // Reset dropdowns (example for region selector)
  const regionSelect = document.getElementById('regionSelect');
  if (regionSelect) regionSelect.selectedIndex = 0;

  console.log('Filters cleared');
});
// Add event listener for the Airbnb search button
document.querySelector('#searchBtn.airbnb-button22').addEventListener('click', async function () {
  console.log("Flight search button clicked");
    // Your Airbnb search logic here
     const from = document.getElementById('from').value;
    const to = document.getElementById('where').value;
    const departureDate = document.getElementById('checkin').value;
    const returnDate = document.getElementById('checkout').value;
    const passengers = document.getElementById('adults').value;
    const cabinClass = document.getElementById('cabinClassInput').value;
    /*const inputs = document.querySelectorAll('#header input');
    inputs.forEach(input => {
        input.style.color = 'darkgrey';  // Change placeholder text to dark grey
    });*/
    //document.getElementById('header').style.backgroundColor = 'white';  // Change header background to white
	
    // Show the close button
    //document.getElementById('closeBtn').style.display = 'flex';
    let missingFields = []; // Initialize the array to track missing fields

    if (!from) missingFields.push('From location');
if (!to) missingFields.push('To location');
if (!departureDate) missingFields.push('Departure date');
if (!returnDate) missingFields.push('Return date');
if (!passengers) missingFields.push('Passengers');
if (!cabinClass) missingFields.push('Cabin Class');

if (missingFields.length > 0) {
    alert(`Please fill out the following fields: ${missingFields.join(', ')}`);
    return;
}

// JavaScript to close the left-container and show the Three.js canvas
// Function to handle the close button click
//document.getElementById('closeBtn').addEventListener('click', function () {
    // Hide the close button and the left container
    //document.getElementById('closeBtn').style.display = 'none';
    //document.getElementById('overlayContainer2').style.display = 'none';
//});


    // Show spinner and transition to split screen mode
    /*const leftContainer = document.getElementById('left-container');*/
    const globeContainer = document.getElementById('globeContainer');
    const overlay = document.getElementById('overlayContainer2');
    // Check if the overlayContainer exists
    if (!overlay) {
        console.error("Overlay container not found!");
        return;
    }
    // Log to confirm the visibility change
    console.log("Displaying overlay...");

    // Use requestAnimationFrame to force a repaint
    /*requestAnimationFrame(() => {
        overlay.style.display = 'grid';
        overlay.classList.add('show');
    });*/
    overlay.style.display = 'grid';
    overlay.style.width= '46%';
    overlay.style.height= '77%';
    overlay.classList.add('show');
    
        overlay.innerHTML = `
            <div class="spinner-container">
                <div class="spinner"></div>
                <p class="spinner-text"> Were comparing great flight deals for you... 
Thank you for your patience!  Feel free to browse while we find your perfect trip. 
Powered by Expedia</p>
            </div>
        `;
        function hideSpinnerContainer() {
    const spinnerContainer = document.querySelector('.spinner-container');
    if (spinnerContainer) {
        spinnerContainer.style.display = 'none';  // Hide the spinner container
    }
}

  
    // Show the spinner inside the left container
    /*leftContainer.innerHTML = `
        <div class="spinner-container">
            <div class="spinner"></div>
            <p class="spinner-text">Starting the process...</p>
        </div>
    `;
    leftContainer.style.display = 'block'; // Ensure the left container is visible
    

    // Shrink the globe-container to take only half the screen
    globeContainer.classList.add('split');
    leftContainer.classList.add('show'); // Show the left container
	// Switch to split-screen layout
    leftContainer.style.width = '50%';
    globeContainer.style.width = '50%';*/

    // Call the resize function for Three.js
    //resizeThreeJS(); // Ensure Three.js canvas is resized properly

	// Ensure Three.js globe resizes after the DOM update is complete
    //setTimeout(resizeThreeJS, 500); // Delay to ensure layout transition has completed

	// Function to resize the Three.js globe
    /*function resizeThreeJS() {
        if (window.renderer && window.camera) {
            const newWidth = globeContainer.clientWidth;
            const newHeight = globeContainer.clientHeight;
            window.renderer.setSize(newWidth, newHeight);
            window.camera.aspect = newWidth / newHeight;
            window.camera.updateProjectionMatrix();
        }
    }*/

    // Update the spinner text to indicate visiting Airbnb
    updateSpinnerText("Searching flights...");

    // Generate the Airbnb search URL
    // Base URL for Airbnb search
    // Construct the initial Airbnb URL (without map bounds)
  // Get today's date
const today = new Date();
const tomorrow = new Date();
tomorrow.setDate(today.getDate() + 1);
 // Get the first day of the current month
const monthlyStartDate = new Date(today.getFullYear(), today.getMonth(), 1);

// Get the end date three months from the current month
const monthlyEndDate = new Date(today.getFullYear(), today.getMonth() + 3, 0); // 0 gives the last day of the previous month
// Format the dates to YYYY-MM-DD
const monthlyStart = monthlyStartDate.toISOString().split('T')[0];  // First day of current month
const monthlyEnd = monthlyEndDate.toISOString().split('T')[0];  // Last day of the month 3 months from now
const url = `/scrape-expedia-flights?from=${encodeURIComponent(from)}&to=${encodeURIComponent(to)}&departureDate=${encodeURIComponent(departureDate)}&returnDate=${encodeURIComponent(returnDate)}&passengers=${encodeURIComponent(passengers)}&cabinClass=${encodeURIComponent(cabinClass)}`;

console.log("Requesting URL:", url);



    // Only add price_min and price_max if they have values
    /*if (priceMin && priceMin.trim() !== "") {
        searchUrl += `&price_min=${priceMin}`;
    }
    if (priceMax && priceMax.trim() !== "") {
        searchUrl += `&price_max=${priceMax}`;
    }*/
    // Debug the search URL (you can remove this after confirming it works)
    console.log('Generated searchUrl:', url);

	// Disable globe interactions when the left container is scrolled
    /*overlay.addEventListener('mouseenter', () => {
        globeContainer.classList.add('disable-interaction');
    });

    overlay.addEventListener('mouseleave', () => {
        globeContainer.classList.remove('disable-interaction');
    });*/

    // Update spinner text to indicate fetching data
    updateSpinnerText(` Were comparing great flight deals for you... 
Thank you for your patience!  Feel free to browse while we find your perfect trip. 
Powered by Expedia`);

    // Fetch Airbnb posts and display them
    await fetchFlightPosts(url);
	console.log('Generated searchUrl:', url);
  console.log('Generated searchUrl:fromlocation', from);
	console.log('Generated searchUrl:location', to);
	console.log('Generated searchUrl:checkin', departureDate);
	console.log('Generated searchUrl:checkout', returnDate);
	console.log('Generated searchUrl:guests', passengers);
	console.log('Generated searchUrl:cabinClass', cabinClass);
	console.log('Fetching data from:', `https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/scrape-expedia-flights?url=${encodeURIComponent(url)}`);
  hideSpinnerContainer();
  console.log("Formatted Departure Date:", departureDate);
console.log("Formatted Return Date:", returnDate);


});
async function fetchFlightPosts(url) {
    try {
        // Update spinner text to indicate scraping started
        updateSpinnerText(` Were comparing great flight deals for you... 
Thank you for your patience!  Feel free to browse while we find your perfect trip. 
Powered by Expedia`);

        const response = await fetch(`https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/scrape-expedia-flights?url=${encodeURIComponent(url)}`, {
          headers: {
        'ngrok-skip-browser-warning': 'true',
    },
        });
        const data = await response.json();

        // Ensure that 'flights' is an array before processing
        const flights = Array.isArray(data.flights) ? data.flights : [];
        console.log('Fetched flights:', data);

        // Update spinner text to indicate flights fetched
        updateSpinnerText("Displaying fetched flight listings...");
        
        // Call populateFlightOverlay to display flights
        populateFlightOverlay(flights);

    } catch (error) {
        console.error('Error fetching flights:', error);
        // Update spinner text to indicate an error occurred
        updateSpinnerText("Error fetching flight listings. Please try again.");
    }
}
// Function to fetch Airbnb posts from your backend and display them on the webpage
function populateFlightOverlay(flights) {
    const overlay = document.getElementById('overlayContainer2');
    overlay.innerHTML = ''; // Clear previous listings
    const overlayairbnbposts = document.getElementById('overlayContainer');
    overlayairbnbposts.style.width = '0px'; // Clear previous listings
    overlayairbnbposts.style.height = '0px'; // Clear previous listings


    if (!flights || flights.length === 0) {
        console.error("No flights data received to display.");
        overlay.innerHTML = "<p>No flights available.</p>";
        return;
    }
    const airlineLogos = {
        "EasyJet": "js/EasyJet_logo.svg.png",
        "British Airways": "js/British_Airways_Logo.svg.png",
        "Air France": "js/Air_France_Logo.svg.png",
        "BudgetAir.co.uk": "js/262149.png",
        "Wingie": "js/wingie.png",
        "Gotogate": "js/20220806061656!GoToGate_Logo.png",
        "Turna.com": "js/logo-cizgili_wgfwyw.png",
        "Kissandfly.com": "js/kissandfly_white.png",
        "Kiwi.com": "js/kiwi-flights-logo-symbol.png",
        "Lufthansa": "js/Lufthansa_Logo_2018.svg.png",
        "N/A": "js/Screenshot 2024-12-04 at 23.38.35.png" // Default logo
    };

    flights.forEach(flight => {
        const flightDiv = document.createElement('div');
        flightDiv.classList.add('flight-card');

        // Flight time prominently in the middle
        const flightTime = document.createElement('div');
        flightTime.classList.add('flight-time');
        flightTime.innerHTML = `
            <span class="flight-time-departure">${flight.departureTime || 'N/A'}</span>
            <span class="flight-time-arrow"></span>
            <span class="flight-time-arrival">${flight.returnTime || 'N/A'}</span>
        `;

        // Airline header
        const header = document.createElement('div');
        header.classList.add('flight-header');
        const logo = document.createElement('img');
        logo.src = `${flight.airlineImg || "N/A"}`;
        logo.alt = `${flight.airline} logo`;
        logo.classList.add('airline-logo');
        logo.style.width = '175px';
        logo.style.height = '52px';
        logo.setAttribute("style", "margin-left: 35px !important;");

        //const airline = document.createElement('p');
        //airline.textContent = flight.airline || 'Unknown Airline';

        header.appendChild(logo);
        //header.appendChild(airline);

        // Flight details
        const details = document.createElement('div');
        details.classList.add('flight-details');
        const layover = document.createElement('p');
        layover.textContent = `Layover Time: ${flight.layoverTime || 'N/A'}`;

        const price = document.createElement('p');
        price.textContent = `Price: ${flight.price || 'N/A'}`;

        details.appendChild(layover);
        details.appendChild(price);

        // Book Button
        const bookButton = document.createElement('a');
        bookButton.href = flight.link || '#';
        bookButton.target = '_blank';
        bookButton.textContent = 'Book Now';
        bookButton.classList.add('book-button');

        // Assemble Card
        flightDiv.appendChild(flightTime);
        flightDiv.appendChild(header);
        flightDiv.appendChild(details);
        flightDiv.appendChild(bookButton);

        overlay.appendChild(flightDiv);
    });
}

// Inject updated CSS
const style = document.createElement('style');
style.innerHTML = `
  .flight-card {
    display: flex;
    flex-direction: column;
    border: 1px solid #ccc;
    border-radius: 10px;
    background: #fff;
    background: rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255);
    margin: 15px 0;
    padding: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    width: 91.5%;
    max-width: 700px;
    height: 125px;
  }

  .flight-time {
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 18px;
    padding-top: 20px;
    font-weight: bold;
    margin-bottom: -40px;
    color: #fff;
    font-family: system-ui;
    position: relative;
margin-right: -270px;
  }

  .flight-time-departure, .flight-time-arrival {
    font-size: 20px;
    font-weight: bold;
  }

  .flight-time-arrow {
    margin: 0 10px;
    font-size: 18px;
    color: #00aaff;
  }

  .flight-header {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
    margin-left: -10px;
    font-family: system-ui;
  }

  .airline-logo {
    width: 50px;
    height: auto;
    margin-right: 15px;
  }

  .flight-details {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    border-top: 1px dashed #ddd;
    padding-top: 10px;
    font-family: system-ui;
  }

  .book-button {
    display: inline-block;
    padding: 10px 15px;
    color: white;
    background: #00aaff;
    border-radius: 5px;
    text-decoration: none;
    font-weight: bold;
    align-self: flex-end;
    margin-top: -130px;
    font--family: system-ui !important;
    z-index: 999999;
  }

  .book-button:hover {
    background: #003580;
    background: #00ebff;
    background: #59c2f6;
    background: #62caf6;
  }
`;
document.head.appendChild(style);




/*import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

function saveToLikes(post) {
    const user = firebase.auth().currentUser;

    if (!user) {
        alert('Please log in to like a post.');
        return;
    }

    const db = getFirestore();
    const userLikesRef = doc(db, `likes/${user.uid}/${post.id}`);

    setDoc(userLikesRef, post)
        .then(() => {
            alert('Post added to your likes!');
        })
        .catch(error => {
            console.error('Error saving liked post:', error);
        });
}

import { collection, getDocs } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

function showLikedPosts() {
    const user = firebase.auth().currentUser;

    if (!user) {
        alert('Please log in to view your liked posts.');
        return;
    }

    const db = getFirestore();
    const userLikesRef = collection(db, `likes/${user.uid}`);

    getDocs(userLikesRef)
        .then(snapshot => {
            const likedPosts = snapshot.docs.map(doc => doc.data());
            if (likedPosts.length > 0) {
              const overlay = document.getElementById('overlayContainer');
              const overlay2 = document.getElementById('overlayContainer2');
              overlay.innerHTML = ''; // Clear previous posts
              overlay2.innerHTML = ''; // Clear previous posts
              overlay2.style.display = 'none';
              populateFlightOverlay(likedPosts); // Display the liked posts
            } else {
                alert('No liked posts found.');
            }
        })
        .catch(error => {
            console.error('Error retrieving liked posts:', error);
        });
}





// Add an event listener to the profile button to show liked posts
document.getElementById('likedPostsButton').addEventListener('click', showLikedPosts);*/
import {
    doc,
    setDoc,
    collection,
    getDocs,
} from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
/*function saveToLikes(post) {
    const user = auth.currentUser;

    if (!user) {
        alert("Please log in to like a post.");
        return;
    }

    // Create a Firestore document reference for the user's liked post
    const userLikesRef = doc(db, `likes/${user.uid}/posts/${post.id}`);

    // Save the post data in Firestore
    setDoc(userLikesRef, post)
        .then(() => {
            alert("Post added to your likes!");
        })
        .catch((error) => {
            console.error("Error saving liked post:", error);
        });
}*/
function populatelikedpostsOverlay(likedPosts) {
    const overlay = document.getElementById("overlayContainer");
    overlay.style.display = "grid";
    overlay.style.width= '46%';
    overlay.style.height= '75%';
    overlay.innerHTML = ""; // Clear previous posts

    likedPosts.forEach(post => {
        const postDiv = document.createElement("div");
        postDiv.classList.add("post");

        postDiv.innerHTML = `
            <div>
                <img src="${post.images}" alt="${post.listing_name}" style="width: 100%; border-radius: 8px;">
            </div>
            <div>
                <h3>${post.title}</h3>
                <p>${post.subtitle}</p>
                <p>Price: ${post.listing_price_details}</p>
                <p>Rating: ${post.rating_out_of_5_stars}</p>
                <a href="${post.link}" style="border-radius: 25px 25px 25px 25px !important; padding: 17px 105px !important; display:flex;" target="_blank" class="view-link">View Listing</a>
            </div>
        `;

        overlay.appendChild(postDiv);
    });
}

function saveToLikes(post) {
    const user = auth.currentUser;

    if (!user) {
        alert("Please log in to like a post.");
        return;
    }

    // Ensure post has a unique ID
    const postId = post.id || `post_${Date.now()}`;

    // Create a Firestore document reference for the user's liked post
    const userLikesRef = doc(db, `likes/${user.uid}/posts/${postId}`);

    // Save the post data in Firestore
    setDoc(userLikesRef, { ...post, id: postId }) // Add the generated ID to the post
        .then(() => {
            alert("Post added to your likes!");
        })
        .catch((error) => {
            console.error("Error saving liked post:", error);
        });
}

/*function showLikedPosts() {
    const user = auth.currentUser;

    if (!user) {
        alert("Please log in to view your liked posts.");
        return;
    }

    // Reference the user's liked posts collection
    const userLikesRef = collection(db, `likes/${user.uid}/posts`);

    // Retrieve all documents in the user's liked posts collection
    getDocs(userLikesRef)
        .then((snapshot) => {
            const likedPosts = snapshot.docs.map((doc) => doc.data());

            if (likedPosts.length > 0) {
                const overlay = document.getElementById("overlayContainer");
                const overlay2 = document.getElementById("overlayContainer2");

                overlay.innerHTML = ""; // Clear previous posts
                overlay2.innerHTML = ""; // Clear previous posts
                //overlay2.style.display = "none";

                populateOverlay(likedPosts); // Display the liked posts
            } else {
                alert("No liked posts found.");
            }
        })
        .catch((error) => {
            console.error("Error retrieving liked posts:", error);
        });
}*/
function showLikedPosts() {
    const user = auth.currentUser;

    if (!user) {
        alert("Please log in to view your liked posts.");
        return;
    }

    // Reference the user's liked posts collection
    const userLikesRef = collection(db, `likes/${user.uid}/posts`);

    // Retrieve all documents in the user's liked posts collection
    getDocs(userLikesRef)
        .then((snapshot) => {
            const likedPosts = snapshot.docs.map((doc) => doc.data());

            if (likedPosts.length > 0) {
                const overlay = document.getElementById("overlayContainer");
                overlay.innerHTML = ""; // Clear previous posts
                populatelikedpostsOverlay(likedPosts); // Display the liked posts
            } else {
                alert("No liked posts found.");
            }
        })
        .catch((error) => {
            console.error("Error retrieving liked posts:", error);
        });
}

document.getElementById("likedPostsButton").addEventListener("click", showLikedPosts);
// Add event listener for the flight search button
document.querySelector('#searchBtn:not(:is(.airbnb-button22, .airbnb-button23))').addEventListener('click', async function () {
  const carouselContainer1 = document.getElementById('carousel-container');
  const carouselContainer2 = document.getElementById('carousel-container2');
  
  carouselContainer1.style.display = 'none';
  carouselContainer2.style.display = 'none';
    console.log("Airbnb search button clicked.");
    // Your flight search logic here
    const location = document.getElementById('where').value;
    const checkin = document.getElementById('checkin').value;
    const checkout = document.getElementById('checkout').value;
    const guests = document.getElementById('adults').value;
    const priceMin = document.getElementById('price_min').value;
    const priceMax = document.getElementById('price_max').value;
	
    /*const inputs = document.querySelectorAll('#header input');
    inputs.forEach(input => {
        input.style.color = 'darkgrey';  // Change placeholder text to dark grey
    });*/
    //document.getElementById('header').style.backgroundColor = 'white';  // Change header background to white
	
    // Show the close button
    //document.getElementById('closeBtn').style.display = 'flex';
    // Ensure all required fields are filled out
    if (!location || !checkin || !checkout || !guests) {
        alert('Please fill out all required fields.');
        return;
    }
// JavaScript to close the left-container and show the Three.js canvas
// Function to handle the close button click
//document.getElementById('closeBtn').addEventListener('click', function () {
    // Hide the close button and the left container
    //document.getElementById('closeBtn').style.display = 'none';
    //document.getElementById('overlayContainer').style.display = 'none';
//});

// Show spinner and transition to split screen mode
    /*const leftContainer = document.getElementById('left-container');*/
    const globeContainer = document.getElementById('globeContainer');
    const overlay = document.getElementById('overlayContainer');
    // Check if the overlayContainer exists
    if (!overlay) {
        console.error("Overlay container not found!");
        return;
    }
    // Log to confirm the visibility change
    console.log("Displaying overlay...");

    // Use requestAnimationFrame to force a repaint
    /*requestAnimationFrame(() => {
        overlay.style.display = 'grid';
        overlay.classList.add('show');
    });*/
    overlay.style.display = 'grid';
    overlay.style.width= '46%';
    overlay.style.height= '75%';
    overlay.classList.add('show');
    
        overlay.innerHTML = `
            <div class="spinner-container">
                <div class="spinner"></div>
                <p class="spinner-text">Starting the process...</p>
            </div>
        `;
        function hideSpinnerContainer() {
    const spinnerContainer = document.querySelector('.spinner-container');
    if (spinnerContainer) {
        spinnerContainer.style.display = 'none';  // Hide the spinner container
    }
}

  
    // Show the spinner inside the left container
    /*leftContainer.innerHTML = `
        <div class="spinner-container">
            <div class="spinner"></div>
            <p class="spinner-text">Starting the process...</p>
        </div>
    `;
    leftContainer.style.display = 'block'; // Ensure the left container is visible
    

    // Shrink the globe-container to take only half the screen
    globeContainer.classList.add('split');
    leftContainer.classList.add('show'); // Show the left container
	// Switch to split-screen layout
    leftContainer.style.width = '50%';
    globeContainer.style.width = '50%';*/

    // Call the resize function for Three.js
    //resizeThreeJS(); // Ensure Three.js canvas is resized properly

	// Ensure Three.js globe resizes after the DOM update is complete
    //setTimeout(resizeThreeJS, 500); // Delay to ensure layout transition has completed

	// Function to resize the Three.js globe
    /*function resizeThreeJS() {
        if (window.renderer && window.camera) {
            const newWidth = globeContainer.clientWidth;
            const newHeight = globeContainer.clientHeight;
            window.renderer.setSize(newWidth, newHeight);
            window.camera.aspect = newWidth / newHeight;
            window.camera.updateProjectionMatrix();
        }
    }*/

    // Update the spinner text to indicate visiting Airbnb
    updateSpinnerText("Visiting Airbnb site...");

    // Generate the Airbnb search URL
    // Base URL for Airbnb search
    // Construct the initial Airbnb URL (without map bounds)
  // Get today's date
const today = new Date();
const tomorrow = new Date();
tomorrow.setDate(today.getDate() + 1);
 // Get the first day of the current month
const monthlyStartDate = new Date(today.getFullYear(), today.getMonth(), 1);

// Get the end date three months from the current month
const monthlyEndDate = new Date(today.getFullYear(), today.getMonth() + 3, 0); // 0 gives the last day of the previous month
// Format the dates to YYYY-MM-DD
const monthlyStart = monthlyStartDate.toISOString().split('T')[0];  // First day of current month
const monthlyEnd = monthlyEndDate.toISOString().split('T')[0];  // Last day of the month 3 months from now
    let searchUrl = `https://www.airbnb.com/s/${location}/homes?tab_id=home_tab&refinement_paths%5B%5D=%2Fhomes&adults=2&flexible_trip_lengths%5B%5D=one_week&monthly_start_date=${monthlyStart}&monthly_length=3&monthly_end_date=${monthlyEnd}&price_filter_input_type=0&channel=EXPLORE&date_picker_type=calendar&checkin=${checkin}&checkout=${checkout}&adults=${guests}&source=structured_search_input_header&search_type=unknown&price_filter_num_nights=1&drawer_open=true`;

    // Only add price_min and price_max if they have values
    if (priceMin && priceMin.trim() !== "") {
        searchUrl += `&price_min=${priceMin}`;
    }
    if (priceMax && priceMax.trim() !== "") {
        searchUrl += `&price_max=${priceMax}`;
    }
    // Debug the search URL (you can remove this after confirming it works)
    console.log('Generated searchUrl:', searchUrl);

	// Disable globe interactions when the left container is scrolled
    /*overlay.addEventListener('mouseenter', () => {
        globeContainer.classList.add('disable-interaction');
    });

    overlay.addEventListener('mouseleave', () => {
        globeContainer.classList.remove('disable-interaction');
    });*/

    // Update spinner text to indicate fetching data
    updateSpinnerText(`Were searching for the best hotel deals for you  Sit back, relax, and browse while we find your perfect stay! 
    Thank you for your patience! 
    Powered by Expedia`);

    // Fetch Airbnb posts and display them
    await fetchAirbnbPosts(searchUrl);
	console.log('Generated searchUrl:', searchUrl);
	console.log('Generated searchUrl:location', location);
	console.log('Generated searchUrl:checkin', checkin);
	console.log('Generated searchUrl:checkout', checkout);
	console.log('Generated searchUrl:guests', guests);
	console.log('Generated searchUrl:priceMin', priceMin);
	console.log('Generated searchUrl:priceMax', priceMax);
	console.log('Fetching data from:', `https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/scrape-airbnb?searchUrl=${encodeURIComponent(searchUrl)}`);
  hideSpinnerContainer();

});
// Select elements
//const overlayContainer = document.getElementById('overlayContainer');
const menuButton = document.getElementById('menuButton');
const dropdownMenu = document.getElementById('dropdownMenu');
const menuContainer = document.querySelector('.menu-container');

// Function to check and update menu button visibility
function updateMenuButtonVisibility() {
    if (overlayContainer && window.getComputedStyle(overlayContainer).display === 'grid') {
        if (menuButton) {
            menuButton.style.display = "flex"; // Show the menu button
            console.log("Menu button set to display: flex");
        } else {
            console.error("Menu button not found!");
        }

        if (menuContainer) {
            menuContainer.style.display = 'flex'; // Ensure the menu container is visible
            console.log("Menu container set to display: flex");
        } else {
            console.error("Menu container not found!");
        }
    } else {
        console.log("Overlay container is not set to flex, hiding menu button.");
        if (menuButton) {
            menuButton.style.display = "none"; // Hide the menu button if overlay is not flex
        }
        if (menuContainer) {
            menuContainer.style.display = 'none'; // Hide the menu container as well
        }
    }
}

// Check visibility when the page loads
document.addEventListener("DOMContentLoaded", updateMenuButtonVisibility);

// Optional: Check visibility changes dynamically
const observer = new MutationObserver(updateMenuButtonVisibility);
if (overlayContainer) {
    observer.observe(overlayContainer, { attributes: true, attributeFilter: ['style'] });
}

// Add click event listener to toggle the dropdown menu
  menuButton.addEventListener('click', () => {
    console.log("Menu button clicked.");
    const currentDisplay = window.getComputedStyle(dropdownMenu).display;
    dropdownMenu.style.display = currentDisplay === 'none' ? 'block' : 'none';
    console.log("Dropdown menu toggled. New display:", dropdownMenu.style.display);
  });

  // Optional: Close the dropdown menu if clicking outside of it
  document.addEventListener('click', (event) => {
    if (event.target !== menuButton && !dropdownMenu.contains(event.target)) {
      dropdownMenu.style.display = 'none'; // Hide the dropdown menu
      console.log("Clicked outside. Dropdown menu closed.");
    }
  });
  // Handle dropdown options
document.getElementById('airbnbOption').addEventListener('click', () => {
  dropdownMenu.style.display = 'none'; // Close the dropdown
  const carouselContainer1 = document.getElementById('carousel-container');
  const carouselContainer2 = document.getElementById('carousel-container2');
  
  carouselContainer1.style.display = 'none';
  carouselContainer2.style.display = 'none';
    console.log("Airbnb search button clicked.");
    // Your flight search logic here
    const location = document.getElementById('where').value;
    const checkin = document.getElementById('checkin').value;
    const checkout = document.getElementById('checkout').value;
    const guests = document.getElementById('adults').value;
    const priceMin = document.getElementById('price_min').value;
    const priceMax = document.getElementById('price_max').value;
	
    /*const inputs = document.querySelectorAll('#header input');
    inputs.forEach(input => {
        input.style.color = 'darkgrey';  // Change placeholder text to dark grey
    });*/
    //document.getElementById('header').style.backgroundColor = 'white';  // Change header background to white
	
    // Show the close button
    //document.getElementById('closeBtn').style.display = 'flex';
  // Ensure menu button is displayed
    // Ensure all required fields are filled out
    if (!location || !checkin || !checkout || !guests) {
        alert('Please fill out all required fields.');
        return;
    }
// JavaScript to close the left-container and show the Three.js canvas
// Function to handle the close button click
//document.getElementById('closeBtn').addEventListener('click', function () {
    // Hide the close button and the left container
    //document.getElementById('closeBtn').style.display = 'none';
    //document.getElementById('overlayContainer').style.display = 'none';
//});

// Show spinner and transition to split screen mode
    /*const leftContainer = document.getElementById('left-container');*/
    const globeContainer = document.getElementById('globeContainer');
    const overlay = document.getElementById('overlayContainer');
    // Check if the overlayContainer exists
    if (!overlay) {
        console.error("Overlay container not found!");
        return;
    }
    // Log to confirm the visibility change
    console.log("Displaying overlay...");

    // Use requestAnimationFrame to force a repaint
    /*requestAnimationFrame(() => {
        overlay.style.display = 'grid';
        overlay.classList.add('show');
    });*/
    overlay.style.display = 'grid';
    overlay.style.width= '46%';
    overlay.style.height= '75%';
    overlay.classList.add('show');
    
        overlay.innerHTML = `
            <div class="spinner-container">
                <div class="spinner"></div>
                <p class="spinner-text">Starting the process...</p>
            </div>
        `;
        function hideSpinnerContainer() {
    const spinnerContainer = document.querySelector('.spinner-container');
    if (spinnerContainer) {
        spinnerContainer.style.display = 'none';  // Hide the spinner container
    }
}

  
    // Show the spinner inside the left container
    /*leftContainer.innerHTML = `
        <div class="spinner-container">
            <div class="spinner"></div>
            <p class="spinner-text">Starting the process...</p>
        </div>
    `;
    leftContainer.style.display = 'block'; // Ensure the left container is visible
    

    // Shrink the globe-container to take only half the screen
    globeContainer.classList.add('split');
    leftContainer.classList.add('show'); // Show the left container
	// Switch to split-screen layout
    leftContainer.style.width = '50%';
    globeContainer.style.width = '50%';*/

    // Call the resize function for Three.js
    //resizeThreeJS(); // Ensure Three.js canvas is resized properly

	// Ensure Three.js globe resizes after the DOM update is complete
    //setTimeout(resizeThreeJS, 500); // Delay to ensure layout transition has completed

	// Function to resize the Three.js globe
    /*function resizeThreeJS() {
        if (window.renderer && window.camera) {
            const newWidth = globeContainer.clientWidth;
            const newHeight = globeContainer.clientHeight;
            window.renderer.setSize(newWidth, newHeight);
            window.camera.aspect = newWidth / newHeight;
            window.camera.updateProjectionMatrix();
        }
    }*/

    // Update the spinner text to indicate visiting Airbnb
    updateSpinnerText("Visiting Airbnb site...");

    // Generate the Airbnb search URL
    // Base URL for Airbnb search
    // Construct the initial Airbnb URL (without map bounds)
  // Get today's date
const today = new Date();
const tomorrow = new Date();
tomorrow.setDate(today.getDate() + 1);
 // Get the first day of the current month
const monthlyStartDate = new Date(today.getFullYear(), today.getMonth(), 1);

// Get the end date three months from the current month
const monthlyEndDate = new Date(today.getFullYear(), today.getMonth() + 3, 0); // 0 gives the last day of the previous month
// Format the dates to YYYY-MM-DD
const monthlyStart = monthlyStartDate.toISOString().split('T')[0];  // First day of current month
const monthlyEnd = monthlyEndDate.toISOString().split('T')[0];  // Last day of the month 3 months from now
    let searchUrl = `https://www.airbnb.com/s/${location}/homes?tab_id=home_tab&refinement_paths%5B%5D=%2Fhomes&adults=2&flexible_trip_lengths%5B%5D=one_week&monthly_start_date=${monthlyStart}&monthly_length=3&monthly_end_date=${monthlyEnd}&price_filter_input_type=0&channel=EXPLORE&date_picker_type=calendar&checkin=${checkin}&checkout=${checkout}&adults=${guests}&source=structured_search_input_header&search_type=unknown&price_filter_num_nights=1&drawer_open=true`;

    // Only add price_min and price_max if they have values
    if (priceMin && priceMin.trim() !== "") {
        searchUrl += `&price_min=${priceMin}`;
    }
    if (priceMax && priceMax.trim() !== "") {
        searchUrl += `&price_max=${priceMax}`;
    }
    // Debug the search URL (you can remove this after confirming it works)
    console.log('Generated searchUrl:', searchUrl);

	// Disable globe interactions when the left container is scrolled
    /*overlay.addEventListener('mouseenter', () => {
        globeContainer.classList.add('disable-interaction');
    });

    overlay.addEventListener('mouseleave', () => {
        globeContainer.classList.remove('disable-interaction');
    });*/

    // Update spinner text to indicate fetching data
    updateSpinnerText(`Were searching for the best hotel deals for you  Sit back, relax, and browse while we find your perfect stay! 
    Thank you for your patience! 
    Powered by Expedia`);

    // Fetch Airbnb posts and display them
    fetchAirbnbPosts(searchUrl);
	console.log('Generated searchUrl:', searchUrl);
	console.log('Generated searchUrl:location', location);
	console.log('Generated searchUrl:checkin', checkin);
	console.log('Generated searchUrl:checkout', checkout);
	console.log('Generated searchUrl:guests', guests);
	console.log('Generated searchUrl:priceMin', priceMin);
	console.log('Generated searchUrl:priceMax', priceMax);
	console.log('Fetching data from:', `https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/scrape-airbnb?searchUrl=${encodeURIComponent(searchUrl)}`);
  hideSpinnerContainer();
});

document.getElementById('expediaOption').addEventListener('click', () => {
  dropdownMenu.style.display = 'none'; // Close the dropdown
  //displayExpediaPosts(); // Load Expedia posts
  const carouselContainer1 = document.getElementById('carousel-container');
  const carouselContainer2 = document.getElementById('carousel-container2');
  
  carouselContainer1.style.display = 'none';
  carouselContainer2.style.display = 'none';
    console.log("Airbnb search button clicked.");
    // Your flight search logic here
    const location = document.getElementById('where').value;
    const checkin = document.getElementById('checkin').value;
    const checkout = document.getElementById('checkout').value;
    const guests = document.getElementById('adults').value;
    const priceMin = document.getElementById('price_min').value;
    const priceMax = document.getElementById('price_max').value;
	
    /*const inputs = document.querySelectorAll('#header input');
    inputs.forEach(input => {
        input.style.color = 'darkgrey';  // Change placeholder text to dark grey
    });*/
    //document.getElementById('header').style.backgroundColor = 'white';  // Change header background to white
	
    // Show the close button
    //document.getElementById('closeBtn').style.display = 'flex';
  // Ensure menu button is displayed
    // Ensure all required fields are filled out
    if (!location || !checkin || !checkout || !guests) {
        alert('Please fill out all required fields.');
        return;
    }
// JavaScript to close the left-container and show the Three.js canvas
// Function to handle the close button click
//document.getElementById('closeBtn').addEventListener('click', function () {
    // Hide the close button and the left container
    //document.getElementById('closeBtn').style.display = 'none';
    //document.getElementById('overlayContainer').style.display = 'none';
//});

// Show spinner and transition to split screen mode
    /*const leftContainer = document.getElementById('left-container');*/
    const globeContainer = document.getElementById('globeContainer');
    const overlay = document.getElementById('overlayContainer');
    // Check if the overlayContainer exists
    if (!overlay) {
        console.error("Overlay container not found!");
        return;
    }
    // Log to confirm the visibility change
    console.log("Displaying overlay...");

    // Use requestAnimationFrame to force a repaint
    /*requestAnimationFrame(() => {
        overlay.style.display = 'grid';
        overlay.classList.add('show');
    });*/
    overlay.style.display = 'grid';
    overlay.style.width= '46%';
    overlay.style.height= '75%';
    overlay.classList.add('show');
    
        overlay.innerHTML = `
            <div class="spinner-container">
                <div class="spinner"></div>
                <p class="spinner-text">Starting the process...</p>
            </div>
        `;
        function hideSpinnerContainer() {
    const spinnerContainer = document.querySelector('.spinner-container');
    if (spinnerContainer) {
        spinnerContainer.style.display = 'none';  // Hide the spinner container
    }
}

  
    // Show the spinner inside the left container
    /*leftContainer.innerHTML = `
        <div class="spinner-container">
            <div class="spinner"></div>
            <p class="spinner-text">Starting the process...</p>
        </div>
    `;
    leftContainer.style.display = 'block'; // Ensure the left container is visible
    

    // Shrink the globe-container to take only half the screen
    globeContainer.classList.add('split');
    leftContainer.classList.add('show'); // Show the left container
	// Switch to split-screen layout
    leftContainer.style.width = '50%';
    globeContainer.style.width = '50%';*/

    // Call the resize function for Three.js
    //resizeThreeJS(); // Ensure Three.js canvas is resized properly

	// Ensure Three.js globe resizes after the DOM update is complete
    //setTimeout(resizeThreeJS, 500); // Delay to ensure layout transition has completed

	// Function to resize the Three.js globe
    /*function resizeThreeJS() {
        if (window.renderer && window.camera) {
            const newWidth = globeContainer.clientWidth;
            const newHeight = globeContainer.clientHeight;
            window.renderer.setSize(newWidth, newHeight);
            window.camera.aspect = newWidth / newHeight;
            window.camera.updateProjectionMatrix();
        }
    }*/

    // Update the spinner text to indicate visiting Airbnb
    updateSpinnerText("Visiting Airbnb site...");

    // Generate the Airbnb search URL
    // Base URL for Airbnb search
    // Construct the initial Airbnb URL (without map bounds)
  // Get today's date
const today = new Date();
const tomorrow = new Date();
tomorrow.setDate(today.getDate() + 1);
 // Get the first day of the current month
const monthlyStartDate = new Date(today.getFullYear(), today.getMonth(), 1);

// Get the end date three months from the current month
const monthlyEndDate = new Date(today.getFullYear(), today.getMonth() + 3, 0); // 0 gives the last day of the previous month
// Format the dates to YYYY-MM-DD
const monthlyStart = monthlyStartDate.toISOString().split('T')[0];  // First day of current month
const monthlyEnd = monthlyEndDate.toISOString().split('T')[0];  // Last day of the month 3 months from now
    // Construct Expedia search URL
let expediaSearchUrl = `https://www.expedia.co.uk/Hotel-Search?destination=${encodeURIComponent(location)}&startDate=${checkin}&endDate=${checkout}&adults=${guests}&sort=RECOMMENDED`;

if (priceMin && priceMin.trim() !== "") {
    expediaSearchUrl += `&price=${priceMin}`;
}
if (priceMax && priceMax.trim() !== "") {
    expediaSearchUrl += `&price=${priceMax}`;
}

// Log for debugging
console.log('Generated Expedia Search URL:', expediaSearchUrl);

	// Disable globe interactions when the left container is scrolled
    /*overlay.addEventListener('mouseenter', () => {
        globeContainer.classList.add('disable-interaction');
    });

    overlay.addEventListener('mouseleave', () => {
        globeContainer.classList.remove('disable-interaction');
    });*/

    // Update spinner text to indicate fetching data
    updateSpinnerText(`Were searching across hundreds of hotels for the best hotel deals for you please give us a minute Sit back, relax, and browse while we find your perfect stay! 
    Thank you for your patience! 
    Powered by Expedia`);

    // Fetch Airbnb posts and display them
    fetchExpediaPosts(expediaSearchUrl);
	console.log('Generated searchUrl:', expediaSearchUrl);
	console.log('Generated searchUrl:location', location);
	console.log('Generated searchUrl:checkin', checkin);
	console.log('Generated searchUrl:checkout', checkout);
	console.log('Generated searchUrl:guests', guests);
	console.log('Generated searchUrl:priceMin', priceMin);
	console.log('Generated searchUrl:priceMax', priceMax);
	console.log('Fetching data from:', `https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/scrape-airbnb?searchUrl=${encodeURIComponent(searchUrl)}`);
  hideSpinnerContainer();
});
//const overlayContainer = document.getElementById('overlayContainer');
//const dragHandle = document.querySelector('.drag-handle');

//let isDragging = false;
//let startY, initialHeight;

dragHandle.addEventListener('mousedown', (e) => {
  isDragging = true;
  startY = e.clientY;
  initialHeight = overlayContainer.offsetHeight;

  // Prevent text selection while dragging
  document.body.style.userSelect = 'none';
});

document.addEventListener('mousemove', (e) => {
  if (!isDragging) return;

  const deltaY = e.clientY - startY;
  const newHeight = initialHeight - deltaY;

  if (newHeight >= 40 && newHeight <= window.innerHeight - 50) {
    overlayContainer.style.height = `${newHeight}px`;
    overlayContainer.style.transform = `translateY(${window.innerHeight - newHeight}px)`;
  }
});

document.addEventListener('mouseup', () => {
  if (!isDragging) return;

  isDragging = false;
  document.body.style.userSelect = ''; // Re-enable text selection

  // Snap the overlay to the bottom if it's dragged below a threshold
  const threshold = 100; // Adjust as needed
  if (overlayContainer.offsetHeight < threshold) {
    overlayContainer.classList.add('minimized');
  } else {
    overlayContainer.classList.remove('minimized');
  }
});

// Click handler to maximize the overlay if minimized
overlayContainer.addEventListener('click', () => {
  if (overlayContainer.classList.contains('minimized')) {
    overlayContainer.classList.remove('minimized');
    overlayContainer.style.height = '72.5%'; // Reset to original height
    overlayContainer.style.transform = 'translateY(0)';
  }
});


// Function to fetch Expedia posts from your backend and display them on the webpage
async function fetchExpediaPosts(expediaSearchUrl) {
    try {
        // Update spinner text to indicate scraping started
        updateSpinnerText(`Were searching for the best hotel deals for you  Sit back, relax, and browse while we find your perfect stay! 
    Thank you for your patience! 
    Powered by Expedia`);

        const response = await fetch(`https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/scrape-expedia-posts?expediasearchUrl=${encodeURIComponent(expediaSearchUrl)}`, {
          headers: {
        'ngrok-skip-browser-warning': 'true',
    },
        });
        const data = await response.json();
         // Ensure that 'posts2' is an array before mapping
         const posts2 = Array.isArray(data.posts2) ? data.posts2 : [];

        console.log('Fetched posts:', data);

        // Update spinner text to indicate posts fetched
        updateSpinnerText("Displaying fetched listings...");
// Call populateOverlay to display posts
populateOverlay(posts2);

        // Display the posts on the webpage
       /* const container = document.getElementById('left-container');
        container.style.display = 'block';
        container.innerHTML = posts2.map(post => `
            <div class="post">
      	      <img src="${post.image}" alt="${post.title}" />
      	      <h3>${post.title}</h3>
	      <p>${post.subtitle}</p>
	      <p>Price: ${post.listing_price_details}</p>
	      <p>Rating: ${post.rating_out_of_5_stars}</p>
	      <a href="${post.link}" target="_blank" class="view-link">View Listing</a>
	    </div>
        `).join('');*/

/*function populateOverlay(posts2) {
          const overlay = document.getElementById('overlayContainer');
  overlay.innerHTML = '';  // Clear previous posts

  posts2.forEach(post => {
    const postDiv = document.createElement('div');
    postDiv.classList.add('post');

    // Add image
    const img = document.createElement('img');
    img.src = post.images;
    img.alt = post.title;

    // Add title
    const title = document.createElement('h3');
    title.textContent = post.title;

    // Add subtitle
    const details = document.createElement('p');
    title.textContent = post.subtitle;

    // Add details
    const price = document.createElement('p');
    details.textContent = post.listing_price_details; // Adjust this depending on the post structure

    // Add title
    const rating = document.createElement('p');
    title.textContent = post.rating_out_of_5_stars;
    // Append all elements to the postDiv
    postDiv.appendChild(img);
    postDiv.appendChild(title);
    postDiv.appendChild(details);

    // Append the postDiv to the overlay
    overlay.appendChild(postDiv);
  });
}

      } catch (error) {
        console.error('Error fetching posts:', error);
        // Update spinner text to indicate an error occurred
        updateSpinnerText("Error fetching Airbnb listings. Please try again.");
    }
}
document.querySelectorAll('.post-grid').forEach((item, index) => {
    // Make sure `index` matches the corresponding marker
    item.addEventListener('mouseover', function() {
        if (markers[index]) {  // Check if the marker exists
            markers[index].material.color.set(0x00ff00);  // Highlight the marker in green
        }
    });
    
    item.addEventListener('mouseout', function() {
        if (markers[index]) {
            markers[index].material.color.set(0xffffff);  // Reset the color when mouse leaves (default color)
        }
    });

    item.addEventListener('click', function() {
        if (markers[index]) {
            markers[index].material.color.set(0x00aaff);  // Set the marker color to red on click
        }
    });
});*/
function extractPriceInfo(priceDetails) {
    // Example: "109 77 night 77 per night"
    const regex = /(\d+\s?[$])\s+night\s+(\d+\s?[$])/;
    const match = priceDetails.match(regex);

    if (match) {
        return {
            totalPrice: match[1],         // Total price (e.g., "109 ")
            pricePerNight: match[2]      // Price per night (e.g., "77 ")
        };
    } else {
        console.warn('Price details format not recognized:', priceDetails);
        return { totalPrice: 'N/A', pricePerNight: 'N/A' };
    }
}

function populateOverlay(posts2) {
    const overlay = document.getElementById('overlayContainer');
    overlay.innerHTML = ''; // Clear previous posts
    const overlay2 = document.getElementById('overlayContainer2');
    overlay2.innerHTML = ''; // Clear previous listings
    overlay2.style.display = 'none';

    posts2.forEach((post, index) => {
        const postDiv = document.createElement('div');
        postDiv.classList.add('post');

        // Add image
        const img = document.createElement('img');
        img.src = post.images || ''; // Use default image if not provided
        img.alt = post.title || 'Airbnb Listing';

        // Add title
        const title = document.createElement('h3');
        title.textContent = post.title || 'No title available';

        // Add subtitle
        const subtitle = document.createElement('p');
        subtitle.textContent = post.subtitle || 'No subtitle available';

        // Extract and separate price details
        const priceDetails = document.createElement('p');
        priceDetails.textContent = `Price: ${post.listing_price_details} per night`|| 'N/A';
        //const priceInfo = extractPriceInfo(priceDetails);

        // Add total price
        //const price = document.createElement('p');
        //price.textContent = `Total Price: ${priceInfo.totalPrice || 'N/A'}`;

        // Add price per night
        //const pricePerNight = document.createElement('p');
        //pricePerNight.textContent = `Price per Night: ${priceInfo.pricePerNight || 'N/A'}`;

        // Add rating
        const rating = document.createElement('p');
        rating.textContent = `Rating: ${post.rating_out_of_5_stars} stars`|| 'N/A';

        // Add "View Listing" link
        const viewLink = document.createElement('a');
        viewLink.href = post.link || '#';
        viewLink.target = '_blank';
        viewLink.textContent = 'View Listing';
        viewLink.classList.add('view-link');

        // Add Like button
        const likeButton = document.createElement('button');
        likeButton.textContent = ' Like';
        likeButton.classList.add('like-button');
        likeButton.addEventListener('click', () => saveToLikes(post));

        // Append elements to the postDiv
        postDiv.appendChild(img);
        postDiv.appendChild(title);
        postDiv.appendChild(subtitle);
        postDiv.appendChild(priceDetails);
        postDiv.appendChild(rating);
        postDiv.appendChild(viewLink);
        postDiv.appendChild(likeButton);

        // Append the postDiv to the overlay
        overlay.appendChild(postDiv);
        // Map post to marker events
        postDiv.addEventListener('mouseover', () => {
            if (markers[index]) {
                markers[index].material.color.set(0x00aaff);
            }
        });

        postDiv.addEventListener('mouseout', () => {
            if (markers[index]) {
                markers[index].material.color.set(0x00ff00);
            } });
    });
}


      } catch (error) {
        console.error('Error fetching posts:', error);
        // Update spinner text to indicate an error occurred
        updateSpinnerText("Error fetching Expedia listings. Please try again.");
    }
}
// Function to fetch Airbnb posts from your backend and display them on the webpage
async function fetchAirbnbPosts(searchUrl) {
    try {
        // Update spinner text to indicate scraping started
        updateSpinnerText(`Were searching for the best hotel deals for you  Sit back, relax, and browse while we find your perfect stay! 
    Thank you for your patience! 
    Powered by Expedia`);

        const response = await fetch(`https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/scrape-airbnb?searchUrl=${encodeURIComponent(searchUrl)}`, {
          headers: {
        'ngrok-skip-browser-warning': 'true',
    },
        });
        const data = await response.json();
         // Ensure that 'posts2' is an array before mapping
         const posts2 = Array.isArray(data.posts2) ? data.posts2 : [];

        console.log('Fetched posts:', data);

        // Update spinner text to indicate posts fetched
        updateSpinnerText("Displaying fetched listings...");
// Call populateOverlay to display posts
populateOverlay(posts2);

        // Display the posts on the webpage
       /* const container = document.getElementById('left-container');
        container.style.display = 'block';
        container.innerHTML = posts2.map(post => `
            <div class="post">
      	      <img src="${post.image}" alt="${post.title}" />
      	      <h3>${post.title}</h3>
	      <p>${post.subtitle}</p>
	      <p>Price: ${post.listing_price_details}</p>
	      <p>Rating: ${post.rating_out_of_5_stars}</p>
	      <a href="${post.link}" target="_blank" class="view-link">View Listing</a>
	    </div>
        `).join('');*/

/*function populateOverlay(posts2) {
          const overlay = document.getElementById('overlayContainer');
  overlay.innerHTML = '';  // Clear previous posts

  posts2.forEach(post => {
    const postDiv = document.createElement('div');
    postDiv.classList.add('post');

    // Add image
    const img = document.createElement('img');
    img.src = post.images;
    img.alt = post.title;

    // Add title
    const title = document.createElement('h3');
    title.textContent = post.title;

    // Add subtitle
    const details = document.createElement('p');
    title.textContent = post.subtitle;

    // Add details
    const price = document.createElement('p');
    details.textContent = post.listing_price_details; // Adjust this depending on the post structure

    // Add title
    const rating = document.createElement('p');
    title.textContent = post.rating_out_of_5_stars;
    // Append all elements to the postDiv
    postDiv.appendChild(img);
    postDiv.appendChild(title);
    postDiv.appendChild(details);

    // Append the postDiv to the overlay
    overlay.appendChild(postDiv);
  });
}

      } catch (error) {
        console.error('Error fetching posts:', error);
        // Update spinner text to indicate an error occurred
        updateSpinnerText("Error fetching Airbnb listings. Please try again.");
    }
}
document.querySelectorAll('.post-grid').forEach((item, index) => {
    // Make sure `index` matches the corresponding marker
    item.addEventListener('mouseover', function() {
        if (markers[index]) {  // Check if the marker exists
            markers[index].material.color.set(0x00ff00);  // Highlight the marker in green
        }
    });
    
    item.addEventListener('mouseout', function() {
        if (markers[index]) {
            markers[index].material.color.set(0xffffff);  // Reset the color when mouse leaves (default color)
        }
    });

    item.addEventListener('click', function() {
        if (markers[index]) {
            markers[index].material.color.set(0x00aaff);  // Set the marker color to red on click
        }
    });
});*/
function extractPriceInfo(priceDetails) {
    // Example: "109 77 night 77 per night"
    const regex = /(\d+\s?[$])\s+night\s+(\d+\s?[$])/;
    const match = priceDetails.match(regex);

    if (match) {
        return {
            totalPrice: match[1],         // Total price (e.g., "109 ")
            pricePerNight: match[2]      // Price per night (e.g., "77 ")
        };
    } else {
        console.warn('Price details format not recognized:', priceDetails);
        return { totalPrice: 'N/A', pricePerNight: 'N/A' };
    }
}

function populateOverlay(posts2) {
    const overlay = document.getElementById('overlayContainer');
    overlay.innerHTML = ''; // Clear previous posts
    const overlay2 = document.getElementById('overlayContainer2');
    overlay2.innerHTML = ''; // Clear previous listings
    overlay2.style.display = 'none';

    posts2.forEach((post, index) => {
        const postDiv = document.createElement('div');
        postDiv.classList.add('post');

        // Add image
        const img = document.createElement('img');
        img.src = post.images || ''; // Use default image if not provided
        img.alt = post.title || 'Airbnb Listing';

        // Add title
        const title = document.createElement('h3');
        title.textContent = post.title || 'No title available';

        // Add subtitle
        const subtitle = document.createElement('p');
        subtitle.textContent = post.subtitle || 'No subtitle available';

        // Extract and separate price details
        const priceDetails = document.createElement('p');
        priceDetails.textContent = `Price: ${post.listing_price_details} per night`|| 'N/A';
        //const priceInfo = extractPriceInfo(priceDetails);

        // Add total price
        //const price = document.createElement('p');
        //price.textContent = `Total Price: ${priceInfo.totalPrice || 'N/A'}`;

        // Add price per night
        //const pricePerNight = document.createElement('p');
        //pricePerNight.textContent = `Price per Night: ${priceInfo.pricePerNight || 'N/A'}`;

        // Add rating
        const rating = document.createElement('p');
        rating.textContent = `Rating: ${post.rating_out_of_5_stars} stars`|| 'N/A';

        // Add "View Listing" link
        const viewLink = document.createElement('a');
        viewLink.href = post.link || '#';
        viewLink.target = '_blank';
        viewLink.textContent = 'View Listing';
        viewLink.classList.add('view-link');

        // Add Like button
        const likeButton = document.createElement('button');
        likeButton.textContent = ' Like';
        likeButton.classList.add('like-button');
        likeButton.addEventListener('click', () => saveToLikes(post));

        // Append elements to the postDiv
        postDiv.appendChild(img);
        postDiv.appendChild(title);
        postDiv.appendChild(subtitle);
        postDiv.appendChild(priceDetails);
        postDiv.appendChild(rating);
        postDiv.appendChild(viewLink);
        postDiv.appendChild(likeButton);

        // Append the postDiv to the overlay
        overlay.appendChild(postDiv);
        // Map post to marker events
        postDiv.addEventListener('mouseover', () => {
            if (markers[index]) {
                markers[index].material.color.set(0x00aaff);
            }
        });

        postDiv.addEventListener('mouseout', () => {
            if (markers[index]) {
                markers[index].material.color.set(0x00ff00);
            } });
    });
}


      } catch (error) {
        console.error('Error fetching posts:', error);
        // Update spinner text to indicate an error occurred
        updateSpinnerText("Error fetching Airbnb listings. Please try again.");
    }
}





// Add an event listener to the profile button to show liked posts
document.getElementById('likedPostsButton').addEventListener('click', showLikedPosts);

document.querySelectorAll('.post .view-link').forEach((item, index) => {
    // Make sure `index` matches the corresponding marker
    item.addEventListener('mouseover', function() {
        if (markers[index]) {  // Check if the marker exists
            markers[index].material.color.set(0x00aaff);  // Highlight the marker in green
        }
    });
    
    item.addEventListener('mouseout', function() {
        if (markers[index]) {
            markers[index].material.color.set(0x00ff00);  // Reset the color when mouse leaves (default color)
        }
    });

    item.addEventListener('click', function() {
        if (markers[index]) {
            markers[index].material.color.set(0x87CEFA);  // Set the marker color to red on click
        }
    });
});

	  // A lookup table for example (you can expand this)
// Lookup table with expanded locations, including Jamaica
/*const locations = {
    "new york": { lat: 40.7128, lng: -74.0060 },
    "los angeles": { lat: 34.0522, lng: -118.2437 },
    "chicago": { lat: 41.8781, lng: -87.6298 },
    "miami": { lat: 25.7617, lng: -80.1918 },
    "san francisco": { lat: 37.7749, lng: -122.4194 },
    "washington dc": { lat: 38.9072, lng: -77.0369 },
    "london": { lat: 51.5074, lng: -0.1278 },
    "paris": { lat: 48.8566, lng: 2.3522 },
    "berlin": { lat: 52.5200, lng: 13.4050 },
    "rome": { lat: 41.9028, lng: 12.4964 },
    "madrid": { lat: 40.4168, lng: -3.7038 },
    "barcelona": { lat: 41.3851, lng: 2.1734 },
    "moscow": { lat: 55.7558, lng: 37.6173 },
    "tokyo": { lat: 35.6895, lng: 139.6917 },
    "beijing": { lat: 39.9042, lng: 116.4074 },
    "shanghai": { lat: 31.2304, lng: 121.4737 },
    "sydney": { lat: -33.8688, lng: 151.2093 },
    "melbourne": { lat: -37.8136, lng: 144.9631 },
    "rio de janeiro": { lat: -22.9068, lng: -43.1729 },
    "so paulo": { lat: -23.5505, lng: -46.6333 },
    "mexico city": { lat: 19.4326, lng: -99.1332 },
    "toronto": { lat: 43.651070, lng: -79.347015 },
    "vancouver": { lat: 49.2827, lng: -123.1207 },
    "montreal": { lat: 45.5017, lng: -73.5673 },
    "buenos aires": { lat: -34.6037, lng: -58.3816 },
    "cape town": { lat: -33.9249, lng: 18.4241 },
    "johannesburg": { lat: -26.2041, lng: 28.0473 },
    "cairo": { lat: 30.0444, lng: 31.2357 },
    "dubai": { lat: 25.2048, lng: 55.2708 },
    "istanbul": { lat: 41.0082, lng: 28.9784 },
    "delhi": { lat: 28.6139, lng: 77.2090 },
    "mumbai": { lat: 19.0760, lng: 72.8777 },
    "hong kong": { lat: 22.3193, lng: 114.1694 },
    "bangkok": { lat: 13.7563, lng: 100.5018 },
    "singapore": { lat: 1.3521, lng: 103.8198 },
    "kuala lumpur": { lat: 3.1390, lng: 101.6869 },
    "jakarta": { lat: -6.2088, lng: 106.8456 },
    "seoul": { lat: 37.5665, lng: 126.9780 },
    "lagos": { lat: 6.5244, lng: 3.3792 },
    "casablanca": { lat: 33.5731, lng: -7.5898 },
    "nairobi": { lat: -1.286389, lng: 36.817223 },
    "lima": { lat: -12.0464, lng: -77.0428 },
    "santiago": { lat: -33.4489, lng: -70.6693 },
    "athens": { lat: 37.9838, lng: 23.7275 },
    "lisbon": { lat: 38.7223, lng: -9.1393 },
    "vienna": { lat: 48.2082, lng: 16.3738 },
    "stockholm": { lat: 59.3293, lng: 18.0686 },
    "oslo": { lat: 59.9139, lng: 10.7522 },
    "helsinki": { lat: 60.1695, lng: 24.9354 },
    "warsaw": { lat: 52.2297, lng: 21.0122 },
    "zurich": { lat: 47.3769, lng: 8.5417 },
    "brussels": { lat: 50.8503, lng: 4.3517 },
    "amsterdam": { lat: 52.3676, lng: 4.9041 },
    "dublin": { lat: 53.3498, lng: -6.2603 },
    "copenhagen": { lat: 55.6761, lng: 12.5683 },
    "budapest": { lat: 47.4979, lng: 19.0402 },
    "prague": { lat: 50.0755, lng: 14.4378 },
    "doha": { lat: 25.276987, lng: 51.521067 },
    "jamaica": { lat: 18.1096, lng: -77.2975 } // Added Jamaica
};*/

	  /*const locations = {
    "new york": { lat: 40.7128, lng: -74.0060, zoom: 2.5 },
    "los angeles": { lat: 34.0522, lng: -118.2437, zoom: 2.2 },
    "chicago": { lat: 41.8781, lng: -87.6298, zoom: 2.5 },
    "miami": { lat: 25.7617, lng: -80.1918, zoom: 2.7 },
    "san francisco": { lat: 37.7749, lng: -122.4194, zoom: 2.4 },
    "washington dc": { lat: 38.9072, lng: -77.0369, zoom: 2.5 },
    "london": { lat: 51.5074, lng: -0.1278, zoom: 2.8 },
    "paris": { lat: 48.8566, lng: 2.3522, zoom: 2.8 },
    "berlin": { lat: 52.5200, lng: 13.4050, zoom: 2.7 },
    "rome": { lat: 41.9028, lng: 12.4964, zoom: 2.9 },
    "madrid": { lat: 40.4168, lng: -3.7038, zoom: 2.7 },
    "barcelona": { lat: 41.3851, lng: 2.1734, zoom: 2.8 },
    "moscow": { lat: 55.7558, lng: 37.6173, zoom: 2.6 },
    "tokyo": { lat: 35.6895, lng: 139.6917, zoom: 2.9 },
    "beijing": { lat: 39.9042, lng: 116.4074, zoom: 2.8 },
    "shanghai": { lat: 31.2304, lng: 121.4737, zoom: 2.7 },
    "sydney": { lat: -33.8688, lng: 151.2093, zoom: 2.6 },
    "melbourne": { lat: -37.8136, lng: 144.9631, zoom: 2.7 },
    "rio de janeiro": { lat: -22.9068, lng: -43.1729, zoom: 2.8 },
    "so paulo": { lat: -23.5505, lng: -46.6333, zoom: 2.6 },
    "mexico city": { lat: 19.4326, lng: -99.1332, zoom: 2.7 },
    "toronto": { lat: 43.651070, lng: -79.347015, zoom: 2.5 },
    "vancouver": { lat: 49.2827, lng: -123.1207, zoom: 2.4 },
    "montreal": { lat: 45.5017, lng: -73.5673, zoom: 2.5 },
    "buenos aires": { lat: -34.6037, lng: -58.3816, zoom: 2.9 },
    "cape town": { lat: -33.9249, lng: 18.4241, zoom: 2.8 },
    "johannesburg": { lat: -26.2041, lng: 28.0473, zoom: 2.7 },
    "cairo": { lat: 30.0444, lng: 31.2357, zoom: 2.9 },
    "dubai": { lat: 25.2048, lng: 55.2708, zoom: 2.8 },
    "istanbul": { lat: 41.0082, lng: 28.9784, zoom: 2.7 },
    "delhi": { lat: 28.6139, lng: 77.2090, zoom: 2.8 },
    "mumbai": { lat: 19.0760, lng: 72.8777, zoom: 2.8 },
    "hong kong": { lat: 22.3193, lng: 114.1694, zoom: 2.9 },
    "bangkok": { lat: 13.7563, lng: 100.5018, zoom: 2.8 },
    "singapore": { lat: 1.3521, lng: 103.8198, zoom: 2.9 },
    "kuala lumpur": { lat: 3.1390, lng: 101.6869, zoom: 2.8 },
    "jakarta": { lat: -6.2088, lng: 106.8456, zoom: 2.7 },
    "seoul": { lat: 37.5665, lng: 126.9780, zoom: 2.8 },
    "lagos": { lat: 6.5244, lng: 3.3792, zoom: 2.6 },
    "casablanca": { lat: 33.5731, lng: -7.5898, zoom: 2.7 },
    "nairobi": { lat: -1.2864, lng: 36.8172, zoom: 2.6 },
    "lima": { lat: -12.0464, lng: -77.0428, zoom: 2.7 },
    "santiago": { lat: -33.4489, lng: -70.6693, zoom: 2.7 },
    "athens": { lat: 37.9838, lng: 23.7275, zoom: 2.8 },
    "lisbon": { lat: 38.7223, lng: -9.1393, zoom: 2.7 },
    "vienna": { lat: 48.2082, lng: 16.3738, zoom: 2.8 },
    "stockholm": { lat: 59.3293, lng: 18.0686, zoom: 2.7 },
    "oslo": { lat: 59.9139, lng: 10.7522, zoom: 2.7 },
    "helsinki": { lat: 60.1695, lng: 24.9354, zoom: 2.7 },
    "warsaw": { lat: 52.2297, lng: 21.0122, zoom: 2.8 },
    "zurich": { lat: 47.3769, lng: 8.5417, zoom: 2.8 },
    "brussels": { lat: 50.8503, lng: 4.3517, zoom: 2.8 },
    "amsterdam": { lat: 52.3676, lng: 4.9041, zoom: 2.8 },
    "dublin": { lat: 53.3498, lng: -6.2603, zoom: 2.8 },
    "copenhagen": { lat: 55.6761, lng: 12.5683, zoom: 2.7 },
    "budapest": { lat: 47.4979, lng: 19.0402, zoom: 2.8 },
    "prague": { lat: 50.0755, lng: 14.4378, zoom: 2.8 },
    "doha": { lat: 25.276987, lng: 51.521067, zoom: 2.7 },
    "jamaica": { lat: 18.1096, lng: -77.2975, zoom: 2.6 },
    "united states": { lat: 37.0902, lng: -95.7129, zoom: 2.4 },
    "canada": { lat: 56.1304, lng: -106.3468, zoom: 2.4 },
    "mexico": { lat: 23.6345, lng: -102.5528, zoom: 2.5 },
    "brazil": { lat: -14.2350, lng: -51.9253, zoom: 2.6 },
    "argentina": { lat: -38.4161, lng: -63.6167, zoom: 2.7 },
    "united kingdom": { lat: 55.3781, lng: -3.4360, zoom: 2.6 },
    "france": { lat: 46.6034, lng: 2.2137, zoom: 2.8 },
    "germany": { lat: 51.1657, lng: 10.4515, zoom: 2.8 },
    "italy": { lat: 41.8719, lng: 12.5674, zoom: 2.8 },
    "spain": { lat: 40.4637, lng: -3.7492, zoom: 2.7 },
    "portugal": { lat: 39.3999, lng: -8.2245, zoom: 2.7 },
    "russia": { lat: 61.5240, lng: 105.3188, zoom: 2.4 },
    "china": { lat: 35.8617, lng: 104.1954, zoom: 2.6 },
    "japan": { lat: 36.2048, lng: 138.2529, zoom: 2.7 },
    "india": { lat: 20.5937, lng: 78.9629, zoom: 2.7 },
    "australia": { lat: -25.2744, lng: 133.7751, zoom: 2.5 },
    "south africa": { lat: -30.5595, lng: 22.9375, zoom: 2.6 },
    "egypt": { lat: 26.8206, lng: 30.8025, zoom: 2.8 },
    "nigeria": { lat: 9.0820, lng: 8.6753, zoom: 2.7 },
    "kenya": { lat: -1.2921, lng: 36.8219, zoom: 2.7 },
    "south korea": { lat: 35.9078, lng: 127.7669, zoom: 2.8 },
    "indonesia": { lat: -0.7893, lng: 113.9213, zoom: 2.7 },
    "saudi arabia": { lat: 23.8859, lng: 45.0792, zoom: 2.7 },
    "iran": { lat: 32.4279, lng: 53.6880, zoom: 2.7 },
    "turkey": { lat: 38.9637, lng: 35.2433, zoom: 2.7 },
    "israel": { lat: 31.0461, lng: 34.8516, zoom: 2.8 },
    "greece": { lat: 39.0742, lng: 21.8243, zoom: 2.8 },
    "thailand": { lat: 15.8700, lng: 100.9925, zoom: 2.7 },
    "vietnam": { lat: 14.0583, lng: 108.2772, zoom: 2.7 },
    "new zealand": { lat: -40.9006, lng: 174.8860, zoom: 2.5 },
    "pakistan": { lat: 30.3753, lng: 69.3451, zoom: 2.7 },
    "afghanistan": { lat: 33.9391, lng: 67.7100, zoom: 2.6 },
    "colombia": { lat: 4.5709, lng: -74.2973, zoom: 2.7 },
    "venezuela": { lat: 6.4238, lng: -66.5897, zoom: 2.7 }
};*/
const locations = {
    "africa": { lat: 8.5, lng: 18.2, zoom: 1.4 },
    "europe": { lat: 49.2, lng: 9.5, zoom: 1.4 },
    "america": { lat: 39.0, lng: -101.8, zoom: 1.4 },
    "south america": { lat: -11.0, lng: -56.0, zoom: 1.4 },
    "carribbean": { lat: 19.0, lng: -76.0, zoom: 1.4 },
    "asia": { lat: 29.5, lng: 98.7, zoom: 1.4 },
    "world": { lat: -0.5, lng: -1.0, zoom: 1.4 },
    "new york": { lat: 40.7, lng: -74.0, zoom: 1.4 },
    "los angeles": { lat: 34.0, lng: -118.2, zoom: 1.4 },
    "chicago": { lat: 41.8, lng: -87.6, zoom: 1.4 },
    "miami": { lat: 25.8, lng: -80.1, zoom: 1.4 },
    "san francisco": { lat: 37.8, lng: -122.4, zoom: 1.4 },
    "washington dc": { lat: 38.9, lng: -77.0, zoom: 1.4 },
    "london": { lat: 51.5, lng: -0.2, zoom: 1.4 },
    "paris": { lat: 48.9, lng: 2.4, zoom: 1.4 },
    "berlin": { lat: 52.5, lng: 13.4, zoom: 1.4 },
    "rome": { lat: 41.9, lng: 12.5, zoom: 1.4 },
    "madrid": { lat: 40.4, lng: -3.7, zoom: 1.4 },
    "barcelona": { lat: 41.4, lng: 2.2, zoom: 1.4 },
    "moscow": { lat: 55.8, lng: 37.6, zoom: 1.4 },
    "tokyo": { lat: 35.7, lng: 139.7, zoom: 1.4 },
    "beijing": { lat: 39.9, lng: 116.4, zoom: 1.4 },
    "shanghai": { lat: 31.2, lng: 121.5, zoom: 1.4 },
    "sydney": { lat: -33.9, lng: 151.2, zoom: 1.4 },
    "melbourne": { lat: -37.8, lng: 144.9, zoom: 1.4 },
    "rio de janeiro": { lat: -22.9, lng: -43.2, zoom: 1.4 },
    "so paulo": { lat: -23.5, lng: -46.6, zoom: 1.4 },
    "mexico city": { lat: 19.4, lng: -99.1, zoom: 1.4 },
    "toronto": { lat: 43.7, lng: -79.3, zoom: 1.4 },
    "vancouver": { lat: 49.3, lng: -123.1, zoom: 1.4 },
    "montreal": { lat: 45.5, lng: -73.6, zoom: 1.4 },
    "buenos aires": { lat: -34.6, lng: -58.4, zoom: 1.4 },
    "cape town": { lat: -33.9, lng: 18.4, zoom: 1.4 },
    "johannesburg": { lat: -26.2, lng: 28.0, zoom: 1.4 },
    "cairo": { lat: 30.0, lng: 31.2, zoom: 1.4 },
    "dubai": { lat: 25.2, lng: 55.3, zoom: 1.4 },
    "istanbul": { lat: 41.0, lng: 29.0, zoom: 1.4 },
    "delhi": { lat: 28.6, lng: 77.2, zoom: 1.4 },
    "mumbai": { lat: 19.1, lng: 72.9, zoom: 1.4 },
    "hong kong": { lat: 22.3, lng: 114.2, zoom: 1.4 },
    "bangkok": { lat: 13.8, lng: 100.5, zoom: 1.4 },
    "singapore": { lat: 1.4, lng: 103.8, zoom: 1.4 },
    "kuala lumpur": { lat: 3.1, lng: 101.7, zoom: 1.4 },
    "jakarta": { lat: -6.2, lng: 106.8, zoom: 1.4 },
    "seoul": { lat: 37.6, lng: 126.9, zoom: 1.4 },
    "lagos": { lat: 6.5, lng: 3.4, zoom: 1.4 },
    "casablanca": { lat: 33.6, lng: -7.6, zoom: 1.4 },
    "nairobi": { lat: -1.3, lng: 36.8, zoom: 1.4 },
    "lima": { lat: -12.0, lng: -77.0, zoom: 1.4 },
    "santiago": { lat: -33.4, lng: -70.7, zoom: 1.4 },
    "athens": { lat: 38.0, lng: 23.7, zoom: 1.4 },
    "lisbon": { lat: 38.7, lng: -9.1, zoom: 1.4 },
    "vienna": { lat: 48.2, lng: 16.4, zoom: 1.4 },
    "stockholm": { lat: 59.3, lng: 18.1, zoom: 1.4 },
    "oslo": { lat: 59.9, lng: 10.8, zoom: 1.4 },
    "helsinki": { lat: 60.2, lng: 24.9, zoom: 1.4 },
    "warsaw": { lat: 52.2, lng: 21.0, zoom: 1.4 },
    "zurich": { lat: 47.4, lng: 8.5, zoom: 1.4 },
    "brussels": { lat: 50.8, lng: 4.4, zoom: 1.4 },
    "amsterdam": { lat: 52.4, lng: 4.9, zoom: 1.4 },
    "dublin": { lat: 53.3, lng: -6.3, zoom: 1.4 },
    "copenhagen": { lat: 55.7, lng: 12.6, zoom: 1.4 },
    "budapest": { lat: 47.5, lng: 19.0, zoom: 1.4 },
    "prague": { lat: 50.1, lng: 14.4, zoom: 1.4 },
    "doha": { lat: 25.3, lng: 51.5, zoom: 1.4 },
    "jamaica": { lat: 18.1, lng: -77.3, zoom: 1.4 },
    "united states": { lat: 37.1, lng: -95.7, zoom: 1.4 },
    "canada": { lat: 56.1, lng: -106.3, zoom: 1.4 },
    "mexico": { lat: 23.6, lng: -102.6, zoom: 1.4 },
    "brazil": { lat: -14.2, lng: -51.9, zoom: 1.4 },
    "argentina": { lat: -38.4, lng: -63.6, zoom: 1.4 },
    "united kingdom": { lat: 55.4, lng: -3.4, zoom: 1.4 },
    "france": { lat: 46.6, lng: 2.2, zoom: 1.4 },
    "germany": { lat: 51.2, lng: 10.4, zoom: 1.4 },
    "italy": { lat: 41.9, lng: 12.6, zoom: 1.4 },
    "spain": { lat: 40.5, lng: -3.7, zoom: 1.4 },
    "portugal": { lat: 39.4, lng: -8.2, zoom: 1.4 },
    "russia": { lat: 61.5, lng: 105.3, zoom: 1.4 },
    "china": { lat: 35.9, lng: 104.2, zoom: 1.4 },
    "japan": { lat: 36.2, lng: 138.3, zoom: 1.4 },
    "india": { lat: 20.6, lng: 78.9, zoom: 1.4 },
    "australia": { lat: -25.3, lng: 133.8, zoom: 1.4 },
    "south africa": { lat: -30.6, lng: 22.9, zoom: 1.4 },
    "egypt": { lat: 26.8, lng: 30.8, zoom: 1.4 },
    "nigeria": { lat: 9.1, lng: 8.7, zoom: 1.4 },
    "kenya": { lat: -1.3, lng: 36.8, zoom: 1.4 },
    "south korea": { lat: 35.9, lng: 127.8, zoom: 1.4 },
    "indonesia": { lat: -0.8, lng: 113.9, zoom: 1.4 },
    "saudi arabia": { lat: 23.9, lng: 45.1, zoom: 1.4 },
    "iran": { lat: 32.4, lng: 53.7, zoom: 1.4 },
    "turkey": { lat: 39.0, lng: 35.2, zoom: 1.4 },
    "israel": { lat: 31.0, lng: 34.9, zoom: 1.4 },
    "greece": { lat: 39.1, lng: 21.8, zoom: 1.4 },
    "thailand": { lat: 15.9, lng: 101.0, zoom: 1.4 },
    "vietnam": { lat: 14.1, lng: 108.3, zoom: 1.4 },
    "new zealand": { lat: -40.9, lng: 174.9, zoom: 1.4 },
    "pakistan": { lat: 30.4, lng: 69.3, zoom: 1.4 },
    "afghanistan": { lat: 33.9, lng: 67.7, zoom: 1.4 },
    "colombia": { lat: 4.6, lng: -74.3, zoom: 1.4 },
    "venezuela": { lat: 6.4, lng: -66.6, zoom: 1.4 },
    "hawaii": { lat: 21.3069, lng: -157.8583, zoom: 1.4 }
};
const Locations = {
    "africa": { lat: 8.5, lng: -161.8, zoom: 1.4 },
    "europe": { lat: 49.2, lng: -170.5, zoom: 1.4 },
    "america": { lat: 39.0, lng: -101.8, zoom: 1.4 },
    "south america": { lat: -11.0, lng: 124.0, zoom: 1.4 },
    "carribbean": { lat: 19.0, lng: 104.0, zoom: 1.4 },
    "asia": { lat: 29.5, lng: -81.3, zoom: 1.4 },
    "world": { lat: -0.5, lng: 179.0, zoom: 1.4 },
    "new york": { lat: 40.7, lng: 106.0, zoom: 1.4 },
    "los angeles": { lat: 34.0, lng: 61.8, zoom: 1.4 },
    "chicago": { lat: 41.8, lng: 92.4, zoom: 1.4 },
    "miami": { lat: 25.8, lng: 99.9, zoom: 1.4 },
    "san francisco": { lat: 37.8, lng: 57.6, zoom: 1.4 },
    "washington dc": { lat: 38.9, lng: 103.0, zoom: 1.4 },
    "london": { lat: 51.5, lng: -179.8, zoom: 1.4 },
    "paris": { lat: 48.9, lng: -177.6, zoom: 1.4 },
    "berlin": { lat: 52.5, lng: -166.6, zoom: 1.4 },
    "rome": { lat: 41.9, lng: -167.5, zoom: 1.4 },
    "madrid": { lat: 40.4, lng: 176.3, zoom: 1.4 },
    "barcelona": { lat: 41.4, lng: -177.8, zoom: 1.4 },
    "moscow": { lat: 55.8, lng: -142.4, zoom: 1.4 },
    "tokyo": { lat: 35.7, lng: 40.3, zoom: 1.4 },
    "beijing": { lat: 39.9, lng: 63.6, zoom: 1.4 },
    "shanghai": { lat: 31.2, lng: 58.5, zoom: 1.4 },
    "sydney": { lat: -33.9, lng: -28.8, zoom: 1.4 },
    "melbourne": { lat: -37.8, lng: -35.1, zoom: 1.4 },
    "rio de janeiro": { lat: -22.9, lng: 136.8, zoom: 1.4 },
    "so paulo": { lat: -23.5, lng: 133.4, zoom: 1.4 },
    "mexico city": { lat: 19.4, lng: 80.9, zoom: 1.4 },
    "toronto": { lat: 43.7, lng: 100.7, zoom: 1.4 },
    "vancouver": { lat: 49.3, lng: 56.9, zoom: 1.4 },
    "montreal": { lat: 45.5, lng: 106.4, zoom: 1.4 },
    "buenos aires": { lat: -34.6, lng: 121.6, zoom: 1.4 },
    "cape town": { lat: -33.9, lng: -161.6, zoom: 1.4 },
    "johannesburg": { lat: -26.2, lng: -152.0, zoom: 1.4 },
    "cairo": { lat: 30.0, lng: -148.8, zoom: 1.4 },
    "dubai": { lat: 25.2, lng: -124.7, zoom: 1.4 },
    "istanbul": { lat: 41.0, lng: -151.0, zoom: 1.4 },
    "delhi": { lat: 28.6, lng: -102.8, zoom: 1.4 },
    "mumbai": { lat: 19.1, lng: -107.1, zoom: 1.4 },
    "hong kong": { lat: 22.3, lng: 65.8, zoom: 1.4 },
    "bangkok": { lat: 13.8, lng: 79.5, zoom: 1.4 },
    "singapore": { lat: 1.4, lng: 76.2, zoom: 1.4 },
    "kuala lumpur": { lat: 3.1, lng: 78.3, zoom: 1.4 },
    "jakarta": { lat: -6.2, lng: 73.2, zoom: 1.4 },
    "seoul": { lat: 37.6, lng: 53.1, zoom: 1.4 },
    "lagos": { lat: 6.5, lng: 176.6, zoom: 1.4 },
    "casablanca": { lat: 33.6, lng: -172.4, zoom: 1.4 },
    "nairobi": { lat: -1.3, lng: -143.2, zoom: 1.4 },
    "lima": { lat: -12.0, lng: 103.0, zoom: 1.4 },
    "santiago": { lat: -33.4, lng: 109.3, zoom: 1.4 },
    "athens": { lat: 38.0, lng: -158.3, zoom: 1.4 },
    "lisbon": { lat: 38.7, lng: -170.9, zoom: 1.4 },
    "vienna": { lat: 48.2, lng: -163.6, zoom: 1.4 },
    "stockholm": { lat: 59.3, lng: -161.9, zoom: 1.4 },
    "oslo": { lat: 59.9, lng: -169.2, zoom: 1.4 },
    "helsinki": { lat: 60.2, lng: -155.1, zoom: 1.4 },
    "warsaw": { lat: 52.2, lng: -159.0, zoom: 1.4 },
    "zurich": { lat: 47.4, lng: -171.5, zoom: 1.4 },
    "brussels": { lat: 50.8, lng: -175.6, zoom: 1.4 },
    "amsterdam": { lat: 52.4, lng: -175.1, zoom: 1.4 },
    "dublin": { lat: 53.3, lng: -173.7, zoom: 1.4 },
    "copenhagen": { lat: 55.7, lng: -167.4, zoom: 1.4 },
    "budapest": { lat: 47.5, lng: -161.0, zoom: 1.4 },
    "prague": { lat: 50.1, lng: -165.6, zoom: 1.4 },
    "doha": { lat: 25.3, lng: -128.5, zoom: 1.4 },
    "jamaica": { lat: 18.1, lng: 102.7, zoom: 1.4 },
    "united states": { lat: 37.1, lng: 84.3, zoom: 1.4 },
    "canada": { lat: 56.1, lng: 73.7, zoom: 1.4 },
    "mexico": { lat: 23.6, lng: 77.4, zoom: 1.4 },
    "brazil": { lat: -14.2, lng: 128.1, zoom: 1.4 },
    "argentina": { lat: -38.4, lng: 116.4, zoom: 1.4 },
    "united kingdom": { lat: 55.4, lng: -176.6, zoom: 1.4 },
    "france": { lat: 46.6, lng: -177.8, zoom: 1.4 },
    "germany": { lat: 51.2, lng: -169.6, zoom: 1.4 },
    "italy": { lat: 41.9, lng: -167.4, zoom: 1.4 },
    "spain": { lat: 40.5, lng: -176.3, zoom: 1.4 },
    "portugal": { lat: 39.4, lng: -171.8, zoom: 1.4 },
    "russia": { lat: 61.5, lng: -74.7, zoom: 1.4 },
    "china": { lat: 35.9, lng: -75.8, zoom: 1.4 },
    "japan": { lat: 36.2, lng: -41.7, zoom: 1.4 },
    "india": { lat: 20.6, lng: -101.1, zoom: 1.4 },
    "australia": { lat: -25.3, lng: -46.2, zoom: 1.4 },
    "south africa": { lat: -30.6, lng: -157.1, zoom: 1.4 },
    "egypt": { lat: 26.8, lng: -149.2, zoom: 1.4 },
    "nigeria": { lat: 9.1, lng: -171.3, zoom: 1.4 },
    "kenya": { lat: -1.3, lng: -143.2, zoom: 1.4 },
    "south korea": { lat: 35.9, lng: -53.8, zoom: 1.4 },
    "indonesia": { lat: -0.8, lng: -66.1, zoom: 1.4 },
    "saudi arabia": { lat: 23.9, lng: -134.9, zoom: 1.4 },
    "iran": { lat: 32.4, lng: -126.3, zoom: 1.4 },
    "turkey": { lat: 39.0, lng: -144.8, zoom: 1.4 },
    "israel": { lat: 31.0, lng: -145.1, zoom: 1.4 },
    "greece": { lat: 39.1, lng: -158.2, zoom: 1.4 },
    "thailand": { lat: 15.9, lng: -79.0, zoom: 1.4 },
    "vietnam": { lat: 14.1, lng: -71.7, zoom: 1.4 },
    "new zealand": { lat: -40.9, lng: 5.1, zoom: 1.4 },
    "pakistan": { lat: 30.4, lng: -110.7, zoom: 1.4 },
    "afghanistan": { lat: 33.9, lng: -112.3, zoom: 1.4 },
    "colombia": { lat: 4.6, lng: 105.7, zoom: 1.4 },
    "venezuela": { lat: 6.4, lng: 113.4, zoom: 1.4 },
    "hawaii": { lat: 21.3069, lng: 22.1417, zoom: 1.4 }
};
/*const Locationsfixed = {
  "africa": {"lat": 8.5, "lng": -161.8, "zoom": 1.4},
  "europe": {"lat": 49.2, "lng": -170.5, "zoom": 1.4},
  "america": {"lat": 39.0, "lng": -101.8, "zoom": 1.4},
  "south america": {"lat": -11.0, "lng": -56.0, "zoom": 1.4},
  "carribbean": {"lat": 19.0, "lng": -76.0, "zoom": 1.4},
  "asia": {"lat": 29.5, "lng": -81.3, "zoom": 1.4},
  "world": {"lat": -0.5, "lng": -181.0, "zoom": 1.4},
  "new york": {"lat": 40.7, "lng": -74.0, "zoom": 1.4},
  "los angeles": {"lat": 34.0, "lng": -118.2, "zoom": 1.4},
  "chicago": {"lat": 41.8, "lng": -87.6, "zoom": 1.4},
  "miami": {"lat": 25.8, "lng": -80.1, "zoom": 1.4},
  "san francisco": {"lat": 37.8, "lng": -122.4, "zoom": 1.4},
  "washington dc": {"lat": 38.9, "lng": -77.0, "zoom": 1.4},
  "london": {"lat": 51.5, "lng": -0.2, "zoom": 1.4},
  "paris": {"lat": 48.9, "lng": -177.6, "zoom": 1.4},
  "berlin": {"lat": 52.5, "lng": -166.6, "zoom": 1.4},
  "rome": {"lat": 41.9, "lng": -167.5, "zoom": 1.4},
  "madrid": {"lat": 40.4, "lng": -3.7, "zoom": 1.4},
  "barcelona": {"lat": 41.4, "lng": -177.8, "zoom": 1.4},
  "moscow": {"lat": 55.8, "lng": -142.4, "zoom": 1.4},
  "tokyo": {"lat": 35.7, "lng": -40.3, "zoom": 1.4},
  "beijing": {"lat": 39.9, "lng": -63.6, "zoom": 1.4},
  "shanghai": {"lat": 31.2, "lng": -58.5, "zoom": 1.4},
  "sydney": {"lat": -33.9, "lng": -28.8, "zoom": 1.4},
  "melbourne": {"lat": -37.8, "lng": -35.1, "zoom": 1.4},
  "rio de janeiro": {"lat": -22.9, "lng": -43.2, "zoom": 1.4},
  "so paulo": {"lat": -23.5, "lng": -46.6, "zoom": 1.4},
  "mexico city": {"lat": 19.4, "lng": -99.1, "zoom": 1.4},
  "toronto": {"lat": 43.7, "lng": -79.3, "zoom": 1.4},
  "vancouver": {"lat": 49.3, "lng": -123.1, "zoom": 1.4},
  "montreal": {"lat": 45.5, "lng": -73.6, "zoom": 1.4},
  "buenos aires": {"lat": -34.6, "lng": -58.4, "zoom": 1.4},
  "cape town": {"lat": -33.9, "lng": -161.6, "zoom": 1.4},
  "johannesburg": {"lat": -26.2, "lng": -152.0, "zoom": 1.4},
  "cairo": {"lat": 30.0, "lng": -148.8, "zoom": 1.4},
  "dubai": {"lat": 25.2, "lng": -124.7, "zoom": 1.4},
  "istanbul": {"lat": 41.0, "lng": -151.0, "zoom": 1.4},
  "delhi": {"lat": 28.6, "lng": -102.8, "zoom": 1.4},
  "mumbai": {"lat": 19.1, "lng": -107.1, "zoom": 1.4},
  "hong kong": {"lat": 22.3, "lng": -65.8, "zoom": 1.4},
  "bangkok": {"lat": 13.8, "lng": -79.5, "zoom": 1.4},
  "singapore": {"lat": 1.4, "lng": -76.2, "zoom": 1.4},
  "kuala lumpur": {"lat": 3.1, "lng": -78.3, "zoom": 1.4},
  "jakarta": {"lat": -6.2, "lng": -73.2, "zoom": 1.4},
  "seoul": {"lat": 37.6, "lng": -53.1, "zoom": 1.4},
  "lagos": {"lat": 6.5, "lng": -176.6, "zoom": 1.4},
  "athens": {"lat": 38.0, "lng": -156.3, "zoom": 1.4},
  "vienna": {"lat": 48.2, "lng": -163.6, "zoom": 1.4},
  "stockholm": {"lat": 59.3, "lng": -161.9, "zoom": 1.4},
  "oslo": {"lat": 59.9, "lng": -169.2, "zoom": 1.4},
  "helsinki": {"lat": 60.2, "lng": -155.1, "zoom": 1.4},
  "warsaw": {"lat": 52.2, "lng": -159.0, "zoom": 1.4},
  "zurich": {"lat": 47.4, "lng": -171.5, "zoom": 1.4},
  "brussels": {"lat": 50.8, "lng": -175.6, "zoom": 1.4},
  "amsterdam": {"lat": 52.4, "lng": -175.1, "zoom": 1.4},
  "dublin": {"lat": 53.3, "lng": -6.3, "zoom": 1.4},
  "copenhagen": {"lat": 55.7, "lng": -167.4, "zoom": 1.4},
  "prague": {"lat": 50.1, "lng": -165.6, "zoom": 1.4},
  "jamaica": {"lat": 18.1, "lng": -77.3, "zoom": 1.4},
  "hawaii": {"lat": 21.3, "lng": -157.9, "zoom": 1.4}
}*/
const Locationsfixed = {
    "africa": {"lat": 8.7832, "lng": 34.5085, "zoom": 1.3},
  "algeria": {"lat": 28.0339, "lng": -1.6596, "zoom": 1.3},
    "algiers": {"lat": 36.7538, "lng": 3.0588},
  "oran": {"lat": 35.6991, "lng": -0.6359},
  "constantine": {"lat": 36.3650, "lng": 6.6147},
  "angola": {"lat": -11.2027, "lng": -17.8739, "zoom": 1.3},
    "luanda": {"lat": -8.8399, "lng": 13.2894},
  "benguela": {"lat": -12.5783, "lng": 13.4076},
  "lubango": {"lat": -14.9246, "lng": 13.4927},
    "benin": {"lat": 9.3077, "lng": -2.3158, "zoom": 1.3},
    "cotonou": { "lat": 6.3703, "lng": 2.3912 },
    "porto-novo": { "lat": 6.4969, "lng": 2.6287 },
    "parakou": { "lat": 9.3373, "lng": 2.6304 },
    "botswana": {"lat": -22.3285, "lng": -24.6849, "zoom": 1.3},
    "gaborone": { "lat": -24.6282, "lng": 25.9231 },
    "francistown": { "lat": -21.1596, "lng": 27.5144 },
    "maun": { "lat": -19.9833, "lng": 23.4167 },
    "burkina faso": {"lat": 12.2383, "lng": -1.5616, "zoom": 1.3},
    "ouagadougou": { "lat": 12.3714, "lng": -1.5197 },
    "bobo-dioulasso": { "lat": 11.1771, "lng": -4.2979 },
    "koudougou": { "lat": 12.2542, "lng": -2.3596 },
    "burundi": {"lat": -3.3731, "lng": -29.9189, "zoom": 1.3},
    "bujumbura": { "lat": -3.3614, "lng": 29.3599 },
    "gitega": { "lat": -3.4264, "lng": 29.9306 },
    "ngozi": { "lat": -2.9083, "lng": 29.8306 },
    "cameroon": {"lat": 7.3697, "lng": -12.3547, "zoom": 1.3},
    "yaounde": { "lat": 3.8480, "lng": 11.5021 },
    "douala": { "lat": 4.0511, "lng": 9.7679 },
    "garoua": { "lat": 9.3014, "lng": 13.3977 },
    "cape verde": {"lat": 16.5388, "lng": -23.0418, "zoom": 1.3},
    "praia": { "lat": 14.9330, "lng": -23.5133 },
    "mindelo": { "lat": 16.8837, "lng": -24.9837 },
    "santa maria": { "lat": 16.6000, "lng": -22.9000 },
    "central african republic": {"lat": 6.6111, "lng": -20.9394, "zoom": 1.3},
    "bangui": { "lat": 4.3947, "lng": 18.5582 },
    "berberati": { "lat": 4.2616, "lng": 15.7928 },
    "bambari": { "lat": 5.7672, "lng": 20.6756 },
    "chad": {"lat": 15.4542, "lng": -18.7322, "zoom": 1.3},
    "ndjamena": { "lat": 12.1348, "lng": 15.0557 },
    "moundou": { "lat": 8.5674, "lng": 16.0779 },
    "abeche": { "lat": 13.8390, "lng": 20.8324 },
    "comoros": {"lat": -11.6455, "lng": -43.3333, "zoom": 1.3},
    "moroni": { "lat": -11.7172, "lng": 43.2473 },
    "mtsamboro": { "lat": -12.2641, "lng": 44.4100 },
    "djibouti": {"lat": 11.8251, "lng": -42.5903, "zoom": 1.3},
    "egypt": {"lat": 26.8206, "lng": -30.8025, "zoom": 1.3},
    "cairo": { "lat": 30.0444, "lng": 31.2357 },
  "alexandria": { "lat": 31.2001, "lng": 29.9187 },
  "giza": { "lat": 30.0131, "lng": 31.2089 },
    "eritrea": {"lat": 15.1794, "lng": -39.7823, "zoom": 1.3},
    "equatorial guinea": { "lat": 1.6508, "lng": -10.2679, "zoom": 1.2 },
  "malabo": { "lat": 3.7500, "lng": 8.7833 },
  "bata": { "lat": 1.8604, "lng": 9.7721 },
  "ebebiyin": { "lat": 2.1519, "lng": 11.3356 },
  "eritrea": { "lat": 15.1794, "lng": -39.7823, "zoom": 1.2 },
  "asmara": { "lat": 15.3229, "lng": 38.9251 },
  "eswatini": { "lat": -26.5225, "lng": -31.2659, "zoom": 1.2 },
  "mbabane": { "lat": -26.3054, "lng": 31.1367 },
  "manzini": { "lat": -26.4988, "lng": 31.3800 },
  "ethiopia": { "lat": 9.145, "lng": -40.4897, "zoom": 1.2 },
  "addis ababa": { "lat": 9.0318, "lng": 38.7501 },
  "gondar": { "lat": 12.6040, "lng": 37.4521 },
  "mekele": { "lat": 13.4960, "lng": 39.4756 },
  "gabon": { "lat": -0.8037, "lng": -11.6094, "zoom": 1.2 },
  "libreville": { "lat": 0.3901, "lng": 9.4544 },
  "port-gentil": { "lat": -1.2193, "lng": 8.7815 },
    "gambia": {"lat": 13.4432, "lng": -15.3101, "zoom": 1.3},
    "banjul": {"lat": 13.4549, "lng": -16.579, "zoom": 1.3},
      "serrekunda": {"lat": 13.4484, "lng": -16.6789, "zoom": 1.3},
    "ghana": {"lat": 7.9465, "lng": -1.0232, "zoom": 1.3},
    "accra": {"lat": 5.6037, "lng": -0.187, "zoom": 1.3},
      "kumasi": {"lat": 6.6666, "lng": -1.6167, "zoom": 1.3},
      "tamale": {"lat": 9.4008, "lng": -0.8393, "zoom": 1.3},
    "guinea": {"lat": 9.9456, "lng": -9.6966, "zoom": 1.3},
    "conakry": {"lat": 9.6412, "lng": -13.5784, "zoom": 1.3},
      "kankan": {"lat": 10.3894, "lng": -9.3053, "zoom": 1.3},
    "kenya": {"lat": -1.286389, "lng": -36.8172, "zoom": 1.3},
    "nairobi": {"lat": -1.286389, "lng": 36.8172, "zoom": 1.3},
      "mombasa": {"lat": -4.0435, "lng": 39.6682, "zoom": 1.3},
      "kisumu": {"lat": -0.0917, "lng": 34.7676, "zoom": 1.3},
    "lesotho": {"lat": -29.6105, "lng": -28.2336, "zoom": 1.3},
    "maseru": {"lat": -29.3167, "lng": 27.4833, "zoom": 1.3},
      "mafekeng": {"lat": -29.8206, "lng": 27.2405, "zoom": 1.3},
    "madagascar": {"lat": -18.7669, "lng": 46.8691, "zoom": 1.3},
    "antananarivo": {"lat": -18.8792, "lng": 47.5079, "zoom": 1.3},
      "toamasina": {"lat": -18.1494, "lng": 49.4023, "zoom": 1.3},
    "morocco": {"lat": 31.7917, "lng": 7.0926, "zoom": 1.3},
    "casablanca": {"lat": 33.5731, "lng": -7.5898, "zoom": 1.3},
      "marrakech": {"lat": 31.6295, "lng": -7.9811, "zoom": 1.3},
      "fes": {"lat": 34.0333, "lng": -5.0000, "zoom": 1.3},
    "nigeria": {"lat": 9.082, "lng": 8.6753, "zoom": 1.3},
    "lagos": {"lat": 6.5244, "lng": 3.3792, "zoom": 1.3},
      "abuja": {"lat": 9.0579, "lng": 7.4951, "zoom": 1.3},
      "kano": {"lat": 12.0022, "lng": 8.5919, "zoom": 1.3},
    "south africa": {"lat": -30.5595, "lng": 22.9375, "zoom": 1.3},
    "johannesburg": {"lat": -26.2041, "lng": 28.0473, "zoom": 1.3},
      "cape town": {"lat": -33.9249, "lng": 18.4241, "zoom": 1.3},
      "durban": {"lat": -29.8587, "lng": 31.0218, "zoom": 1.3},
  "asia": {"lat": 34.0479, "lng": 100.6197, "zoom": 1.3},
"afghanistan": {"lat": 33.9391, "lng": 67.71, "zoom": 1.3},
"kabul": {"lat": 34.5553, "lng": 69.2075, "zoom": 1.3},
      "herat": {"lat": 34.3529, "lng": 62.2041, "zoom": 1.3},
"armenia": {"lat": 40.0691, "lng": 45.0382, "zoom": 1.3},
"yerevan": {"lat": 40.1792, "lng": 44.4991, "zoom": 1.3},
"azerbaijan": {"lat": 40.1431, "lng": 47.5769, "zoom": 1.3},
"baku": {"lat": 40.4093, "lng": 49.8671, "zoom": 1.3},
"bahrain": {"lat": 26.0667, "lng": 50.5577, "zoom": 1.3},
"manama": {"lat": 26.2285, "lng": 50.5860, "zoom": 1.3},
"bangladesh": {"lat": 23.685, "lng": 90.3563, "zoom": 1.3},
"dhaka": {"lat": 23.8103, "lng": 90.4125, "zoom": 1.3},
      "chittagong": {"lat": 22.3569, "lng": 91.7832, "zoom": 1.3},
"bhutan": {"lat": 27.5142, "lng": 90.4336, "zoom": 1.3},
"thimphu": {"lat": 27.4712, "lng": 89.6419, "zoom": 1.3},
"brunei": {"lat": 4.5353, "lng": 114.7277, "zoom": 1.3},
"bandar seri begawan": {"lat": 4.8903, "lng": 114.9423, "zoom": 1.3},
"cambodia": {"lat": 12.5657, "lng": 104.991, "zoom": 1.3},
"china": {"lat": 35.8617, "lng": 104.1954, "zoom": 1.3},
"beijing": {"lat": 39.9042, "lng": 116.4074, "zoom": 1.3},
      "shanghai": {"lat": 31.2304, "lng": 121.2737, "zoom": 1.3},
      "guangzhou": {"lat": 23.1291, "lng": 113.2644, "zoom": 1.3},
"cyprus": {"lat": 35.1264, "lng": 33.4299, "zoom": 1.3},
"georgia": {"lat": 42.3154, "lng": 43.3569, "zoom": 1.3},
"india": {"lat": 20.5937, "lng": 78.9629, "zoom": 1.3},
"delhi": {"lat": 28.6139, "lng": 77.2090, "zoom": 1.3},
      "mumbai": {"lat": 19.0760, "lng": 72.8777, "zoom": 1.3},
      "bangalore": {"lat": 12.9716, "lng": 77.5946, "zoom": 1.3},
      "hyderabad": {"lat": 17.3850, "lng": 78.4867, "zoom": 1.3},
      "kolkata": {"lat": 22.5726, "lng": 88.3639, "zoom": 1.3},
"delhi": {"lat": 28.6139, "lng": 77.2090},
"mumbai": {"lat": 19.0760, "lng": 72.8777},
"bangalore": {"lat": 12.9716, "lng": 77.5946},
"hyderabad": {"lat": 17.3850, "lng": 78.4867},
"chennai": {"lat": 13.0827, "lng": 80.2707},
"kolkata": {"lat": 22.5726, "lng": 88.3639},
"ahmedabad": {"lat": 23.0225, "lng": 72.5714},
"pune": {"lat": 18.5204, "lng": 73.8567},
"jaipur": {"lat": 26.9124, "lng": 75.7873},
"lucknow": {"lat": 26.8467, "lng": 80.9462},
"indonesia": {"lat": -1.2893, "lng": 113.9213, "zoom": 1.3},
"jakarta": {"lat": -6.2088, "lng": 106.8456, "zoom": 1.3},
"iran": {"lat": 32.4279, "lng": 53.688, "zoom": 1.3},
"iraq": {"lat": 33.2232, "lng": 43.6793, "zoom": 1.3},
"israel": {"lat": 31.0461, "lng": 34.8516, "zoom": 1.3},
"japan": {"lat": 36.2048, "lng": 138.2529, "zoom": 1.3},
"tokyo": {"lat": 35.6762, "lng": 139.6503, "zoom": 1.3},
      "osaka": {"lat": 34.6937, "lng": 135.5023, "zoom": 1.3},
      "kyoto": {"lat": 35.0116, "lng": 135.7681, "zoom": 1.3},
"nagoya": {"lat": 35.1815, "lng": 136.9066},
"sapporo": {"lat": 43.0618, "lng": 141.3545},
"fukuoka": {"lat": 33.5902, "lng": 130.4017},
"kobe": {"lat": 34.6901, "lng": 135.1955},
"kyoto": {"lat": 35.0116, "lng": 135.7681},
"jordan": {"lat": 30.5852, "lng": 36.2384, "zoom": 1.3},
"kazakhstan": {"lat": 48.0196, "lng": 66.9237, "zoom": 1.3},
"kuwait": {"lat": 29.3759, "lng": 47.9774, "zoom": 1.3},
"kyrgyzstan": {"lat": 41.2044, "lng": 74.7661, "zoom": 1.3},
"laos": {"lat": 19.8563, "lng": 102.4955, "zoom": 1.3},
"lebanon": {"lat": 33.8547, "lng": 35.8623, "zoom": 1.3},
"malaysia": {"lat": 4.2105, "lng": 101.9758, "zoom": 1.3},
"kuala lumpur": {"lat": 3.1390, "lng": 101.6869, "zoom": 1.3},
"maldives": {"lat": 3.2028, "lng": 73.2207, "zoom": 1.3},
"mongolia": {"lat": 46.8625, "lng": 103.8467, "zoom": 1.3},
"myanmar": {"lat": 21.9162, "lng": 95.956, "zoom": 1.3},
"nepal": {"lat": 28.3949, "lng": 84.124, "zoom": 1.3},
"north korea": {"lat": 40.3399, "lng": 127.5101, "zoom": 1.3},
"oman": {"lat": 21.2735, "lng": 55.9754, "zoom": 1.3},
"pakistan": {"lat": 30.3753, "lng": 69.3451, "zoom": 1.3},
"karachi": {"lat": 24.8607, "lng": 67.0011, "zoom": 1.3},
      "lahore": {"lat": 31.5497, "lng": 74.3436, "zoom": 1.3},
      "islamabad": {"lat": 33.6844, "lng": 73.0479, "zoom": 1.3},
"philippines": {"lat": 12.8797, "lng": 121.774, "zoom": 1.3},
"qatar": {"lat": 25.3548, "lng": 51.1839, "zoom": 1.3},
"saudi arabia": {"lat": 23.8859, "lng": 45.0792, "zoom": 1.3},
"riyadh": {"lat": 24.7136, "lng": 46.6753, "zoom": 1.3},
      "jeddah": {"lat": 21.2858, "lng": 39.1925, "zoom": 1.3},
"singapore": {"lat": 1.3521, "lng": 103.8198, "zoom": 1.3},
"south korea": {"lat": 35.9078, "lng": 127.7669, "zoom": 1.3},
"seoul": {"lat": 37.5665, "lng": 126.9780, "zoom": 1.3},
      "busan": {"lat": 35.1796, "lng": 129.0756, "zoom": 1.3},
"sri lanka": {"lat": 7.8731, "lng": 81.2718, "zoom": 1.3},
"syria": {"lat": 34.8021, "lng": 38.9968, "zoom": 1.3},
"taiwan": {"lat": 23.6978, "lng": 120.9605, "zoom": 1.3},
"tajikistan": {"lat": 38.861, "lng": 71.2761, "zoom": 1.3},
"thailand": {"lat": 15.870, "lng": 100.9925, "zoom": 1.3},
"bangkok": {"lat": 13.7563, "lng": 100.5018, "zoom": 1.3},
      "chiang mai": {"lat": 18.7883, "lng": 98.9853, "zoom": 1.3},
"turkmenistan": {"lat": 38.9697, "lng": 59.5563, "zoom": 1.3},
"uzbekistan": {"lat": 41.3775, "lng": 64.5853, "zoom": 1.3},
"vietnam": {"lat": 14.0583, "lng": 108.2772, "zoom": 1.3},
"hanoi": {"lat": 21.0285, "lng": 105.8542, "zoom": 1.3},
      "ho chi minh city": {"lat": 11.2769, "lng": 106.7009, "zoom": 1.3},
"yemen": {"lat": 15.5527, "lng": 48.5164, "zoom": 1.3},
"america": { lat: 39.0, lng: -101.8, zoom: 1.2 },
"new york": {"lat": 41.2128, "lng": -74.0060},
"los angeles": {"lat": 34.0522, "lng": -118.2437},
"chicago": {"lat": 41.8781, "lng": -87.6298},
"houston": {"lat": 29.7604, "lng": -95.3698},
"phoenix": {"lat": 33.4484, "lng": -112.0740},
"san antonio": {"lat": 29.4241, "lng": -98.4936},
"san diego": {"lat": 32.7157, "lng": -117.1611},
"dallas": {"lat": 32.7767, "lng": -96.7970},
"san jose": {"lat": 37.3382, "lng": -121.8863},
"austin": {"lat": 30.2672, "lng": -97.7431},
"jacksonville": {"lat": 30.3322, "lng": -81.6557},
"columbus": {"lat": 39.9612, "lng": -82.9988},
"charlotte": {"lat": 35.2271, "lng": -80.8431},
"americas": {"lat": 16.0, "lng": -85.0, "zoom": 1.3},
"antigua and barbuda": {"lat": 17.0608, "lng": -61.7964, "zoom": 1.3},
"argentina": {"lat": -38.4161, "lng": -63.6167, "zoom": 1.3},
"bahamas": {"lat": 25.0343, "lng": -77.3963, "zoom": 1.3},
"barbados": {"lat": 13.1939, "lng": -59.5432, "zoom": 1.3},
"belize": {"lat": 17.1899, "lng": -88.4976, "zoom": 1.3},
"bolivia": {"lat": -16.2902, "lng": -63.5887, "zoom": 1.3},
"brazil": {"lat": -14.235, "lng": -51.9253, "zoom": 1.3},
"brazilia": {"lat": -15.7801, "lng": -47.9292},
"rio de janeiro": {"lat": -22.9068, "lng": -43.1729},
"sao paulo": {"lat": -23.5505, "lng": -46.6333},
"salvador": {"lat": -12.9714, "lng": -38.5014},
"fortaleza": {"lat": -3.7172, "lng": -38.5433},
"curitiba": {"lat": -25.4296, "lng": -49.2711},
"recife": {"lat": -8.0476, "lng": -34.8770},
"manaus": {"lat": -3.1190, "lng": -60.1705},
"porto alegre": {"lat": -30.0331, "lng": -51.2300},
"belem": {"lat": -1.2557, "lng": -48.4903},
"natal": {"lat": -5.7945, "lng": -35.2110},
"maceio": {"lat": -9.6656, "lng": -35.7350},
"goiania": {"lat": -16.6784, "lng": -49.2531},
"canada": {"lat": 56.1304, "lng": -106.3468, "zoom": 1.3},
"toronto": {"lat": 43.6532, "lng": -79.3832},
"vancouver": {"lat": 49.2827, "lng": -123.1207},
"montreal": {"lat": 45.5017, "lng": -73.5673},
"calgary": {"lat": 51.0447, "lng": -114.0719},
"ottawa": {"lat": 45.4215, "lng": -75.6972},
"edmonton": {"lat": 53.5461, "lng": -113.4938},
"winnipeg": {"lat": 49.8951, "lng": -97.1384},
"quebec city": {"lat": 46.8139, "lng": -71.2082},
"chile": {"lat": -35.6751, "lng": -71.543, "zoom": 1.3},
"colombia": {"lat": 4.5709, "lng": -74.2973, "zoom": 1.3},
"costa rica": {"lat": 9.7489, "lng": -83.7534, "zoom": 1.3},
"cuba": {"lat": 21.5218, "lng": -77.7812, "zoom": 1.3},
"dominica": {"lat": 15.414, "lng": -61.3709, "zoom": 1.3},
"dominican republic": {"lat": 18.7357, "lng": -70.1627, "zoom": 1.3},
"ecuador": {"lat": -1.8312, "lng": -78.1834, "zoom": 1.3},
"el salvador": {"lat": 13.7942, "lng": -88.8965, "zoom": 1.3},
"grenada": {"lat": 12.1165, "lng": -61.679, "zoom": 1.3},
"guatemala": {"lat": 15.7835, "lng": -90.2308, "zoom": 1.3},
"guyana": {"lat": 4.8604, "lng": -58.9302, "zoom": 1.3},
"haiti": {"lat": 18.9712, "lng": -72.2852, "zoom": 1.3},
"honduras": {"lat": 15.1999, "lng": -86.2419, "zoom": 1.3},
"jamaica": {"lat": 18.1096, "lng": -77.2975, "zoom": 1.3},
"caribbean": {"lat": 18.1096, "lng": -77.2975, "zoom": 1.3},
"mexico": {"lat": 23.6345, "lng": -102.5528, "zoom": 1.3},
"mexico city": {"lat": 19.4326, "lng": -99.1332, "zoom": 1.3},
      "guadalajara": {"lat": 20.6597, "lng": -103.3496, "zoom": 1.3},
      "monterrey": {"lat": 25.6866, "lng": -100.3161, "zoom": 1.3},
"nicaragua": {"lat": 12.8654, "lng": -85.2072, "zoom": 1.3},
"panama": {"lat": 8.538, "lng": -81.2821, "zoom": 1.3},
"paraguay": {"lat": -23.4425, "lng": -58.4438, "zoom": 1.3},
"peru": {"lat": -9.19, "lng": -75.0152, "zoom": 1.3},
"saint kitts and nevis": {"lat": 17.3578, "lng": -62.782, "zoom": 1.3},
"saint lucia": {"lat": 13.9094, "lng": -60.9789, "zoom": 1.3},
"saint vincent and the grenadines": {"lat": 13.2528, "lng": -61.1971, "zoom": 1.3},
"suriname": {"lat": 3.9193, "lng": -56.0278, "zoom": 1.3},
"trinidad and tobago": {"lat": 10.6918, "lng": -61.2225, "zoom": 1.3},
"united states": {"lat": 37.0902, "lng": -95.7129, "zoom": 1.3},
"uruguay": {"lat": -32.5228, "lng": -55.7658, "zoom": 1.3},
"venezuela": {"lat": 6.4238, "lng": -66.5897, "zoom": 1.3},
"europe": {"lat": 54.5260, "lng": 15.2551, "zoom": 1.3},
"albania": {"lat": 41.1533, "lng": 20.1683, "zoom": 1.3},
"andorra": {"lat": 42.5078, "lng": 1.5211, "zoom": 1.3},
"armenia": {"lat": 40.0691, "lng": 45.0382, "zoom": 1.3},
"austria": {"lat": 47.5162, "lng": 14.5501, "zoom": 1.3},
"azerbaijan": {"lat": 40.1431, "lng": 47.5769, "zoom": 1.3},
"belarus": {"lat": 53.9, "lng": 27.5667, "zoom": 1.3},
"belgium": {"lat": 50.5039, "lng": 4.4699, "zoom": 1.3},
"bosnia and herzegovina": {"lat": 43.9159, "lng": 17.6791, "zoom": 1.3},
"bulgaria": {"lat": 42.7339, "lng": 25.4858, "zoom": 1.3},
"croatia": {"lat": 45.1, "lng": 15.2, "zoom": 1.3},
"cyprus": {"lat": 35.1264, "lng": 33.4299, "zoom": 1.3},
"czech republic": {"lat": 49.8175, "lng": 15.473, "zoom": 1.3},
"denmark": {"lat": 56.2639, "lng": 9.5018, "zoom": 1.3},
"estonia": {"lat": 58.5953, "lng": 25.0136, "zoom": 1.3},
"finland": {"lat": 61.9241, "lng": 25.7482, "zoom": 1.3},
"france": {"lat": 46.6034, "lng": 1.8883, "zoom": 1.3},
"paris": {"lat": 48.8566, "lng": 2.3522},
"marseille": {"lat": 43.2965, "lng": 5.3698},
"lyon": {"lat": 45.7597, "lng": 4.8422},
"toulouse": {"lat": 43.6047, "lng": 1.2442},
"nice": {"lat": 43.7102, "lng": 7.2620},
"nantes": {"lat": 47.2186, "lng": -1.5546},
"montpellier": {"lat": 43.6110, "lng": 3.8767},
"strasbourg": {"lat": 48.5734, "lng": 7.7521},
"bordeaux": {"lat": 44.8378, "lng": -0.5792},
"georgia": {"lat": 42.3154, "lng": 43.3569, "zoom": 1.3},
"germany": {"lat": 51.1657, "lng": 10.4515, "zoom": 1.3},
"berlin": {"lat": 52.5200, "lng": 13.4050},
"hamburg": {"lat": 53.5511, "lng": 9.9937},
"munich": {"lat": 48.1351, "lng": 11.5820},
"frankfurt": {"lat": 50.1109, "lng": 8.6821},
"cologne": {"lat": 50.9375, "lng": 6.9603},
"dusseldorf": {"lat": 51.2277, "lng": 6.7735},
"stuttgart": {"lat": 48.7758, "lng": 9.1829},
"dortmund": {"lat": 51.5136, "lng": 7.4650},
"greece": {"lat": 39.0742, "lng": 21.8243, "zoom": 1.3},
"hungary": {"lat": 47.1625, "lng": 19.5033, "zoom": 1.3},
"iceland": {"lat": 64.9631, "lng": -19.0208, "zoom": 1.3},
"ireland": {"lat": 53.4129, "lng": -8.2439, "zoom": 1.3},
"italy": {"lat": 41.8719, "lng": 12.5674, "zoom": 1.3},
"kosovo": {"lat": 42.6026, "lng": 20.9026, "zoom": 1.3},
"latvia": {"lat": 56.8796, "lng": 24.6032, "zoom": 1.3},
"liechtenstein": {"lat": 47.1415, "lng": 9.5215, "zoom": 1.3},
"lithuania": {"lat": 55.1694, "lng": 23.8813, "zoom": 1.3},
"luxembourg": {"lat": 49.6117, "lng": 6.13, "zoom": 1.3},
"malta": {"lat": 35.9375, "lng": 14.3754, "zoom": 1.3},
"moldova": {"lat": 47.4116, "lng": 28.3699, "zoom": 1.3},
"monaco": {"lat": 43.7333, "lng": 7.4167, "zoom": 1.3},
"montenegro": {"lat": 42.7087, "lng": 19.3744, "zoom": 1.3},
"netherlands": {"lat": 52.1326, "lng": 5.2913, "zoom": 1.3},
"north macedonia": {"lat": 41.6086, "lng": 21.7453, "zoom": 1.3},
"norway": {"lat": 60.472, "lng": 8.4689, "zoom": 1.3},
"poland": {"lat": 51.9194, "lng": 19.1451, "zoom": 1.3},
"portugal": {"lat": 39.3999, "lng": -8.2245, "zoom": 1.3},
"romania": {"lat": 45.9432, "lng": 24.9668, "zoom": 1.3},
"russia": {"lat": 55.7558, "lng": 37.6176, "zoom": 1.3},
"san marino": {"lat": 43.9333, "lng": 12.45, "zoom": 1.3},
"serbia": {"lat": 44.0165, "lng": 21.0059, "zoom": 1.3},
"slovakia": {"lat": 48.669, "lng": 19.699, "zoom": 1.3},
"slovenia": {"lat": 46.1511, "lng": 14.9955, "zoom": 1.3},
"spain": {"lat": 40.4637, "lng": -3.7492, "zoom": 1.3},
"sweden": {"lat": 60.1282, "lng": 18.6435, "zoom": 1.3},
"switzerland": {"lat": 46.8182, "lng": 8.2275, "zoom": 1.3},
"turkey": {"lat": 38.9637, "lng": 35.2433, "zoom": 1.3},
"ukraine": {"lat": 48.3794, "lng": 31.1656, "zoom": 1.3},
"united kingdom": {"lat": 55.3781, "lng": -3.436, "zoom": 1.3},
"london": {"lat": 51.5074, "lng": -0.1278},
"birmingham": {"lat": 52.4862, "lng": -1.8904},
"manchester": {"lat": 53.4808, "lng": -2.2426},
"glasgow": {"lat": 55.8642, "lng": -4.2518},
"edinburgh": {"lat": 55.9533, "lng": -3.1883},
"bristol": {"lat": 51.2545, "lng": -2.5879},
"leeds": {"lat": 53.8008, "lng": -1.5491},
"liverpool": {"lat": 53.4084, "lng": -2.9916},
"sheffield": {"lat": 53.3811, "lng": -1.2701},
"vatican city": {"lat": 41.9029, "lng": 12.4534, "zoom": 1.3},
"oceania": {"lat": -25.2744, "lng": 133.7751, "zoom": 1.3},
"australia": {"lat": -25.2744, "lng": 133.7751, "zoom": 1.3},
"sydney": {"lat": -33.8688, "lng": 151.2093},
"melbourne": {"lat": -37.8136, "lng": 144.9631},
"brisbane": {"lat": -27.4698, "lng": 153.0251},
"perth": {"lat": -31.9505, "lng": 115.8605},
"adelaide": {"lat": -34.9285, "lng": 138.6007},
"hobart": {"lat": -42.8821, "lng": 147.3272},
"darwin": {"lat": -12.4634, "lng": 130.8456},
"canberra": {"lat": -35.2809, "lng": 149.1300},
"fiji": {"lat": -17.7134, "lng": 178.0650, "zoom": 1.3},
"kiribati": {"lat": -3.3704, "lng": -168.7340, "zoom": 1.3},
"marshall islands": {"lat": 7.1315, "lng": 171.1845, "zoom": 1.3},
"micronesia": {"lat": 6.9154, "lng": 158.2516, "zoom": 1.3},
"nauru": {"lat": -0.5228, "lng": 166.9315, "zoom": 1.3},
"new zealand": {"lat": -40.9006, "lng": 174.8860, "zoom": 1.3},
"palau": {"lat": 7.5149, "lng": 134.5825, "zoom": 1.3},
"papua new guinea": {"lat": -6.3149, "lng": 143.9555, "zoom": 1.3},
"samoa": {"lat": -13.7590, "lng": -172.1046, "zoom": 1.3},
"solomon islands": {"lat": -9.4485, "lng": 160.0170, "zoom": 1.3},
"tonga": {"lat": -21.1789, "lng": -175.1982, "zoom": 1.3},
"tuvalu": {"lat": -7.1095, "lng": 177.6493, "zoom": 1.3},
"vanuatu": {"lat": -15.3767, "lng": 166.9592, "zoom": 1.3},
"new york": {"lat": 41.2128, "lng": -74.0060, "zoom": 1.3},
"los angeles": {"lat": 34.0522, "lng": -118.2437, "zoom": 1.3},
"chicago": {"lat": 41.8781, "lng": -87.6298, "zoom": 1.3},
"miami": {"lat": 25.7617, "lng": -80.1918, "zoom": 1.3},
"san francisco": {"lat": 37.7749, "lng": -122.4194, "zoom": 1.3},
"washington dc": {"lat": 38.9072, "lng": -77.0369, "zoom": 1.3},
"washington": {"lat": 38.9072, "lng": -77.0369, "zoom": 1.3},
"london": {"lat": 51.5074, "lng": -0.1278, "zoom": 1.3},
"paris": {"lat": 48.8566, "lng": 2.3522, "zoom": 1.3},
"berlin": {"lat": 52.5200, "lng": 13.4050, "zoom": 1.3},
"rome": {"lat": 41.9028, "lng": 12.4964, "zoom": 1.3},
"madrid": {"lat": 40.4168, "lng": -3.7038, "zoom": 1.3},
"barcelona": {"lat": 41.3784, "lng": 2.1928, "zoom": 1.3},
"moscow": {"lat": 55.7558, "lng": 37.6173, "zoom": 1.3},
"tokyo": {"lat": 35.6762, "lng": 139.6503, "zoom": 1.3},
"beijing": {"lat": 39.9042, "lng": 116.4074, "zoom": 1.3},
"shanghai": {"lat": 31.2304, "lng": 121.2737, "zoom": 1.3},
"sydney": {"lat": -33.8688, "lng": 151.2093, "zoom": 1.3},
"melbourne": {"lat": -37.8136, "lng": 144.9631, "zoom": 1.3},
"rio de janeiro": {"lat": -22.9068, "lng": -43.1729, "zoom": 1.3},
"so paulo": {"lat": -23.5505, "lng": -46.6333, "zoom": 1.3},
"mexico city": {"lat": 19.4326, "lng": -99.1332, "zoom": 1.3},
"toronto": {"lat": 43.6532, "lng": -79.3832, "zoom": 1.3},
"vancouver": {"lat": 49.2827, "lng": -123.1207, "zoom": 1.3},
"montreal": {"lat": 45.5017, "lng": -73.5673, "zoom": 1.3},
"buenos aires": {"lat": -34.6037, "lng": -58.3816, "zoom": 1.3},
"cape town": {"lat": -33.9249, "lng": 18.4241, "zoom": 1.3},
"johannesburg": {"lat": -26.2041, "lng": 28.0473, "zoom": 1.3},
"cairo": {"lat": 30.0444, "lng": 31.2357, "zoom": 1.3},
"dubai": {"lat": 25.276987, "lng": 55.296249, "zoom": 1.3},
"istanbul": {"lat": 41.0082, "lng": 28.9784, "zoom": 1.3},
"delhi": {"lat": 28.6139, "lng": 77.2090, "zoom": 1.3},
"mumbai": {"lat": 19.0760, "lng": 72.8777, "zoom": 1.3},
"hong kong": {"lat": 22.3193, "lng": 114.1694, "zoom": 1.3},
"bangkok": {"lat": 13.7563, "lng": 100.5018, "zoom": 1.3},
"singapore": {"lat": 1.3521, "lng": 103.8198, "zoom": 1.3},
"kuala lumpur": {"lat": 3.1390, "lng": 101.6869, "zoom": 1.3},
"jakarta": {"lat": -6.2088, "lng": 106.8456, "zoom": 1.3},
"seoul": {"lat": 37.5665, "lng": 126.9780, "zoom": 1.3},
"lagos": {"lat": 6.5244, "lng": 3.3792, "zoom": 1.3},
"athens": {"lat": 37.9838, "lng": 23.7275, "zoom": 1.3},
"vienna": {"lat": 48.2082, "lng": 16.3738, "zoom": 1.3},
"stockholm": {"lat": 59.3293, "lng": 18.0686, "zoom": 1.3},
"oslo": {"lat": 59.9139, "lng": 11.2522, "zoom": 1.3},
"helsinki": {"lat": 60.1699, "lng": 24.9384, "zoom": 1.3},
"warsaw": {"lat": 52.2298, "lng": 21.0118, "zoom": 1.3},
"zurich": {"lat": 47.3769, "lng": 8.5417, "zoom": 1.3},
"brussels": {"lat": 50.8503, "lng": 4.3517, "zoom": 1.3},
"amsterdam": {"lat": 52.3676, "lng": 4.9041, "zoom": 1.3},
"dublin": {"lat": 53.3498, "lng": -6.2603, "zoom": 1.3},
"copenhagen": {"lat": 55.6761, "lng": 12.5683, "zoom": 1.3},
"prague": {"lat": 50.0755, "lng": 14.4378, "zoom": 1.3},
} /*
const Locationsfixed = {
  "africa": {"lat": 8.5, "lng": 18.2, "zoom": 1.4},
  "algeria": {"lat": 28.0339, "lng": 178.3404, "zoom": 1.4},
  "angola": {"lat": -11.2027, "lng": 162.1261, "zoom": 1.4},
  "benin": {"lat": 9.3077, "lng": 177.6842, "zoom": 1.4},
  "botswana": {"lat": -22.3285, "lng": 155.3151, "zoom": 1.4},
  "burkina faso": {"lat": 12.2383, "lng": 179.4384, "zoom": 1.4},
  "burundi": {"lat": -3.3731, "lng": 149.9189, "zoom": 1.4},
  "cameroon": {"lat": 7.3697, "lng": 167.3547, "zoom": 1.4},
  "cape verde": {"lat": 16.5388, "lng": 156.9582, "zoom": 1.4},
  "central african republic": {"lat": 6.6111, "lng": 159.0606, "zoom": 1.4},
  "chad": {"lat": 15.4542, "lng": 161.2678, "zoom": 1.4},
  "comoros": {"lat": -11.6455, "lng": 136.6667, "zoom": 1.4},
  "djibouti": {"lat": 11.8251, "lng": 137.5903, "zoom": 1.4},
  "egypt": {"lat": 26.8206, "lng": 149.8025, "zoom": 1.4},
  "equatorial guinea": {"lat": 1.6508, "lng": 169.7321, "zoom": 1.4},
  "eritrea": {"lat": 15.1794, "lng": 139.7823, "zoom": 1.4},
  "eswatini": {"lat": -26.5225, "lng": 148.5341, "zoom": 1.4},
  "ethiopia": {"lat": 9.145, "lng": 139.4897, "zoom": 1.4},
  "gabon": {"lat": -0.8037, "lng": 168.3906, "zoom": 1.4},
  "gambia": {"lat": 13.4432, "lng": 164.6899, "zoom": 1.4},
  "ghana": {"lat": 7.9465, "lng": 178.0232, "zoom": 1.4},
  "guinea": {"lat": 9.9456, "lng": 170.3034, "zoom": 1.4},
  "kenya": {"lat": -1.286389, "lng": 143.1828, "zoom": 1.4},
  "lesotho": {"lat": -29.6105, "lng": 151.7664, "zoom": 1.4},
  "madagascar": {"lat": -18.7669, "lng": 133.8691, "zoom": 1.4},
  "morocco": {"lat": 31.7917, "lng": 172.9074, "zoom": 1.4},
  "nigeria": {"lat": 9.082, "lng": 171.3247, "zoom": 1.4},
  "south africa": {"lat": -30.5595, "lng": 157.0625, "zoom": 1.4},
  "asia": {"lat": 34.0479, "lng": -79.3803, "zoom": 1.4},
  "afghanistan": {"lat": 33.9391, "lng": -112.29, "zoom": 1.4},
  "armenia": {"lat": 40.0691, "lng": -134.9618, "zoom": 1.4},
  "azerbaijan": {"lat": 40.1431, "lng": -129.5769, "zoom": 1.4},
  "bahrain": {"lat": 26.0667, "lng": -129.5577, "zoom": 1.4},
  "bangladesh": {"lat": 23.685, "lng": -89.6437, "zoom": 1.4},
  "bhutan": {"lat": 27.5142, "lng": -89.5664, "zoom": 1.4},
  "brunei": {"lat": 4.5353, "lng": -155.2723, "zoom": 1.4},
  "cambodia": {"lat": 12.5657, "lng": -75.009, "zoom": 1.4},
  "china": {"lat": 35.8617, "lng": -75.8046, "zoom": 1.4},
  "cyprus": {"lat": 35.1264, "lng": -146.5701, "zoom": 1.4},
  "georgia": {"lat": 42.3154, "lng": -136.6431, "zoom": 1.4},
  "india": {"lat": 20.5937, "lng": -101.0371, "zoom": 1.4},
  "indonesia": {"lat": -0.7893, "lng": -66.0787, "zoom": 1.4},
  "iran": {"lat": 32.4279, "lng": -126.312, "zoom": 1.4},
  "iraq": {"lat": 33.2232, "lng": -136.3207, "zoom": 1.4},
  "israel": {"lat": 31.0461, "lng": -149.1484, "zoom": 1.4},
  "japan": {"lat": 36.2048, "lng": -41.7471, "zoom": 1.4},
  "jordan": {"lat": 30.5852, "lng": -143.7616, "zoom": 1.4},
  "kazakhstan": {"lat": 48.0196, "lng": -113.0763, "zoom": 1.4},
  "kuwait": {"lat": 29.3759, "lng": -118.0226, "zoom": 1.4},
  "kyrgyzstan": {"lat": 41.2044, "lng": -105.2339, "zoom": 1.4},
  "laos": {"lat": 19.8563, "lng": -77.4955, "zoom": 1.4},
  "lebanon": {"lat": 33.8547, "lng": -148.1377, "zoom": 1.4},
  "malaysia": {"lat": 4.2105, "lng": -58.0242, "zoom": 1.4},
  "maldives": {"lat": 3.2028, "lng": -106.7793, "zoom": 1.4},
  "mongolia": {"lat": 46.8625, "lng": -157.8467, "zoom": 1.4},
  "myanmar": {"lat": 21.9162, "lng": -84.044, "zoom": 1.4},
  "nepal": {"lat": 28.3949, "lng": -95.124, "zoom": 1.4},
  "north korea": {"lat": 40.3399, "lng": -52.4899, "zoom": 1.4},
  "oman": {"lat": 21.4735, "lng": -124.0246, "zoom": 1.4},
  "pakistan": {"lat": 30.3753, "lng": -110.6549, "zoom": 1.4},
  "philippines": {"lat": 12.8797, "lng": -58.226, "zoom": 1.4},
  "qatar": {"lat": 25.3548, "lng": -129.1839, "zoom": 1.4},
  "saudi arabia": {"lat": 23.8859, "lng": -134.9208, "zoom": 1.4},
  "singapore": {"lat": 1.3521, "lng": -76.1802, "zoom": 1.4},
  "south korea": {"lat": 35.9078, "lng": -148.2331, "zoom": 1.4},
  "sri lanka": {"lat": 7.8731, "lng": -99.2282, "zoom": 1.4},
  "syria": {"lat": 34.8021, "lng": -141.9968, "zoom": 1.4},
  "taiwan": {"lat": 23.6978, "lng": -59.0395, "zoom": 1.4},
  "tajikistan": {"lat": 38.861, "lng": -109.2761, "zoom": 1.4},
  "thailand": {"lat": 15.870, "lng": -79.0075, "zoom": 1.4},
  "turkmenistan": {"lat": 38.9697, "lng": -120.5563, "zoom": 1.4},
  "uzbekistan": {"lat": 41.3775, "lng": -118.5853, "zoom": 1.4},
  "vietnam": {"lat": 14.0583, "lng": -71.7228, "zoom": 1.4},
  "yemen": {"lat": 15.5527, "lng": -131.5164, "zoom": 1.4},
  "america": { "lat": 39.0, "lng": -101.8, "zoom": 1.4 },
  "americas": {"lat": 16.0, "lng": 95.0, "zoom": 1.4},
  "antigua and barbuda": {"lat": 17.0608, "lng": 118.2036, "zoom": 1.4},
  "argentina": {"lat": -38.4161, "lng": 116.3833, "zoom": 1.4},
  "bahamas": {"lat": 25.0343, "lng": 102.6037, "zoom": 1.4},
  "barbados": {"lat": 13.1939, "lng": 120.4568, "zoom": 1.4},
  "belize": {"lat": 17.1899, "lng": 91.5024, "zoom": 1.4},
  "bolivia": {"lat": -16.2902, "lng": 116.4113, "zoom": 1.4},
  "brazil": {"lat": -14.235, "lng": 128.0747, "zoom": 1.4},
  "canada": {"lat": 56.1304, "lng": 73.6532, "zoom": 1.4},
  "chile": {"lat": -35.6751, "lng": 108.457, "zoom": 1.4},
  "colombia": {"lat": 4.5709, "lng": 104.7027, "zoom": 1.4},
  "costa rica": {"lat": 9.7489, "lng": 96.2466, "zoom": 1.4},
  "cuba": {"lat": 21.5218, "lng": 98.2188, "zoom": 1.4},
  "dominica": {"lat": 15.414, "lng": 118.6291, "zoom": 1.4},
  "dominican republic": {"lat": 18.7357, "lng": 109.8373, "zoom": 1.4},
  "ecuador": {"lat": -1.8312, "lng": 101.8166, "zoom": 1.4},
  "el salvador": {"lat": 13.7942, "lng": 91.1035, "zoom": 1.4},
  "grenada": {"lat": 12.1165, "lng": 118.3209, "zoom": 1.4},
  "guatemala": {"lat": 15.7835, "lng": 94.7692, "zoom": 1.4},
  "guyana": {"lat": 4.8604, "lng": 121.0698, "zoom": 1.4},
  "haiti": {"lat": 18.9712, "lng": 107.7148, "zoom": 1.4},
  "honduras": {"lat": 15.1999, "lng": 93.7581, "zoom": 1.4},
  "jamaica": {"lat": 18.1096, "lng": 102.7025, "zoom": 1.4},
  "mexico": {"lat": 23.6345, "lng": 77.4472, "zoom": 1.4},
  "nicaragua": {"lat": 12.8654, "lng": 94.7928, "zoom": 1.4},
  "panama": {"lat": 8.538, "lng": 99.2179, "zoom": 1.4},
  "paraguay": {"lat": -23.4425, "lng": 121.5562, "zoom": 1.4},
  "peru": {"lat": -9.19, "lng": 104.0348, "zoom": 1.4},
  "saint kitts and nevis": {"lat": 17.3578, "lng": 117.218, "zoom": 1.4},
  "saint lucia": {"lat": 13.9094, "lng": 119.0211, "zoom": 1.4},
  "saint vincent and the grenadines": {"lat": 13.2528, "lng": 118.8029, "zoom": 1.4},
  "suriname": {"lat": 3.9193, "lng": 123.9722, "zoom": 1.4},
  "trinidad and tobago": {"lat": 10.6918, "lng": 118.7775, "zoom": 1.4},
  "united states": {"lat": 37.0902, "lng": 84.2871, "zoom": 1.4},
  "uruguay": {"lat": -32.5228, "lng": 124.2342, "zoom": 1.4},
  "venezuela": {"lat": 6.4238, "lng": 113.4103, "zoom": 1.4},
  "europe": {"lat": 54.5260, "lng": -164.7449, "zoom": 1.4},
  "albania": {"lat": 41.1533, "lng": -159.8317, "zoom": 1.4},
  "andorra": {"lat": 42.5078, "lng": -179.4789, "zoom": 1.4},
  "armenia": {"lat": 40.0691, "lng": -134.9618, "zoom": 1.4},
  "austria": {"lat": 47.5162, "lng": -165.4499, "zoom": 1.4},
  "azerbaijan": {"lat": 40.1431, "lng": -129.5769, "zoom": 1.4},
  "belarus": {"lat": 53.9, "lng": -152.4333, "zoom": 1.4},
  "belgium": {"lat": 50.5039, "lng": -175.5301, "zoom": 1.4},
  "bosnia and herzegovina": {"lat": 43.9159, "lng": -162.3209, "zoom": 1.4},
  "bulgaria": {"lat": 42.7339, "lng": -154.5142, "zoom": 1.4},
  "croatia": {"lat": 45.1, "lng": -164.8, "zoom": 1.4},
  "cyprus": {"lat": 35.1264, "lng": -146.5701, "zoom": 1.4},
  "czech republic": {"lat": 49.8175, "lng": -164.527, "zoom": 1.4},
  "denmark": {"lat": 56.2639, "lng": -170.4982, "zoom": 1.4},
  "estonia": {"lat": 58.5953, "lng": -154.9864, "zoom": 1.4},
  "finland": {"lat": 61.9241, "lng": -154.2518, "zoom": 1.4},
  "france": {"lat": 46.6034, "lng": -178.1117, "zoom": 1.4},
  "georgia": {"lat": 42.3154, "lng": -136.6431, "zoom": 1.4},
  "germany": {"lat": 51.1657, "lng": -169.5485, "zoom": 1.4},
  "greece": {"lat": 39.0742, "lng": -158.1757, "zoom": 1.4},
  "hungary": {"lat": 47.1625, "lng": -160.4967, "zoom": 1.4},
  "iceland": {"lat": 64.9631, "lng": -199.0208, "zoom": 1.4},
  "ireland": {"lat": 53.4129, "lng": -178.2439, "zoom": 1.4},
  "italy": {"lat": 41.8719, "lng": -167.4326, "zoom": 1.4},
  "kosovo": {"lat": 42.6026, "lng": -159.0974, "zoom": 1.4},
  "latvia": {"lat": 56.8796, "lng": -135.3968, "zoom": 1.4},
  "liechtenstein": {"lat": 47.1415, "lng": -170.4785, "zoom": 1.4},
  "lithuania": {"lat": 55.1694, "lng": -136.1187, "zoom": 1.4},
  "luxembourg": {"lat": 49.6117, "lng": -170.8699, "zoom": 1.4},
  "malta": {"lat": 35.9375, "lng": -165.6246, "zoom": 1.4},
  "moldova": {"lat": 47.4116, "lng": -151.6301, "zoom": 1.4},
  "monaco": {"lat": 43.7333, "lng": -172.4167, "zoom": 1.4},
  "montenegro": {"lat": 42.7087, "lng": -160.6256, "zoom": 1.4},
  "netherlands": {"lat": 52.1326, "lng": -174.7087, "zoom": 1.4},
  "north macedonia": {"lat": 41.6086, "lng": -158.2547, "zoom": 1.4},
  "norway": {"lat": 60.472, "lng": -171.5311, "zoom": 1.4},
  "poland": {"lat": 51.9194, "lng": -140.8549, "zoom": 1.4},
  "portugal": {"lat": 39.3999, "lng": -169.2245, "zoom": 1.4},
  "romania": {"lat": 45.9432, "lng": -135.0332, "zoom": 1.4},
  "russia": {"lat": 55.7558, "lng": -142.3824, "zoom": 1.4},
  "san marino": {"lat": 43.9333, "lng": -167.5498, "zoom": 1.4},
  "serbia": {"lat": 44.0165, "lng": -158.9941, "zoom": 1.4},
  "slovakia": {"lat": 48.669, "lng": -160.301, "zoom": 1.4},
  "slovenia": {"lat": 46.1511, "lng": -165.0045, "zoom": 1.4},
  "spain": {"lat": 40.4637, "lng": -183.7492, "zoom": 1.4},
  "sweden": {"lat": 60.1282, "lng": -161.3565, "zoom": 1.4},
  "switzerland": {"lat": 46.8182, "lng": -171.7725, "zoom": 1.4},
  "turkey": {"lat": 38.9637, "lng": -145.2433, "zoom": 1.4},
  "ukraine": {"lat": 48.3794, "lng": -148.8344, "zoom": 1.4},
  "united kingdom": {"lat": 55.3781, "lng": -156.436, "zoom": 1.4},
  "vatican city": {"lat": 41.9029, "lng": -167.5466, "zoom": 1.4},
  "oceania": {"lat": -25.2744, "lng": -46.2249, "zoom": 1.4},
  "australia": {"lat": -25.2744, "lng": -46.2249, "zoom": 1.4},
  "fiji": {"lat": -17.7134, "lng": -1.9349, "zoom": 1.4},
  "kiribati": {"lat": -3.3704, "lng": 11.734, "zoom": 1.4},
  "marshall islands": {"lat": 7.1315, "lng": -8.8155, "zoom": 1.4},
  "micronesia": {"lat": 6.9154, "lng": -21.7484, "zoom": 1.4},
  "nauru": {"lat": -0.5228, "lng": -13.0685, "zoom": 1.4},
  "new zealand": {"lat": -40.9006, "lng": -185.1139, "zoom": 1.4},
  "palau": {"lat": 7.5149, "lng": -45.4175, "zoom": 1.4},
  "papua new guinea": {"lat": -6.3149, "lng": -36.0445, "zoom": 1.4},
  "samoa": {"lat": -13.7590, "lng": -35.1046, "zoom": 1.4},
  "solomon islands": {"lat": -9.4485, "lng": -19.9829, "zoom": 1.4},
  "tonga": {"lat": -21.1789, "lng": 4.8018, "zoom": 1.4},
  "tuvalu": {"lat": -7.1095, "lng": -2.3507, "zoom": 1.4},
  "vanuatu": {"lat": -15.3767, "lng": -13.0408, "zoom": 1.4},
  "new york": {"lat": 40.7128, "lng": 106.0060, "zoom": 1.4},
  "los angeles": {"lat": 34.0522, "lng": 61.7563, "zoom": 1.4},
  "chicago": {"lat": 41.8781, "lng": 92.3702, "zoom": 1.4},
  "miami": {"lat": 25.7617, "lng": 99.0082, "zoom": 1.4},
  "san francisco": {"lat": 37.7749, "lng": 57.4194, "zoom": 1.4},
  "washington dc": {"lat": 38.9072, "lng": 103.9631, "zoom": 1.4},
  "london": {"lat": 51.5074, "lng": 179.8722, "zoom": 1.4},
  "paris": {"lat": 48.8566, "lng": 177.3522, "zoom": 1.4},
  "berlin": {"lat": 52.5200, "lng": -166.5949, "zoom": 1.4},
  "rome": {"lat": 41.9028, "lng": -167.5036, "zoom": 1.4},
  "madrid": {"lat": 40.4168, "lng": 179.2962, "zoom": 1.4},
  "barcelona": {"lat": 41.3784, "lng": -177.8072, "zoom": 1.4},
  "moscow": {"lat": 55.7558, "lng": -142.6173, "zoom": 1.4},
  "tokyo": {"lat": 35.6762, "lng": -41.6503, "zoom": 1.4},
  "beijing": {"lat": 39.9042, "lng": -63.5926, "zoom": 1.4},
  "shanghai": {"lat": 31.2304, "lng": -58.5263, "zoom": 1.4},
  "sydney": {"lat": -33.8688, "lng": -28.7907, "zoom": 1.4},
  "melbourne": {"lat": -37.8136, "lng": -15.0369, "zoom": 1.4},
  "rio de janeiro": {"lat": -22.9068, "lng": 136.8271, "zoom": 1.4},
  "so paulo": {"lat": -23.5505, "lng": 133.6333, "zoom": 1.4}
}*/





/*const locations = {
    // Global regions
    "africa": { lat: 10, lng: 20, zoom: 1.4 },
    "europe": { lat: 50, lng: 10, zoom: 1.4 },
    "america": { lat: 40, lng: -100, zoom: 1.4 },
    "south america": { lat: -10, lng: -55, zoom: 1.4 },
    "caribbean": { lat: 20, lng: -75, zoom: 1.4 },
    "asia": { lat: 30, lng: 100, zoom: 1.4 },
    "world": { lat: 0, lng: 0, zoom: 1.4 },

    // US Cities
    "hawaii": { lat: 21.3069, lng: -157.8583, zoom: 1.4 },
    "new york": { lat: 40.7128, lng: -74.0060, zoom: 1.4 },
    "los angeles": { lat: 34.0522, lng: -118.2437, zoom: 1.4 },
    "chicago": { lat: 41.8781, lng: -87.6298, zoom: 1.4 },
    "miami": { lat: 25.7617, lng: -80.1918, zoom: 1.4 },
    "san francisco": { lat: 37.7749, lng: -122.4194, zoom: 1.4 },
    "washington dc": { lat: 38.9072, lng: -77.0369, zoom: 1.4 },

    // Canadian Cities
    "toronto": { lat: 43.651070, lng: -79.347015, zoom: 1.4 },
    "vancouver": { lat: 49.2827, lng: -123.1207, zoom: 1.4 },
    "montreal": { lat: 45.5017, lng: -73.5673, zoom: 1.4 },

    // Latin America
    "rio de janeiro": { lat: -22.9068, lng: -43.1729, zoom: 1.4 },
    "so paulo": { lat: -23.5505, lng: -46.6333, zoom: 1.4 },
    "mexico city": { lat: 19.4326, lng: -99.1332, zoom: 1.4 },
    "buenos aires": { lat: -34.6037, lng: -58.3816, zoom: 1.4 },
    "lima": { lat: -12.0464, lng: -77.0428, zoom: 1.4 },
    "santiago": { lat: -33.4489, lng: -70.6693, zoom: 1.4 },
    "bogota": { lat: 4.7110, lng: -74.0721, zoom: 1.4 },
    "caracas": { lat: 10.4806, lng: -66.9036, zoom: 1.4 },

    // European Cities
    "london": { lat: 51.5074, lng: -0.1278, zoom: 1.4 },
    "paris": { lat: 48.8566, lng: 2.3522, zoom: 1.4 },
    "berlin": { lat: 52.5200, lng: 13.4050, zoom: 1.4 },
    "rome": { lat: 41.9028, lng: 12.4964, zoom: 1.4 },
    "madrid": { lat: 40.4168, lng: -3.7038, zoom: 1.4 },
    "barcelona": { lat: 41.3851, lng: 2.1734, zoom: 1.4 },
    "lisbon": { lat: 38.7223, lng: -9.1393, zoom: 1.4 },
    "amsterdam": { lat: 52.3676, lng: 4.9041, zoom: 1.4 },
    "athens": { lat: 37.9838, lng: 23.7275, zoom: 1.4 },
    "vienna": { lat: 48.2082, lng: 16.3738, zoom: 1.4 },
    "stockholm": { lat: 59.3293, lng: 18.0686, zoom: 1.4 },
    "copenhagen": { lat: 55.6761, lng: 12.5683, zoom: 1.4 },
    "dublin": { lat: 53.3498, lng: -6.2603, zoom: 1.4 },
    "warsaw": { lat: 52.2297, lng: 21.0122, zoom: 1.4 },
    "zurich": { lat: 47.3769, lng: 8.5417, zoom: 1.4 },

    // Asian Cities
    "tokyo": { lat: 35.6895, lng: 139.6917, zoom: 1.4 },
    "beijing": { lat: 39.9042, lng: 116.4074, zoom: 1.4 },
    "shanghai": { lat: 31.2304, lng: 121.4737, zoom: 1.4 },
    "bangkok": { lat: 13.7563, lng: 100.5018, zoom: 1.4 },
    "singapore": { lat: 1.3521, lng: 103.8198, zoom: 1.4 },
    "hong kong": { lat: 22.3193, lng: 114.1694, zoom: 1.4 },
    "seoul": { lat: 37.5665, lng: 126.9780, zoom: 1.4 },
    "kuala lumpur": { lat: 3.1390, lng: 101.6869, zoom: 1.4 },
    "jakarta": { lat: -6.2088, lng: 106.8456, zoom: 1.4 },

    // Middle East
    "dubai": { lat: 25.2048, lng: 55.2708, zoom: 1.4 },
    "doha": { lat: 25.276987, lng: 51.521067, zoom: 1.4 },
    "istanbul": { lat: 41.0082, lng: 28.9784, zoom: 1.4 },

    // Africa
    "cape town": { lat: -33.9249, lng: 18.4241, zoom: 1.4 },
    "nairobi": { lat: -1.2864, lng: 36.8172, zoom: 1.4 },
    "casablanca": { lat: 33.5731, lng: -7.5898, zoom: 1.4 },

    // Oceania
    "sydney": { lat: -33.8688, lng: 151.2093, zoom: 1.4 },
    "melbourne": { lat: -37.8136, lng: 144.9631, zoom: 1.4 },
    "auckland": { lat: -36.8485, lng: 174.7633, zoom: 1.4 },

    // Islands
    "jamaica": { lat: 18.1096, lng: -77.2975, zoom: 1.4 },
    "bahamas": { lat: 25.0343, lng: -77.3963, zoom: 1.4 },
    "maldives": { lat: 3.2028, lng: 73.2207, zoom: 1.4 },
    "seychelles": { lat: -4.6796, lng: 55.4920, zoom: 1.4 },

    //countries
    "jamaica": { lat: 18.1096, lng: -77.2975, zoom: 3 },
    "united states": { lat: 37.0902, lng: -95.7129, zoom: 1.4 },
    "canada": { lat: 56.1304, lng: -106.3468, zoom: 1.4 },
    "mexico": { lat: 23.6345, lng: -102.5528, zoom: 1.4 },
    "brazil": { lat: -14.2350, lng: -51.9253, zoom: 1.4 },
    "argentina": { lat: -38.4161, lng: -63.6167, zoom: 1.4 },
    "united kingdom": { lat: 55.3781, lng: -3.4360, zoom: 1.4 },
    "france": { lat: 46.6034, lng: 2.2137, zoom: 1.4 },
    "germany": { lat: 51.1657, lng: 10.4515, zoom: 1.4 },
    "italy": { lat: 41.8719, lng: 12.5674, zoom: 1.4 },
    "spain": { lat: 40.4637, lng: -3.7492, zoom: 1.4 },
    "portugal": { lat: 39.3999, lng: -8.2245, zoom: 1.4 },
    "russia": { lat: 61.5240, lng: 105.3188, zoom: 1.4 },
    "china": { lat: 35.8617, lng: 104.1954, zoom: 1.4 },
    "japan": { lat: 36.2048, lng: 138.2529, zoom: 1.4 },
    "india": { lat: 20.5937, lng: 78.9629, zoom: 1.4 },
    "australia": { lat: -25.2744, lng: 133.7751, zoom: 1.4 },
    "south africa": { lat: -30.5595, lng: 22.9375, zoom: 1.4 },
    "egypt": { lat: 26.8206, lng: 30.8025, zoom: 1.4 },
    "nigeria": { lat: 9.0820, lng: 8.6753, zoom: 1.4 },
    "kenya": { lat: -1.2921, lng: 36.8219, zoom: 1.4 },
    "south korea": { lat: 35.9078, lng: 127.7669, zoom: 1.4 },
    "indonesia": { lat: -0.7893, lng: 113.9213, zoom: 1.4 },
    "saudi arabia": { lat: 23.8859, lng: 45.0792, zoom: 1.4 },
    "iran": { lat: 32.4279, lng: 53.6880, zoom: 1.4 },
    "turkey": { lat: 38.9637, lng: 35.2433, zoom: 1.4 },
    "israel": { lat: 31.0461, lng: 34.8516, zoom: 1.4 },
    "greece": { lat: 39.0742, lng: 21.8243, zoom: 1.4 },
    "thailand": { lat: 15.8700, lng: 100.9925, zoom: 1.4 },
    "vietnam": { lat: 14.0583, lng: 108.2772, zoom: 1.4 },
    "new zealand": { lat: -40.9006, lng: 174.8860, zoom: 1.4 },
    "pakistan": { lat: 30.3753, lng: 69.3451, zoom: 1.4 },
    "afghanistan": { lat: 33.9391, lng: 67.7100, zoom: 1.4 },
    "colombia": { lat: 4.5709, lng: -74.2973, zoom: 1.4 },
    "venezuela": { lat: 6.4238, lng: -66.5897, zoom: 1.4 }
};*/









// Function to normalize input and accept lower/upper case spelling
// Function to normalize input and accept lower/upper case spelling and extra spaces
function normalizeLocation(input) {
    if (typeof input !== "string") {
        console.error("Invalid input:", input);
        return "";
    }
    return input.toLowerCase().trim();
}

function findClosestLocation(input) {
   const normalizedInput = normalizeLocation(input);
   let closestMatch = null;
   let closestDistance = Infinity;

   // Use Locationsfixed instead of locations
   for (const location in Locationsfixed) {
       const distance = levenshteinDistance(normalizedInput, location);
       if (distance < closestDistance) {
           closestDistance = distance;
           closestMatch = location;
       }
   }

   // Return match if within an acceptable distance
   return closestDistance <= 2 ? closestMatch : null;
}


// Levenshtein Distance for fuzzy matching
function levenshteinDistance(a, b) {
    const matrix = Array.from({ length: a.length + 1 }, () => Array(b.length + 1).fill(0));

    for (let i = 0; i <= a.length; i++) matrix[i][0] = i;
    for (let j = 0; j <= b.length; j++) matrix[0][j] = j;

    for (let i = 1; i <= a.length; i++) {
        for (let j = 1; j <= b.length; j++) {
            const cost = a[i - 1] === b[j - 1] ? 0 : 1;
            matrix[i][j] = Math.min(
                matrix[i - 1][j] + 1, // Deletion
                matrix[i][j - 1] + 1, // Insertion
                matrix[i - 1][j - 1] + cost // Substitution
            );
        }
    }

    return matrix[a.length][b.length];
}
/*function panToLocation(location) {
    const normalizedLocation = normalizeLocation(location);
    const coords = Locationsfixed[normalizedLocation];
    
    if (coords) {
        // Convert latitude and longitude to Three.js coordinates
        const lat = coords.lat;
        const lng = coords.lng;
        const zoom = coords.zoom || 3.0; // Default zoom level if not provided

        // Calculate the target position in 3D space
        const phi = (90 - lat) * (Math.PI / 180);
        const theta = (lng + 180) * (Math.PI / 180);
	    
        const radius = 5.1;  // Updated globe radius
        const targetX = radius * Math.sin(phi) * Math.cos(theta); // Adjust globe radius accordingly
        const targetY = radius * Math.cos(phi);
        const targetZ = radius * Math.sin(phi) * Math.sin(theta);

        // Use TWEEN for smooth animation
        new TWEEN.Tween(camera.position)
            .to({ x: targetX, y: targetY, z: targetZ }, 2000) // Smooth pan over 2 seconds
            .easing(TWEEN.Easing.Quadratic.InOut) // Apply easing for smoother effect
            .onUpdate(() => {
                camera.lookAt(0, 0, 0); // Keep the camera focused on the globe's center
            })
            .start();

        // Use another TWEEN for zooming effect
        new TWEEN.Tween(camera)
            .to({ zoom: zoom }, 2000) // Smooth zoom over 2 seconds
            .easing(TWEEN.Easing.Quadratic.InOut) // Apply easing for smoother effect
            .onUpdate(() => {
                camera.updateProjectionMatrix(); // Make sure to update the projection matrix after zoom changes
            })
            .start();

        // Make sure to call this to keep TWEEN animations running
        function animate() {
            requestAnimationFrame(animate);
            TWEEN.update(); // Update TWEEN animations
        }

        animate(); // Start the animation loop
    } else {
        console.log("Location not found in lookup table.");
    }
}
function convertLonLatToXYZ(radius, lon, lat) {
  // Convert latitude and longitude to spherical coordinates
  const phi = (90 - lat) * (Math.PI / 180); // Latitude to radians
  const theta = (lon + 180) * (Math.PI / 180); // Longitude to radians

  const x = -(radius * Math.sin(phi) * Math.cos(theta));
  const z = radius * Math.sin(phi) * Math.sin(theta);
  const y = radius * Math.cos(phi);

  return { x, y, z };
}*/

function panToLocation(location) {
    const normalizedLocation = normalizeLocation(location);
    const coords = Locationsfixed[normalizedLocation];
    
    if (coords) {
        // Use the same method for converting latitude and longitude to 3D XYZ coordinates
        const lat = coords.lat;
        const lng = coords.lng;
        const zoom = coords.zoom || 3.0; // Default zoom level if not provided

        const radius = 5.1;  // Updated globe radius
        const { x, y, z } = convertLonLatToXYZ(radius, lng, lat);

        // Use TWEEN for smooth animation
        new TWEEN.Tween(camera.position)
            .to({ x, y, z }, 2000) // Smooth pan over 2 seconds
            .easing(TWEEN.Easing.Quadratic.InOut) // Apply easing for smoother effect
            .onUpdate(() => {
                camera.lookAt(0, 0, 0); // Keep the camera focused on the globe's center
            })
            .start();

        // Use another TWEEN for zooming effect
        new TWEEN.Tween(camera)
            .to({ zoom: zoom }, 2000) // Smooth zoom over 2 seconds
            .easing(TWEEN.Easing.Quadratic.InOut) // Apply easing for smoother effect
            .onUpdate(() => {
                camera.updateProjectionMatrix(); // Make sure to update the projection matrix after zoom changes
            })
            .start();

        // Make sure to call this to keep TWEEN animations running
        function animate() {
            requestAnimationFrame(animate);
            TWEEN.update(); // Update TWEEN animations
        }

        animate(); // Start the animation loop
    } else {
        console.log("Location not found in lookup table.");
    }
}

// Step 1: Function to create a 3D vector from latitude and longitude
// Convert Lat/Lng to 3D Vector

//import { GLTFLoader } from 'https://unpkg.com/three@0.136.0/examples/jsm/loaders/GLTFLoader.js';
import { GLTFLoader } from 'https://cdn.jsdelivr.net/npm/three@0.136.0/examples/jsm/loaders/GLTFLoader.js';

// Adjust distance handling in `createFlightPath` and Plane Animation
/*function createFlightPath(fromVec, toVec, altitude) {
    const distance = fromVec.distanceTo(toVec); // Calculate the distance between the two points

    // Set a threshold for short distances
    const shortDistanceThreshold = 2.0; // Define a threshold for what constitutes a "short" distance

    // Dynamically adjust the altitude based on distance
    let adjustedAltitude;
    if (distance < shortDistanceThreshold) {
        // For short distances, make the curve less pronounced
        adjustedAltitude = Math.max(0.25, distance * 0.1); // Scale to 10% of the distance, minimum 1.5
    } else {
        // For longer distances, keep the curve more pronounced
        adjustedAltitude = Math.max(2.5, distance * 0.2); // Scale to 30% of the distance, minimum 5.0
    }

    const midpointAltitude = earthRadius + adjustedAltitude; // Ensure midpoint altitude is higher than the globe radius

    // Calculate the midpoint and adjust its altitude
    const midPoint = fromVec.clone().lerp(toVec, 0.5); // Calculate the midpoint
    midPoint.setLength(midpointAltitude); // Adjust midpoint altitude

    // Create the curve for the flight path
    const curve = new THREE.QuadraticBezierCurve3(fromVec, midPoint, toVec);

    // Create the tube geometry for the path
    const pathGeometry = new THREE.TubeGeometry(curve, 64, 0.02, 8, false);
    const pathMaterial = new THREE.MeshBasicMaterial({ color: 0x46dff0 });
    const flightPath = new THREE.Mesh(pathGeometry, pathMaterial);

    scene.add(flightPath);

    // Return curve and distance for animations
    return { flightPath, curve, distance };
}*/
// Create the flight path curve
// Adjust distance handling in `createFlightPath` and Plane Animation
function createFlightPath(fromVec, toVec, altitude) {
    const distance = fromVec.distanceTo(toVec); // Calculate the distance between the two points

    // Dynamically adjust the altitude based on distance
    const adjustedAltitude = distance * 0.5; // Scale altitude to 20% of the distance
    const midpointAltitude = earthRadius + adjustedAltitude;

    const midPoint = fromVec.clone().lerp(toVec, 0.5); // Calculate the midpoint
    midPoint.setLength(midpointAltitude); // Adjust midpoint altitude

    const curve = new THREE.QuadraticBezierCurve3(fromVec, midPoint, toVec);

    // Create the tube geometry for the path
    const pathGeometry = new THREE.TubeGeometry(curve, 64, 0.02, 8, false);
    let pathMaterial = new THREE.MeshBasicMaterial({ color: 0x46dff0 });
    const flightPath = new THREE.Mesh(pathGeometry, pathMaterial);

    scene.add(flightPath);
    return { flightPath, curve, distance }; // Return distance for scaling the plane
}



// Step 6: Animate the plane along the curve
function animatePlane(plane, pathCurve, duration = 3500, distance) {
    let progress = { t: 0 };

    // Dynamically scale plane size based on distance
    const minScale = 0.05; // Minimum scale for short distances
    const maxScale = 0.1;  // Maximum scale for long distances
    const planeScale = THREE.MathUtils.lerp(minScale, maxScale, Math.min(distance / 10, 1));
    plane.scale.set(planeScale, planeScale, planeScale);

    function animateFlight() {
        new TWEEN.Tween(progress)
            .to({ t: 1 }, duration) // Duration of the flight (in milliseconds)
            .onUpdate(() => {
                const point = pathCurve.getPointAt(progress.t);
                plane.position.set(point.x, point.y, point.z);

                const tangent = pathCurve.getTangentAt(progress.t).normalize();
                const normal = plane.position.clone().normalize(); // Globe is centered at (0,0,0)
                const up = normal.clone();

                plane.lookAt(plane.position.clone().add(tangent));
                plane.up.copy(up); // Align the plane's "up" vector with the globe's surface
                plane.updateMatrixWorld();
            })
            .onComplete(() => {
                progress.t = 0; // Reset to loop the animation
                animateFlight(); // Restart the flight animation
            })
            .repeat(Infinity) // Keep the animation running
            .start();
    }

    animateFlight(); // Start the initial animation
}
//let activePlane = null; // Keep track of the active plane
//let activeCurve = null; // Keep track of the current flight path curve

// Ensure other buttons like "Region Select" or "Search" don't stop the animation
document.getElementById('regionSelectBtn').addEventListener('click', () => {
    controls.autoRotate = true; // Re-enable auto-rotate for the globe
    // Ensure plane animation continues (do not reset or interfere with TWEEN)
    console.log('Region Select clicked. Plane animation continues.');
});
// Ensure other buttons like "Region Select" or "Search" don't stop the animation
document.getElementById('submitRegion').addEventListener('click', () => {
    controls.autoRotate = true; // Re-enable auto-rotate for the globe
    // Ensure plane animation continues (do not reset or interfere with TWEEN)
    console.log('Region Select clicked. Plane animation continues.');
});
// When search button is clicked
document.querySelector('#searchBtn:not(:is(.airbnb-button22, .airbnb-button23))').addEventListener('click', async function () {

    // Get selected "from" and "to" locations from the user
    const fromInput = document.getElementById('from').value;
    const toInput = document.getElementById('where').value;

    const fromLocation = findClosestLocation(fromInput);
    const toLocation = findClosestLocation(toInput);

    if (!Locationsfixed[fromLocation] || !Locationsfixed[toLocation]) {
        console.error('Invalid locations selected.');
        alert('Could not find one or both locations. Please try again.');
        return;
    }
    controls.autoRotate = true;

    // Validate locations
    /*if (!locations[fromLocation] || !locations[toLocation]) {
        console.error('Invalid locations selected.');
        return;
    }*/

    // Get lat/lng for the "from" and "to" locations
    const fromLatLng = Locationsfixed[fromLocation];
    const toLatLng = Locationsfixed[toLocation];

    // Convert lat/lng to 3D vectors (globe radius is passed)
    const fromVector = latLngToVector3(fromLatLng.lat, fromLatLng.lng, earthRadius);
    const toVector = latLngToVector3(toLatLng.lat, toLatLng.lng, earthRadius);

    // Create a flight path and animate the plane
    const { flightPath, curve, distance } = createFlightPath(fromVector, toVector, earthRadius * 1.1);

    // Load and animate the plane
    const loader = new GLTFLoader();
    loader.load('js/cartoon_low_poly_private_jet/scene.gltf', function (gltf) {
        const plane = gltf.scene;
        scene.add(plane);
        //plane.scale.set(0.1, 0.1, 0.1);

        // Update plane materials
        plane.traverse((child) => {
            if (child.isMesh) {
                const materialName = child.material.name;

                // Update specific materials
                if (materialName === 'body') child.material.color.set(0xffffff);
                if (materialName === 'orange') child.material.color.set(0xffffff);
                if (materialName === 'glass') child.material.color.set(0x000000);
                if (materialName === 'Jet__0') child.material.color.set(0xaaaaaa);
            }
        });

        // Animate plane along the flight path
        animatePlane(plane, curve, 5000, distance);
    });

    // Pan to the "to" location
    const tolocation = document.getElementById('where').value;
    const fromlocation = document.getElementById('from').value;
    panToLocation(toInput);
    // Optional: Add a delay and pan to the "to" location
    //setTimeout(() => panToLocation(tolocation), 2500);
    console.log(panToLocation(toInput))
// Add light pillars and wave effects at "from" and "to" locations
addMarkupPoints(fromLatLng, toLatLng);
    console.log('markupPointGroup added to globe2:', addMarkupPoints);
    // Fetch and update markers based on the selected category
    const selectedCategory = document.getElementById('priceCategorySelect').value;
    fetchMarkers(location, selectedCategory);

    // Resize and update all markers
    // Resize and update all markers with animation
// Function to adjust marker sizes dynamically based on zoom level
Object.keys(genericMarkers).forEach(region => {
    const markers = genericMarkers[region];
    if (markers) {
        const originalMarkerSize = 0.5; // Assume original size
        const targetMarkerSize = 0.5; // Target size (smaller)
        const animationDuration = 500; // Animation duration in milliseconds

        // Store the new marker meshes in an array for optional later cleanup
        const newMarkerMeshes = [];

        for (let i = 0; i < markers.count; i++) {
            const instanceMatrix = new THREE.Matrix4();
            markers.getMatrixAt(i, instanceMatrix);

            // Create marker mesh with initial size
            const markerMesh = new THREE.Mesh(
                new THREE.PlaneGeometry(originalMarkerSize, originalMarkerSize),
                markerMaterial
            );
            markerMesh.applyMatrix4(instanceMatrix);
            scene.add(markerMesh); // Add marker to scene
            newMarkerMeshes.push(markerMesh); // Store the marker mesh

            // Animation variables
            let currentSize = originalMarkerSize;

            // Function to animate the resizing of markers
            const animateResize = (duration) => {
                const startTime = performance.now(); // Capture the start time

                const resizeStep = (currentTime) => {
                    const elapsedTime = currentTime - startTime; // Calculate elapsed time
                    const progress = Math.min(elapsedTime / duration, 1); // Normalize progress between 0 and 1

                    // Interpolate size based on progress
                    currentSize = THREE.MathUtils.lerp(originalMarkerSize, targetMarkerSize, progress);
                    markerMesh.geometry.dispose(); // Dispose of old geometry
                    markerMesh.geometry = new THREE.PlaneGeometry(currentSize, currentSize); // Update geometry

                    if (progress < 1) {
                        requestAnimationFrame(resizeStep); // Continue animation if not yet complete
                    } else {
                        // Ensure the final size is set
                        markerMesh.geometry.dispose();
                        markerMesh.geometry = new THREE.PlaneGeometry(targetMarkerSize, targetMarkerSize);
                    }
                };

                requestAnimationFrame(resizeStep); // Start the animation loop
            };

            // Delay the animation by 5 seconds (5000 ms)
            setTimeout(() => {
                animateResize(animationDuration); // Animate resizing after delay
            }, 3000); // 5-second delay
        }

        // Remove the original markers after the new markers have been added
        setTimeout(() => {
            scene.remove(markers);
            console.log(`Original markers for region ${region} removed.`);
        }, 3000); // Remove after delay, matching the animation start time
    } else {
        console.warn(`No markers found for the region: ${region}`);
    }
});

// Function to update marker sizes dynamically as zoomLevel changes
Object.keys(genericMarkers).forEach(region => {
    const markers = genericMarkers[region];
    if (markers) {
        const originalMarkerSize = 0.5; // Assume original size was 0.5
        const targetMarkerSize = 0.5; // Target size (smaller)

        for (let i = 0; i < markers.count; i++) {
            const instanceMatrix = new THREE.Matrix4();
            markers.getMatrixAt(i, instanceMatrix);

            // Create marker mesh with initial size
            const markerMesh = new THREE.Mesh(new THREE.PlaneGeometry(originalMarkerSize, originalMarkerSize), markerMaterial);
            markerMesh.applyMatrix4(instanceMatrix);
            scene.add(markerMesh); // Add marker to scene

            // Animation variables
            let currentSize = originalMarkerSize;

            // Function to animate the resizing of markers
            const animateResize = () => {
                currentSize = THREE.MathUtils.lerp(currentSize, targetMarkerSize, 0.1); // Smoothly interpolate size
                markerMesh.geometry.dispose(); // Dispose of old geometry
                markerMesh.geometry = new THREE.PlaneGeometry(currentSize, currentSize); // Update geometry

                if (Math.abs(currentSize - targetMarkerSize) > 0.01) {
                    requestAnimationFrame(animateResize); // Continue animation until target size is reached
                } else {
                    // Ensure final size is set
                    markerMesh.geometry.dispose();
                    markerMesh.geometry = new THREE.PlaneGeometry(targetMarkerSize, targetMarkerSize);
                }
            };

            animateResize(); // Start the animation
        }

        // Remove old markers from the scene once resizing begins
        scene.remove(markers);
        genericMarkers[region] = markers; // Update the genericMarkers object with resized markers
    } else {
        console.warn(`No markers found for the region: ${region}`);
    }
}); });
document.querySelector('#searchBtn.airbnb-button22').addEventListener('click', async function () {
  const carouselContainer1 = document.getElementById('carousel-container');
  const carouselContainer2 = document.getElementById('carousel-container2');

  carouselContainer1.style.display = 'none';
  carouselContainer2.style.display = 'none';
    // Get selected "from" and "to" locations from the user
    const fromInput = document.getElementById('from').value;
    const toInput = document.getElementById('where').value;

    const fromLocation = findClosestLocation(fromInput);
    const toLocation = findClosestLocation(toInput);

    if (!Locationsfixed[fromLocation] || !Locationsfixed[toLocation]) {
      console.error('Invalid locations selected.');
        alert('Could not find one or both locations. Please try again.');
        return;
    }
    controls.autoRotate = true;

    // Validate locations
    /*if (!locations[fromLocation] || !locations[toLocation]) {
        console.error('Invalid locations selected.');
        return;
    }*/

    // Get lat/lng for the "from" and "to" locations
    const fromLatLng = Locationsfixed[fromLocation];
    const toLatLng = Locationsfixed[toLocation];

    // Convert lat/lng to 3D vectors (globe radius is passed)
    const fromVector = latLngToVector3(fromLatLng.lat, fromLatLng.lng, earthRadius);
    const toVector = latLngToVector3(toLatLng.lat, toLatLng.lng, earthRadius);

    // Create a flight path and animate the plane
    const { flightPath, curve, distance } = createFlightPath(fromVector, toVector, earthRadius * 1.1);

    // Load and animate the plane
    const loader = new GLTFLoader();
    loader.load('js/cartoon_low_poly_private_jet/scene.gltf', function (gltf) {
        const plane = gltf.scene;
        scene.add(plane);
        //plane.scale.set(0.1, 0.1, 0.1);

        // Update plane materials
        plane.traverse((child) => {
            if (child.isMesh) {
                const materialName = child.material.name;

                // Update specific materials
                if (materialName === 'body') child.material.color.set(0xffffff);
                if (materialName === 'orange') child.material.color.set(0xffffff);
                if (materialName === 'glass') child.material.color.set(0x000000);
                if (materialName === 'Jet__0') child.material.color.set(0xaaaaaa);
            }
        });

        // Animate plane along the flight path
        animatePlane(plane, curve, 5000, distance);
    });

    // Pan to the "to" location
    const tolocation = document.getElementById('where').value;
    const fromlocation = document.getElementById('from').value;
    panToLocation(toInput);
    // Optional: Add a delay and pan to the "to" location
    //setTimeout(() => panToLocation(tolocation), 2500);
    console.log(panToLocation(toInput))
// Add light pillars and wave effects at "from" and "to" locations
addMarkupPoints(fromLatLng, toLatLng);
    console.log('markupPointGroup added to globe2:', addMarkupPoints);
    // Fetch and update markers based on the selected category
    const selectedCategory = document.getElementById('priceCategorySelect').value;
    fetchMarkers(location, selectedCategory);

    // Resize and update all markers
    // Resize and update all markers with animation
// Function to adjust marker sizes dynamically based on zoom level
Object.keys(genericMarkers).forEach(region => {
    const markers = genericMarkers[region];
    if (markers) {
        const originalMarkerSize = 0.5; // Assume original size
        const targetMarkerSize = 0.5; // Target size (smaller)
        const animationDuration = 500; // Animation duration in milliseconds

        // Store the new marker meshes in an array for optional later cleanup
        const newMarkerMeshes = [];

        for (let i = 0; i < markers.count; i++) {
            const instanceMatrix = new THREE.Matrix4();
            markers.getMatrixAt(i, instanceMatrix);

            // Create marker mesh with initial size
            const markerMesh = new THREE.Mesh(
                new THREE.PlaneGeometry(originalMarkerSize, originalMarkerSize),
                markerMaterial
            );
            markerMesh.applyMatrix4(instanceMatrix);
            scene.add(markerMesh); // Add marker to scene
            newMarkerMeshes.push(markerMesh); // Store the marker mesh

            // Animation variables
            let currentSize = originalMarkerSize;

            // Function to animate the resizing of markers
            const animateResize = (duration) => {
                const startTime = performance.now(); // Capture the start time

                const resizeStep = (currentTime) => {
                    const elapsedTime = currentTime - startTime; // Calculate elapsed time
                    const progress = Math.min(elapsedTime / duration, 1); // Normalize progress between 0 and 1

                    // Interpolate size based on progress
                    currentSize = THREE.MathUtils.lerp(originalMarkerSize, targetMarkerSize, progress);
                    markerMesh.geometry.dispose(); // Dispose of old geometry
                    markerMesh.geometry = new THREE.PlaneGeometry(currentSize, currentSize); // Update geometry

                    if (progress < 1) {
                        requestAnimationFrame(resizeStep); // Continue animation if not yet complete
                    } else {
                        // Ensure the final size is set
                        markerMesh.geometry.dispose();
                        markerMesh.geometry = new THREE.PlaneGeometry(targetMarkerSize, targetMarkerSize);
                    }
                };

                requestAnimationFrame(resizeStep); // Start the animation loop
            };

            // Delay the animation by 5 seconds (5000 ms)
            setTimeout(() => {
                animateResize(animationDuration); // Animate resizing after delay
            }, 3000); // 5-second delay
        }

        // Remove the original markers after the new markers have been added
        setTimeout(() => {
            scene.remove(markers);
            console.log(`Original markers for region ${region} removed.`);
        }, 3000); // Remove after delay, matching the animation start time
    } else {
        console.warn(`No markers found for the region: ${region}`);
    }
});

// Function to update marker sizes dynamically as zoomLevel changes
Object.keys(genericMarkers).forEach(region => {
    const markers = genericMarkers[region];
    if (markers) {
        const originalMarkerSize = 0.5; // Assume original size was 0.5
        const targetMarkerSize = 0.5; // Target size (smaller)

        for (let i = 0; i < markers.count; i++) {
            const instanceMatrix = new THREE.Matrix4();
            markers.getMatrixAt(i, instanceMatrix);

            // Create marker mesh with initial size
            const markerMesh = new THREE.Mesh(new THREE.PlaneGeometry(originalMarkerSize, originalMarkerSize), markerMaterial);
            markerMesh.applyMatrix4(instanceMatrix);
            scene.add(markerMesh); // Add marker to scene

            // Animation variables
            let currentSize = originalMarkerSize;

            // Function to animate the resizing of markers
            const animateResize = () => {
                currentSize = THREE.MathUtils.lerp(currentSize, targetMarkerSize, 0.1); // Smoothly interpolate size
                markerMesh.geometry.dispose(); // Dispose of old geometry
                markerMesh.geometry = new THREE.PlaneGeometry(currentSize, currentSize); // Update geometry

                if (Math.abs(currentSize - targetMarkerSize) > 0.01) {
                    requestAnimationFrame(animateResize); // Continue animation until target size is reached
                } else {
                    // Ensure final size is set
                    markerMesh.geometry.dispose();
                    markerMesh.geometry = new THREE.PlaneGeometry(targetMarkerSize, targetMarkerSize);
                }
            };

            animateResize(); // Start the animation
        }

        // Remove old markers from the scene once resizing begins
        scene.remove(markers);
        genericMarkers[region] = markers; // Update the genericMarkers object with resized markers
    } else {
        console.warn(`No markers found for the region: ${region}`);
    }
}); });
// Example: Listening to zoom level changes and updating marker sizes
// Updated function name to avoid conflict
function convertLonLatToXYZ(radius, lon, lat) {
  const phi = (90 - lat) * (Math.PI / 180);
  const theta = (lon + 180) * (Math.PI / 180);

  const x = -(radius * Math.sin(phi) * Math.cos(theta));
  const z = radius * Math.sin(phi) * Math.sin(theta);
  const y = radius * Math.cos(phi);

  return { x, y, z };
}
function createWaveMesh(options) {
  const geometry = new THREE.PlaneBufferGeometry(1, 1); // Default plane geometry in XOY plane
  const texture = textures.aperture;

  const material = new THREE.MeshBasicMaterial({
    color: 0x82eaed,
    map: texture,
    transparent: true, // Use transparent PNG textures
    opacity: 1.0,
    depthWrite: false // Disable depth write for transparency layering
  });

  const mesh = new THREE.Mesh(geometry, material);
// Helper function to convert longitude and latitude to XYZ coordinates
function lon2xyz(radius, lon, lat) {
  const phi = (90 - lat) * (Math.PI / 180);
  const theta = (lon + 180) * (Math.PI / 180);

  return {
    x: -(radius * Math.sin(phi) * Math.cos(theta)),
    z: radius * Math.sin(phi) * Math.sin(theta),
    y: radius * Math.cos(phi)
  };
}
  // Convert longitude and latitude to spherical coordinates
  const coord = lon2xyz(options.radius * 1.001, options.lon, options.lat);
  const size = options.radius * 0.12; // Size of the rectangular plane mesh
  mesh.scale.set(size, size, size); // Set mesh size
  mesh.userData['size'] = size; // Custom property: static size
  mesh.userData['scale'] = Math.random() * 1.0; // Custom property: dynamic scaling factor

  // Set mesh position
  mesh.position.set(coord.x, coord.y, coord.z);

  // Align mesh normal to the globe surface
  const coordVec3 = new THREE.Vector3(coord.x, coord.y, coord.z).normalize();
  const meshNormal = new THREE.Vector3(0, 0, 1); // Default mesh normal is along Z-axis
  mesh.quaternion.setFromUnitVectors(meshNormal, coordVec3);

  return mesh;
}

  // Globe radius and texture
  const radius = 5.1; // Earth radius
    const textures = {
      aperture: new THREE.TextureLoader().load('js/aperture.png')
    };

  function createLightPillar(options) {
    const height = options.radius * 0.3;
    const geometry = new THREE.PlaneBufferGeometry(options.radius * 0.05, height);
    geometry.rotateX(Math.PI / 2);
    geometry.translate(0, 0, height / 2);
// Check light column texture
console.log('Light column texture:', textures.light_column);
    const material = new THREE.MeshBasicMaterial({
      map: options.textures.light_column || new THREE.Texture(),
      color:
        options.index === 0
          ? options.punctuation.lightColumn.startColor
          : options.punctuation.lightColumn.endColor,
      transparent: true,
      side: THREE.DoubleSide,
      depthWrite: false, //
    });

    const mesh = new THREE.Mesh(geometry, material);
    const group = new THREE.Group();

    // 
    group.add(mesh, mesh.clone().rotateZ(Math.PI / 2)); //xmeshz

    // 
    //const SphereCoord = convertLonLatToXYZ(options.radius, options.lon, options.lat); //SphereCoord
    //const SphereCoord = convertLonLatToXYZ(options.radius * 1.01, options.lon, options.lat); // Offset radius slightly
    const SphereCoord = convertLonLatToXYZ(options.radius * 1.01, options.lon, options.lat); // Slight offset
group.position.set(SphereCoord.x, SphereCoord.y, SphereCoord.z);
    const coordVec3 = new THREE.Vector3(SphereCoord.x, SphereCoord.y, SphereCoord.z).normalize();
    const meshNormal = new THREE.Vector3(0, 0, 1);
    group.quaternion.setFromUnitVectors(meshNormal, coordVec3);
    //const axesHelper = new THREE.AxesHelper(5.1 * 0.2);
//group.add(axesHelper);

    return group;
  }

  function createPointMesh(options) {
    const geometry = new THREE.PlaneBufferGeometry(1, 1); //XOY
    const mesh = new THREE.Mesh(geometry, options.material);

    // 
    const coord = convertLonLatToXYZ(options.radius * 1.001, options.lon, options.lat);
    const size = options.radius * 0.05; // Mesh
    mesh.scale.set(size, size, size); // mesh

    // mesh
    mesh.position.set(coord.x, coord.y, coord.z);
    const coordVec3 = new THREE.Vector3(coord.x, coord.y, coord.z).normalize();
    const meshNormal = new THREE.Vector3(0, 0, 1);
    mesh.quaternion.setFromUnitVectors(meshNormal, coordVec3);

    return mesh;
  }
  const waveMeshArr = []; // Array to keep track of wave meshes
  // Helper function to convert longitude and latitude to sphere coordinates
// Function to create light pillars and wave effects
async function addMarkupPoints(fromLatLng, toLatLng) {
   
  const pointsData = [
        { startArray: fromLatLng, endArray: [] },
        { startArray: toLatLng, endArray: [] }
    ];
    console.log('Points Data:', pointsData);

    const options = {
  data: pointsData,
  earth: { radius: earthRadius }, // Replace with your globe radius
  textures: {
    label: textureLoader.load('js/aperture.png'),
    wave: textureLoader.load('js/label.png'),
    light_column: textureLoader.load(
        'js/light_column.png',
        () => {
            console.log('Light column texture loaded');
        },
        undefined, // No onProgress callback
        (err) => {
            console.error('Error loading light column texture:', err);
        }
    )
  },
  punctuation: { circleColor: 0x46dff0, // A vibrant blue for circles
  lightColumn: {
    startColor:  0xffffff, // Yellow
    endColor: 0xffffff,   // Orange
  }, }, // Example color
  //data: pointsData
};
const { data, textures, punctuation } = options; // Destructure options for readability

  const markupPointGroup = new THREE.Group(); // Group to hold all markup points
  //const waveMeshArr = []; // Array to keep track of wave meshes

  // Helper function to convert lat/lon to 3D Vector
  function latLngToVector3(lat, lon, radius) {
    const phi = (90 - lat) * (Math.PI / 180); // Latitude to radians
    const theta = (lon + 180) * (Math.PI / 180); // Longitude to radians

    const x = -(radius * Math.sin(phi) * Math.cos(theta));
    const z = (radius * Math.sin(phi) * Math.sin(theta));
    const y = radius * Math.cos(phi);

    return new THREE.Vector3(x, y, z);
  }

  // Helper function to create a point mesh
  function createPointMesh({ radius, lon, lat, material }) {
    const geometry = new THREE.PlaneGeometry(5, 5); // Adjust size as needed
    const mesh = new THREE.Mesh(geometry, material);

    const position = latLngToVector3(lat, lon, radius);
    mesh.position.copy(position);
    mesh.lookAt(new THREE.Vector3(0, 0, 0)); // Ensure it faces outward from the globe
    return mesh;
  }

  await Promise.all(data.map(async (item) => {
    const { lat, lng } = item.startArray || {};
    if (!lng || !lat) {
        console.error('Longitude or Latitude missing:', item.startArray);
        return; // Skip if coordinates are missing
    }

    console.log('Start Array:', item.startArray);
    console.log('Longitude:', lng, 'Latitude:', lat);
// Define material for punctuation
console.log('Label texture:', textures.label);
    // Define material for punctuation
    const punctuationMaterial = new THREE.MeshBasicMaterial({
        color: punctuation.circleColor,
        map: textures.label, // Load texture from options
        transparent: true,
        depthWrite: false,
        side: THREE.BackSide,
    });


    // Create base mesh for the start point
    const baseMesh = createPointMesh({ radius: 5.1, lon: lng, lat, material: punctuationMaterial });
    // Set the size by adjusting the scale
const size = 0.07; // Adjust this value for the desired size
baseMesh.scale.set(size, size, size);
    markupPointGroup.add(baseMesh);

    // Create light pillar for the start point
    const lightPillar = createLightPillar({
        radius: 5.1,
        lon: lng,
        lat,
        index: 0,
        textures,
        punctuation,
    });
    markupPointGroup.add(lightPillar);
    console.log('Creating light pillar with options:', { radius: 5.1, lon: lng, lat, index: 0, textures, punctuation });

    console.log('Light pillar created:', lightPillar);
    // Create wave mesh for the start point
    const waveMesh = createWaveMesh({ radius: 5.1, lon: lng, lat, textures });
    markupPointGroup.add(waveMesh);
    waveMeshArr.push(waveMesh);

    // Process all end points for the current start point
    await Promise.all(item.endArray.map((endObj) => {
        const endLon = endObj.lng; // Longitude
        const endLat = endObj.lat; // Latitude

        // Create base mesh for the end point
        const endMesh = createPointMesh({ radius: 5.1, lon: endLon, lat: endLat, material: punctuationMaterial });
        markupPointGroup.add(endMesh);

        // Create light pillar for the end point
        const endLightPillar = createLightPillar({
            radius: 5.1,
            lon: endLon,
            lat: endLat,
            index: 1,
            textures,
            punctuation,
        });
        markupPointGroup.add(endLightPillar);

        // Create wave mesh for the end point
        const endWaveMesh = createWaveMesh({ radius: 5.1, lon: endLon, lat: endLat, textures });
        markupPointGroup.add(endWaveMesh);
        waveMeshArr.push(endWaveMesh);
    }));
}));

  // Add all markup points to the main Earth group
  globe2.add(markupPointGroup);
}
  
async function fetchMarkers(location, category) {
      try {
        const location = document.getElementById('where').value;
        const normalizedLocation = normalizeLocation(location); // Normalize input
    // Get today's date
    const today = new Date();
    const tomorrow = new Date();
    tomorrow.setDate(today.getDate() + 1);

    // Get the first day of the current month
    const monthlyStartDate = new Date(today.getFullYear(), today.getMonth(), 1);
    const monthlyEndDate = new Date(today.getFullYear(), today.getMonth() + 3, 0); // 3 months ahead

    // Format the dates to YYYY-MM-DD
    const monthlyStart = monthlyStartDate.toISOString().split('T')[0];
    const monthlyEnd = monthlyEndDate.toISOString().split('T')[0];

    const checkin = document.getElementById('checkin').value;
    const checkout = document.getElementById('checkout').value;
    const guests = document.getElementById('adults').value;
  

    // Now define the searchUrl properly
    let searchUrl = `https://www.airbnb.com/s/${location}/homes?tab_id=home_tab&refinement_paths%5B%5D=%2Fhomes&adults=2&flexible_trip_lengths%5B%5D=one_week&monthly_start_date=${monthlyStart}&monthly_length=3&monthly_end_date=${monthlyEnd}&price_filter_input_type=0&channel=EXPLORE&date_picker_type=calendar&checkin=${checkin}&checkout=${checkout}&adults=${guests}&source=structured_search_input_header&search_type=unknown&price_filter_num_nights=1&drawer_open=true`;

    // Fetch markers from your backend
    const response = await fetch(`https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/scrape-airbnb?searchUrl=${encodeURIComponent(searchUrl)}`, {
      headers: {
        'ngrok-skip-browser-warning': 'true',
    },
    });
    // Extract posts and markers from the response
    const { markers } = await response.json(); 
    console.log("Fetched markers:", markers);  // Log the response to check its format

    if (!Array.isArray(markers)) {
      throw new Error('Expected markers to be an array');
    }
    // Clear existing markers and add new ones
    clearExistingMarkers();
    //addMarkersToGlobe(markers);  // Call the function to add markers
  } catch (error) {
    console.error("Failed to fetch markers:", error);
  }
}
let activeMarkersData2 = markers; // Default to markersData
let activeLabel2 = null; // Keep track of open iframe
// Function to add markers to the globe
function addMarkersToGlobe(markers) {
  markers.forEach(marker => {
    // Extract latitude and longitude
    let { lat, lng } = marker;

    // Apply offsets for shifting down and left
    const latOffset = -10; // Adjust this value for downward movement
    const lngOffset = -21; // Adjust this value for leftward movement
    lat += latOffset;
    lng += lngOffset;

    // Optional: Add random offset for slight spread of markers
    const randomOffsetFactor = 7; // Adjust for more/less spread
    lat += (Math.random() - 0.5) * randomOffsetFactor;
    lng += (Math.random() - 0.5) * randomOffsetFactor;

    // Log the adjusted values for debugging
    console.log(`Adjusted Marker Position: lat=${lat}, lng=${lng}`);

    // Convert lat/lng to 3D vector
    const markerVector = latLngToVector3(lat, lng, earthRadius);

    // Create the marker mesh
    const markerMesh = createMarkerMesh();

    // Set the marker position based on the 3D vector
    markerMesh.position.set(markerVector.x, markerVector.y, markerVector.z);

    // Ensure the marker faces outward from the globe
    markerMesh.lookAt(new THREE.Vector3(0, 0, 0));

    // Add the marker to the scene
    scene.add(markerMesh);
    setupMarkerInteraction2();
  });
}
// Set up marker click event
function setupMarkerInteraction2() {
  window.addEventListener('pointerdown', (event) => {
    pointer.x = (event.clientX / innerWidth) * 2 - 1;
    pointer.y = -(event.clientY / innerHeight) * 2 + 1;
    raycaster.setFromCamera(pointer, camera);

    const intersects = raycaster.intersectObject(markers).filter((m) => {
      return m.uv.subScalar(0.5).length() * 2 < 0.25;
    });

    if (intersects.length > 0) {
      const instanceId = intersects[0].instanceId;
      const data = fetchMarkers.markers[instanceId];

      // Check if this label is already active and close it
      if (activeLabel2 && activeLabel2 === document.getElementById(`label-${data.id}`)) {
        closeIframe2(event); // Close if clicking on the same active label
        return;
      }

      // Otherwise, proceed to open the clicked marker
      openMarkerLabel2(data);
    }
  });
}
function openMarkerLabel2(data) {
  const labelDiv = document.getElementById(`label-${data.id}`);
  const contentDiv = labelDiv.querySelector('.content');
// Wait until the element is created in the DOM
  if (!contentDiv.querySelector('div')) {
    // Inject the inner HTML content
    contentDiv.innerHTML = fetchAirbnbPosts.posts2

    const iframe = labelDiv.querySelector('div');
    const spinner = contentDiv.querySelector('.loading-spinner');

    iframe.addEventListener('load', () => {
      spinner.style.display = 'none';
      iframe.style.pointerEvents = 'all';
    });
  }

  labelDiv.classList.add('active');
  controls.autoRotate = false;
  controls.enabled = false;
  renderer.domElement.style.pointerEvents = 'none';

  // Close any previously active label
  if (activeLabel2 && activeLabel2 !== labelDiv) {
    activeLabel2.classList.remove('active');
  }

  activeLabel2 = labelDiv;

  // Add global listener for closing
  document.addEventListener('pointerdown', closeIframe2);
}

	// Function to close the active iframe if clicked outside
  function closeIframe2(event) {
  if (activeLabel2 && !activeLabel2.contains(event.target)) {
    activeLabel2.classList.remove('active');
    controls.autoRotate = true;
    controls.enabled = true;
    renderer.domElement.style.pointerEvents = 'all'; // Re-enable interaction with the globe

    // Reset the active label, but keep it available for re-clicking
    activeLabel2 = null;
  }
}

// Function to create marker mesh for the globe
function createMarkerMesh(lat, lng) {
  const markerGeometry = new THREE.PlaneGeometry(0.2, 0.2);
  const markerMaterial =  new THREE.MeshBasicMaterial({
    color: 0x00ff00,
    side: THREE.DoubleSide,
    onBeforeCompile: (shader) => {
      shader.uniforms.time = globalUniforms.time;
      shader.vertexShader = `
      	attribute float phase;
        varying float vPhase;
        ${shader.vertexShader}
      `.replace(
        `#include <begin_vertex>`,
        `#include <begin_vertex>
        	vPhase = phase; // de-synch of ripples
        `
      );
      shader.fragmentShader = `
      	uniform float time;
        varying float vPhase;
      	${shader.fragmentShader}
      `.replace(
        `vec4 diffuseColor = vec4( diffuse, opacity );`,
        `
        vec2 lUv = (vUv - 0.5) * 2.;
        float val = 0.;
        float lenUv = length(lUv);
        val = max(val, 1. - step(0.25, lenUv)); // central circle
        val = max(val, step(0.4, lenUv) - step(0.5, lenUv)); // outer circle

        float tShift = fract(time * 0.5 + vPhase);
        val = max(val, step(0.4 + (tShift * 0.6), lenUv) - step(0.5 + (tShift * 0.5), lenUv)); // ripple

        if (val < 0.5) discard;

        vec4 diffuseColor = vec4( diffuse, opacity );`
      );
    },
  });
  markerMaterial.defines = { USE_UV: '' };

  const markerMesh = new THREE.Mesh(markerGeometry, markerMaterial);

  // Convert lat/lng to 3D coordinates on the globe
  const phi = (90 - lat) * (Math.PI / 180);
  const theta = (lng + 180) * (Math.PI / 180);

  const x = -(earthRadius * Math.sin(phi) * Math.cos(theta));
  const y = earthRadius * Math.cos(phi);
  const z = earthRadius * Math.sin(phi) * Math.sin(theta);

  markerMesh.position.set(x, y, z);
  // Ensure the marker faces outward from the globe by making it look at the globe's center
  markerMesh.lookAt(new THREE.Vector3(0, 0, 0));

  return markerMesh;
}

	  // Clear the existing markers and add new ones based on the category
    clearExistingMarkers();
    markersData.forEach(markers => {
       scene.remove(markers);
    });

    document.getElementById('toggleAirbnbPrices').addEventListener('click', function (event) {
  event.stopPropagation(); // Prevent click propagation to document
  const priceCategorySelect = document.getElementById('priceCategorySelect');
  const airbnbSelector = document.getElementById('airbnbSelector');

  // Toggle visibility of the dropdowns
  const isPriceVisible = priceCategorySelect.style.display === 'block';
  priceCategorySelect.style.display = isPriceVisible ? 'none' : 'block';

  const isAirbnbVisible = airbnbSelector.style.display === 'block';
  airbnbSelector.style.display = isAirbnbVisible ? 'none' : 'block';
});

// Function to hide dropdowns when clicking outside
document.addEventListener('click', function (event) {
  const priceCategorySelect = document.getElementById('priceCategorySelect');
  const airbnbSelector = document.getElementById('airbnbSelector');

  if (priceCategorySelect && !priceCategorySelect.contains(event.target)) {
    priceCategorySelect.style.display = 'none';
  }
  if (airbnbSelector && !airbnbSelector.contains(event.target)) {
    airbnbSelector.style.display = 'none';
  }
});
	  document.addEventListener("DOMContentLoaded", function() {

  // Add event listener to the submit button
  document.getElementById('submitRegion').addEventListener('click', function() {
    // Close the initial region popup
    document.getElementById('regionPopup').style.display = 'none';

    // Show the confirmation message
    //document.getElementById('confirmationMessage').style.display = 'block';

    // Hide the confirmation message after 10 seconds
    //setTimeout(function() {
      //document.getElementById('confirmationMessage').style.display = 'none';
    //}, 20000);

    // Capture the selected region from the dropdown
    const selectedRegion = document.getElementById('regionSelect').value;

    // Pan to the selected region
    panToRegion(selectedRegion);
    // Ensure the active plane animation continues
  
    //controls.minDistance = 10;
    // Resize and update all markers with animation
// Resize and update all markers with animation
Object.keys(genericMarkers).forEach(region => {
    const markers = genericMarkers[region];
    if (markers) {
        const originalMarkerSize = 0.5; // Assume original size was 0.5
        const targetMarkerSize = 0.5; // Target size (smaller)

        for (let i = 0; i < markers.count; i++) {
            const instanceMatrix = new THREE.Matrix4();
            markers.getMatrixAt(i, instanceMatrix);

            // Create marker mesh with initial size
            const markerMesh = new THREE.Mesh(new THREE.PlaneGeometry(originalMarkerSize, originalMarkerSize), markerMaterial);
            markerMesh.applyMatrix4(instanceMatrix);
            scene.add(markerMesh); // Add marker to scene

            // Animation variables
            let currentSize = originalMarkerSize;

            // Function to animate the resizing of markers
            const animateResize = () => {
                currentSize = THREE.MathUtils.lerp(currentSize, targetMarkerSize, 0.1); // Smoothly interpolate size
                markerMesh.geometry.dispose(); // Dispose of old geometry
                markerMesh.geometry = new THREE.PlaneGeometry(currentSize, currentSize); // Update geometry

                if (Math.abs(currentSize - targetMarkerSize) > 0.01) {
                    requestAnimationFrame(animateResize); // Continue animation until target size is reached
                } else {
                    // Ensure final size is set
                    markerMesh.geometry.dispose();
                    markerMesh.geometry = new THREE.PlaneGeometry(targetMarkerSize, targetMarkerSize);
                }
            };

            animateResize(); // Start the animation
        }

        // Remove old markers from the scene once resizing begins
        scene.remove(markers);
        genericMarkers[region] = markers; // Update the genericMarkers object with resized markers
    } else {
        console.warn(`No markers found for the region: ${region}`);
    }
});
  })})

// Always visible region select button
document.getElementById('regionSelectBtn').style.display = 'block';
document.getElementById('regionSelectBtn').addEventListener('click', function () {
  if (!document.getElementById('regionSelectDropdown')) {
    let regionSelect = document.createElement('select');
    regionSelect.id = 'regionSelectDropdown';
    regionSelect.innerHTML = `
      <option value="africa">Africa</option>
      <option value="europe">Europe</option>
      <option value="america">America</option>
      <option value="south america">South America</option>
      <option value="carribbean">Carribbean</option>
      <option value="asia">Asia</option>
      <option value="world">World</option>
    `;
    this.insertAdjacentElement('afterend', regionSelect);
    regionSelect.style.display = 'block';
    regionSelect.addEventListener('change', async function () {
      const carouselContainer1 = document.getElementById('carousel-container');
      const carouselContainer2 = document.getElementById('carousel-container2');

      carouselContainer1.style.display = 'none';
      carouselContainer2.style.display = 'none';
      let selectedRegion = this.value;
      const selectedCategory = document.getElementById('priceCategorySelect').value;
	// Load appropriate markers for the selected region and category
    loadMarkersForRegionAndCategory(selectedRegion, selectedCategory);
    fetchMarkers(selectedRegion, selectedCategory);
      panToRegion(selectedRegion);
      console.log("Region button clicked. Resizing all markers.");
      const overlay = document.getElementById('overlayContainer');
    // Check if the overlayContainer exists
    if (!overlay) {
        console.error("Overlay container not found!");
        return;
    }
    // Log to confirm the visibility change
    console.log("Displaying overlay...");

    // Use requestAnimationFrame to force a repaint
    /*requestAnimationFrame(() => {
        overlay.style.display = 'grid';
        overlay.classList.add('show');
    });*/
    overlay.style.display = 'grid';
    overlay.style.width= '46%';
    overlay.style.height= '75%';
    overlay.classList.add('show');
// Ensure the active plane animation continues
    overlay.innerHTML = `
            <div class="spinner-container">
                <div class="spinner"></div>
                <p class="spinner-text">Starting the process...</p>
            </div>
        `;
        function hideSpinnerContainer() {
    const spinnerContainer = document.querySelector('.spinner-container');
    if (spinnerContainer) {
        spinnerContainer.style.display = 'none';  // Hide the spinner container
    }
  }
  const today = new Date();
const tomorrow = new Date();
tomorrow.setDate(today.getDate() + 1);
 // Get the first day of the current month
const monthlyStartDate = new Date(today.getFullYear(), today.getMonth(), 1);

// Get the end date three months from the current month
const monthlyEndDate = new Date(today.getFullYear(), today.getMonth() + 3, 0); // 0 gives the last day of the previous month
// Format the dates to YYYY-MM-DD
const monthlyStart = monthlyStartDate.toISOString().split('T')[0];  // First day of current month
const monthlyEnd = monthlyEndDate.toISOString().split('T')[0];  // Last day of the month 3 months from now
const priceMin = 100
    const priceMax = 1000
    let searchUrl = `https://www.airbnb.com/s/${selectedRegion}/homes?tab_id=home_tab&refinement_paths%5B%5D=%2Fhomes&adults=2&flexible_trip_lengths%5B%5D=one_week&monthly_start_date=${monthlyStart}&monthly_length=3&monthly_end_date=${monthlyEnd}&price_filter_input_type=0&channel=EXPLORE&date_picker_type=calendar&checkin=&checkout=&adults=&source=structured_search_input_header&search_type=unknown&price_filter_num_nights=1&drawer_open=true`;
    console.log('Generated searchUrl:', searchUrl);
    // Only add price_min and price_max if they have values
    /*if (priceMin && priceMin.trim() !== "") {
        searchUrl += `&price_min=${priceMin}`;
    }
    if (priceMax && priceMax.trim() !== "") {
        searchUrl += `&price_max=${priceMax}`;
    }*/
    // Fetch Airbnb posts and display them
    await fetchAirbnbPosts(searchUrl);
    // Function to fetch Airbnb posts from your backend and display them on the webpage
async function fetchAirbnbPosts(searchUrl) {

    try {
        // Update spinner text to indicate scraping started
        updateSpinnerText(`Were searching for the best hotel deals for you  Sit back, relax, and browse while we find your perfect stay! 
    Thank you for your patience!
    Powered by Expedia`);

        const response = await fetch(`https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/scrape-airbnb?searchUrl=${encodeURIComponent(searchUrl)}`, {
          headers: {
        'ngrok-skip-browser-warning': 'true',
    },
        });
        const data = await response.json();
         // Ensure that 'posts2' is an array before mapping
         const posts2 = Array.isArray(data.posts2) ? data.posts2 : [];

        console.log('Fetched posts:', data);

        // Update spinner text to indicate posts fetched
        updateSpinnerText("Displaying fetched listings...");
// Call populateOverlay to display posts
populateOverlay(posts2);

        // Display the posts on the webpage
       /* const container = document.getElementById('left-container');
        container.style.display = 'block';
        container.innerHTML = posts2.map(post => `
            <div class="post">
      	      <img src="${post.image}" alt="${post.title}" />
      	      <h3>${post.title}</h3>
	      <p>${post.subtitle}</p>
	      <p>Price: ${post.listing_price_details}</p>
	      <p>Rating: ${post.rating_out_of_5_stars}</p>
	      <a href="${post.link}" target="_blank" class="view-link">View Listing</a>
	    </div>
        `).join('');*/
        function extractPriceInfo(priceDetails) {
    // Example: "109 77 night 77 per night"
    const regex = /(\d+\s?[$])\s+night\s+(\d+\s?[$])/;
    const match = priceDetails.match(regex);

    if (match) {
        return {
            totalPrice: match[1],         // Total price (e.g., "109 ")
            pricePerNight: match[2]      // Price per night (e.g., "77 ")
        };
    } else {
        console.warn('Price details format not recognized:', priceDetails);
        return { totalPrice: 'N/A', pricePerNight: 'N/A' };
    }
}

function populateOverlay(posts2) {
    const overlay = document.getElementById('overlayContainer');
    overlay.innerHTML = ''; // Clear previous posts

    posts2.forEach((post, index) => {
        const postDiv = document.createElement('div');
        postDiv.classList.add('post');

        // Add image
        const img = document.createElement('img');
        img.src = post.images || ''; // Use default image if not provided
        img.alt = post.title || 'Airbnb Listing';

        // Add title
        const title = document.createElement('h3');
        title.textContent = post.title || 'No title available';

        // Add subtitle
        const subtitle = document.createElement('p');
        subtitle.textContent = post.subtitle || 'No subtitle available';

        // Extract and separate price details
        const priceDetails = document.createElement('p');
        priceDetails.textContent = `Price: ${post.listing_price_details} per night`|| 'N/A';
        //const priceInfo = extractPriceInfo(priceDetails);

        // Add total price
        //const price = document.createElement('p');
        //price.textContent = `Total Price: ${priceInfo.totalPrice || 'N/A'}`;

        // Add price per night
        //const pricePerNight = document.createElement('p');
        //pricePerNight.textContent = `Price per Night: ${priceInfo.pricePerNight || 'N/A'}`;

        // Add rating
        const rating = document.createElement('p');
        rating.textContent = `Rating: ${post.rating_out_of_5_stars} stars`|| 'N/A';

        // Add "View Listing" link
        const viewLink = document.createElement('a');
        viewLink.href = post.link || '#';
        viewLink.target = '_blank';
        viewLink.textContent = 'View Listing';
        viewLink.classList.add('view-link');

        // Add Like button
        const likeButton = document.createElement('button');
        likeButton.textContent = ' Like';
        likeButton.classList.add('like-button');
        likeButton.addEventListener('click', () => saveToLikes(post));

        // Append elements to the postDiv
        postDiv.appendChild(img);
        postDiv.appendChild(title);
        postDiv.appendChild(subtitle);
        postDiv.appendChild(priceDetails);
        postDiv.appendChild(rating);
        postDiv.appendChild(viewLink);
        postDiv.appendChild(likeButton);

        // Append the postDiv to the overlay
        overlay.appendChild(postDiv);
        // Map post to marker events
        postDiv.addEventListener('mouseover', () => {
            if (markers[index]) {
                markers[index].material.color.set(0x00aaff);
            }
        });

        postDiv.addEventListener('mouseout', () => {
            if (markers[index]) {
                markers[index].material.color.set(0x00ff00);
            } });
    });
}


      } catch (error) {
        console.error('Error fetching posts:', error);
        // Update spinner text to indicate an error occurred
        updateSpinnerText("Error fetching Airbnb listings. Please try again.");
    }
}

/*function saveToLikes(post) {
    const user = firebase.auth().currentUser;

    if (!user) {
        alert('Please log in to like a post.');
        return;
    }

    const db = getFirestore();
    const userLikesRef = doc(db, `likes/${user.uid}/${post.id}`);

    setDoc(userLikesRef, post)
        .then(() => {
            alert('Post added to your likes!');
        })
        .catch(error => {
            console.error('Error saving liked post:', error);
        });
}

function showLikedPosts() {
    const user = firebase.auth().currentUser;

    if (!user) {
        alert('Please log in to view your liked posts.');
        return;
    }

    const db = getFirestore();
    const userLikesRef = collection(db, `likes/${user.uid}`);

    getDocs(userLikesRef)
        .then(snapshot => {
            const likedPosts = snapshot.docs.map(doc => doc.data());
            if (likedPosts.length > 0) {
              const overlay = document.getElementById('overlayContainer');
              overlay.innerHTML = ''; // Clear previous posts
                populateOverlay(likedPosts); // Display the liked posts
            } else {
                alert('No liked posts found.');
            }
        })
        .catch(error => {
            console.error('Error retrieving liked posts:', error);
        });
}





// Add an event listener to the profile button to show liked posts
document.getElementById('likedPostsButton').addEventListener('click', showLikedPosts);
*/

/*function saveToLikes(post) {
    const user = auth.currentUser;

    if (!user) {
        alert("Please log in to like a post.");
        return;
    }

    // Create a Firestore document reference for the user's liked post
    const userLikesRef = doc(db, `likes/${user.uid}/posts/${post.id}`);

    // Save the post data in Firestore
    setDoc(userLikesRef, post)
        .then(() => {
            alert("Post added to your likes!");
        })
        .catch((error) => {
            console.error("Error saving liked post:", error);
        });
}
function showLikedPosts() {
    const user = auth.currentUser;

    if (!user) {
        alert("Please log in to view your liked posts.");
        return;
    }

    // Reference the user's liked posts collection
    const userLikesRef = collection(db, `likes/${user.uid}/posts`);

    // Retrieve all documents in the user's liked posts collection
    getDocs(userLikesRef)
        .then((snapshot) => {
            const likedPosts = snapshot.docs.map((doc) => doc.data());

            if (likedPosts.length > 0) {
                const overlay = document.getElementById("overlayContainer");
                const overlay2 = document.getElementById("overlayContainer2");

                overlay.innerHTML = ""; // Clear previous posts
                overlay2.innerHTML = ""; // Clear previous posts
                //overlay2.style.display = "none";

                populateOverlay(likedPosts); // Display the liked posts
            } else {
                alert("No liked posts found.");
            }
        })
        .catch((error) => {
            console.error("Error retrieving liked posts:", error);
        });
}*/
function saveToLikes(post) {
    const user = auth.currentUser;

    if (!user) {
        alert("Please log in to like a post.");
        return;
    }

    // Ensure post has a unique ID
    const postId = post.id || `post_${Date.now()}`;

    // Create a Firestore document reference for the user's liked post
    const userLikesRef = doc(db, `likes/${user.uid}/posts/${postId}`);

    // Save the post data in Firestore
    setDoc(userLikesRef, { ...post, id: postId }) // Add the generated ID to the post
        .then(() => {
            alert("Post added to your likes!");
        })
        .catch((error) => {
            console.error("Error saving liked post:", error);
        });
}
function showLikedPosts() {
    const user = auth.currentUser;

    if (!user) {
        alert("Please log in to view your liked posts.");
        return;
    }

    // Reference the user's liked posts collection
    const userLikesRef = collection(db, `likes/${user.uid}/posts`);

    // Retrieve all documents in the user's liked posts collection
    getDocs(userLikesRef)
        .then((snapshot) => {
            const likedPosts = snapshot.docs.map((doc) => doc.data());

            if (likedPosts.length > 0) {
                const overlay = document.getElementById("overlayContainer");
                overlay.innerHTML = ""; // Clear previous posts
                populatelikedpostsOverlay(likedPosts); // Display the liked posts
            } else {
                alert("No liked posts found.");
            }
        })
        .catch((error) => {
            console.error("Error retrieving liked posts:", error);
        });
}

document.getElementById("likedPostsButton").addEventListener("click", showLikedPosts);

document.querySelectorAll('.post .view-link').forEach((item, index) => {
    // Make sure `index` matches the corresponding marker
    item.addEventListener('mouseover', function() {
        if (markers[index]) {  // Check if the marker exists
            markers[index].material.color.set(0x00aaff);  // Highlight the marker in green
        }
    });
    
    item.addEventListener('mouseout', function() {
        if (markers[index]) {
            markers[index].material.color.set(0x00ff00);  // Reset the color when mouse leaves (default color)
        }
    });

    item.addEventListener('click', function() {
        if (markers[index]) {
            markers[index].material.color.set(0x87CEFA);  // Set the marker color to red on click
        }
    });
});
  // Iterate through all regions in the genericMarkers object
  Object.keys(genericMarkers).forEach(region => {
    const markers = genericMarkers[region];
    if (markers) {
        const originalMarkerSize = 0.5; // Assume original size was 0.5
        const targetMarkerSize = 0.5; // Target size (smaller)

        for (let i = 0; i < markers.count; i++) {
            const instanceMatrix = new THREE.Matrix4();
            markers.getMatrixAt(i, instanceMatrix);

            // Create marker mesh with initial size
            const markerMesh = new THREE.Mesh(new THREE.PlaneGeometry(originalMarkerSize, originalMarkerSize), markerMaterial);
            markerMesh.applyMatrix4(instanceMatrix);
            scene.add(markerMesh); // Add marker to scene

            // Animation variables
            let currentSize = originalMarkerSize;

            // Function to animate the resizing of markers
            const animateResize = () => {
                currentSize = THREE.MathUtils.lerp(currentSize, targetMarkerSize, 0.1); // Smoothly interpolate size
                markerMesh.geometry.dispose(); // Dispose of old geometry
                markerMesh.geometry = new THREE.PlaneGeometry(currentSize, currentSize); // Update geometry

                if (Math.abs(currentSize - targetMarkerSize) > 0.01) {
                    requestAnimationFrame(animateResize); // Continue animation until target size is reached
                } else {
                    // Ensure final size is set
                    markerMesh.geometry.dispose();
                    markerMesh.geometry = new THREE.PlaneGeometry(targetMarkerSize, targetMarkerSize);
                }
            };

            animateResize(); // Start the animation
        }

        // Remove old markers from the scene once resizing begins
        scene.remove(markers);
        genericMarkers[region] = markers; // Update the genericMarkers object with resized markers
    } else {
        console.warn(`No markers found for the region: ${region}`);
    }
}); });
	  // Load markers based on region and price category
// Load markers based on region and price category
async function loadMarkersForRegionAndCategory(region, category) {
    try {
        // Display loading spinner or status
        updateSpinnerText("Fetching listings for " + region + "...");

        // Fetch the listings data from your backend based on region and category
        const response = await fetch(`https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/get-markers?region=${region}&category=${category}`, {
  method: 'GET',
  credentials: 'include',  // If you need cookies or credentials
  headers: {
        'ngrok-skip-browser-warning': 'true',
    },
    });
        const markersData = await response.json();  // Assuming the backend returns a JSON array of markers
        console.log(`Fetching markers from: ${url}`);
	    console.log(`Fetching markers from: https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/get-markers?region=${region}&category=${category}`);

        // Clear the existing markers before adding new ones
        clearExistingMarkers();
        
        // Add the new markers to the scene
        markersData.forEach(marker => {
            console.log('Creating marker:', marker);
	    let markerObject = createMarker(marker);
	    console.log('Marker Object:', markerObject);
	    scene.add(markerObject);

        });

        // Update spinner text once loading is complete
        updateSpinnerText("Listings loaded for " + region);
	    console.log(`Fetching markers from: https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/get-markers?region=${region}&category=${category}`);


    } catch (error) {
        console.error("Error fetching listings:", error);
        updateSpinnerText("Error loading listings for " + region);
    }
}
async function fetchMarkers(region, category) {
  try {
    const response = await fetch(`https://4c88-2a02-c7c-3945-5100-148a-5d45-7868-fb3d.ngrok-free.app/get-markers?region=${region}&category=${category}`, {
      headers: {
        'ngrok-skip-browser-warning': 'true',
    },
    });
    const markers = await response.json();
     // Clear the existing markers before adding new ones
     clearExistingMarkers();
    //addMarkersToGlobe(markers);  // Call the function to add markers
  } catch (error) {
    console.error("Failed to fetch markers:", error);
  }
}
// Function to add markers to the globe
// Function to add markers to the globe
function addMarkersToGlobe(markers) {
  markers.forEach(marker => {
    // Extract latitude and longitude
    let { lat, lng } = marker;

    // Apply offsets for shifting down and left
    const latOffset = -10; // Adjust this value for downward movement
    const lngOffset = -21; // Adjust this value for leftward movement
    lat += latOffset;
    lng += lngOffset;

    // Optional: Add random offset for slight spread of markers
    const randomOffsetFactor = 7; // Adjust for more/less spread
    lat += (Math.random() - 0.5) * randomOffsetFactor;
    lng += (Math.random() - 0.5) * randomOffsetFactor;

    // Log the adjusted values for debugging
    console.log(`Adjusted Marker Position: lat=${lat}, lng=${lng}`);

    // Convert lat/lng to 3D vector
    const markerVector = latLngToVector3(lat, lng, earthRadius);

    // Create the marker mesh
    const markerMesh = createMarkerMesh();

    // Set the marker position based on the 3D vector
    markerMesh.position.set(markerVector.x, markerVector.y, markerVector.z);

    // Ensure the marker faces outward from the globe
    markerMesh.lookAt(new THREE.Vector3(0, 0, 0));

    // Add the marker to the scene
    scene.add(markerMesh);
  });
}
// Function to create marker mesh for the globe
function createMarkerMesh(lat, lng) {
  const markerGeometry = new THREE.PlaneGeometry(0.2, 0.2);
  const markerMaterial =  new THREE.MeshBasicMaterial({
    color: 0x00ff00,
    side: THREE.DoubleSide,
    onBeforeCompile: (shader) => {
      shader.uniforms.time = globalUniforms.time;
      shader.vertexShader = `
      	attribute float phase;
        varying float vPhase;
        ${shader.vertexShader}
      `.replace(
        `#include <begin_vertex>`,
        `#include <begin_vertex>
        	vPhase = phase; // de-synch of ripples
        `
      );
      shader.fragmentShader = `
      	uniform float time;
        varying float vPhase;
      	${shader.fragmentShader}
      `.replace(
        `vec4 diffuseColor = vec4( diffuse, opacity );`,
        `
        vec2 lUv = (vUv - 0.5) * 2.;
        float val = 0.;
        float lenUv = length(lUv);
        val = max(val, 1. - step(0.25, lenUv)); // central circle
        val = max(val, step(0.4, lenUv) - step(0.5, lenUv)); // outer circle

        float tShift = fract(time * 0.5 + vPhase);
        val = max(val, step(0.4 + (tShift * 0.6), lenUv) - step(0.5 + (tShift * 0.5), lenUv)); // ripple

        if (val < 0.5) discard;

        vec4 diffuseColor = vec4( diffuse, opacity );`
      );
    },
  });
  markerMaterial.defines = { USE_UV: '' };

  const markerMesh = new THREE.Mesh(markerGeometry, markerMaterial);

  // Convert lat/lng to 3D coordinates on the globe
  const phi = (90 - lat) * (Math.PI / 180);
  const theta = (lng + 180) * (Math.PI / 180);

  const x = -(earthRadius * Math.sin(phi) * Math.cos(theta));
  const y = earthRadius * Math.cos(phi);
  const z = earthRadius * Math.sin(phi) * Math.sin(theta);

  markerMesh.position.set(x, y, z);
  // Ensure the marker faces outward from the globe by making it look at the globe's center
  markerMesh.lookAt(new THREE.Vector3(0, 0, 0));

  return markerMesh;
}

	  // Clear the existing markers and add new ones based on the category
    clearExistingMarkers();
    markersData.forEach(markers => {
       scene.add(markers);
    });
};
});
// Function to adjust marker sizes dynamically based on zoom level

// Function to update marker sizes dynamically as zoomLevel changes


// Example: Listening to zoom level changes and updating marker sizes
let zoomLevel = 1; // Default zoom level

// Simulate zoom level change (replace with actual zoom level logic)
//setInterval(() => {
    //zoomLevel = Math.random() * 3 + 1; // Random zoom level between 1 and 4
    //console.log(`Updating markers for zoomLevel: ${zoomLevel}`);
    //updateMarkerSizesWithZoom(zoomLevel);
//}, 2000); // Adjust every 2 seconds

function getMarkersDataForPopularListings(region) {
    // Example logic: Fetch the popular listings for the specified region
    return [
        { lat: 51.5074, lon: -0.1278, name: 'London Popular Listing', price: '120/night' },
        // Add more markers...
    ];
}

function getMarkersDataForCheapestListings(region) {
    // Example logic: Fetch the cheapest listings for the specified region
    return [
        { lat: 48.8566, lon: 2.3522, name: 'Paris Cheapest Listing', price: '50/night' },
        // Add more markers...
    ];
}
	  function getMarkersDataForMidPriceListings(region) {
    // Example logic: Fetch the cheapest listings for the specified region
    return [
        { lat: 48.8566, lon: 2.3522, name: 'Paris Cheapest Listing', price: '50/night' },
        // Add more markers...
    ];
}
	  function getMarkersDataForExpensiveListings(region) {
    // Example logic: Fetch the cheapest listings for the specified region
    return [
        { lat: 48.8566, lon: 2.3522, name: 'Paris Cheapest Listing', price: '50/night' },
        // Add more markers...
    ];
}
  
// Declare the position variable
let position;
//let zoomLevel;
// Pan to region based on dropdown selection
// Pan to region based on dropdown selection
// Pan to region based on dropdown selection
function panToRegion(region) {
  console.log(`Selected region: ${region}`);  // Debug

  switch (region) {
    case 'africa':
      // Adjusted x value to pan the camera more to the right
      position = { x: 16.0, y: 0, z: 1.74 }; 
      zoomLevel = 1.5;
      //zoomLevel = 2.5987766446450165;
      break;
      
    case 'europe': 
      position = { x: 4.0, y: 2.91, z: 0.55 }; 
      zoomLevel = 1.5;
      //zoomLevel = 3.352075053253554;
      break;
      
    case 'america': 
      position = { x: 0, y: 2.55, z: 4.42 }; 
      //zoomLevel = 2.0;
      zoomLevel = 1.5; 
      break;
      
    case 'south america': 
      position = { x: 1.5, y: -0.5, z: 4.3 }; 
      //zoomLevel = 1.7;
      zoomLevel = 1.5;
      break;
      
    case 'carribbean': 
      position = { x: 0.65, y: 2.0, z: 4.6 }; 
      //zoomLevel = 2.4;
      zoomLevel = 2.25;
      break;
      
    case 'asia': 
      position = { x: -0.89, y: 3.28, z: -3.92 }; 
      //zoomLevel = 1.9;
      zoomLevel = 1.5;
      break;
      
    case 'world': 
      position = { x: 16.0, y: 0, z: 1.74 }; 
      zoomLevel = 1.4;
      //zoomLevel = 10.101116854411483;
      break;
    default: return;
  }
  // Ensure zoomLevel is properly set
  if (typeof zoomLevel === 'undefined') {
    console.error('Zoom level is undefined');
    return;
  }
  // Set the zoom limits with a broader range
  controls.minDistance = 15; // Allow zooming slightly closer
  controls.maxDistance = 28; // Allow zooming slightly farther

  // Adjust the target zoom level to avoid aggressive zoom-in
  controls.targetZoomLevel = zoomLevel;
  // Initial pan based on default zoom level
  executePan(position, zoomLevel);
}
// Function to handle the pan and zoom
function executePan(position, zoomLevel) {
  stopAllTweens(); // Stop any existing animations
  controls.autoRotate = true; // Stop auto-rotation
  console.log(`Panning to x:${position.x}, y:${position.y}, z:${position.z}, zoom:${zoomLevel}`);  // Debug

  // Call to animate camera pan with smoother transitions
  animateCameraPan(position.x, position.y, position.z, zoomLevel);
}


function animateCameraPan(x, y, z, zoomLevel) {
  const currentZoom = camera.zoom;
  const zoomDelta = zoomLevel - currentZoom;
  const targetPosition = { x, y, z };
  const currentPosition = { x: camera.position.x, y: camera.position.y, z: camera.position.z };

  // Smooth camera panning
  new TWEEN.Tween(currentPosition)
    .to(targetPosition, 3000)  // Smooth panning over 3 seconds
    .easing(TWEEN.Easing.Quadratic.InOut)
    .onUpdate(() => {
      camera.position.set(currentPosition.x, currentPosition.y, currentPosition.z);
      camera.lookAt(0, 0, 0);  // Keep the globe centered
    })
    .start();

  // Smooth camera zooming
  new TWEEN.Tween({ zoom: currentZoom })
    .to({ zoom: zoomLevel }, 3000)  // Smooth zoom over 3 seconds
    .easing(TWEEN.Easing.Quadratic.InOut)
    .onUpdate(function (tween) {
      camera.zoom = tween.zoom;
      camera.updateProjectionMatrix(); // Update the camera projection matrix
    })
    .onComplete(function () {
      // Restart slow auto-rotation after panning and zooming
      setTimeout(function () {
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.25; // Slow rotation speed
      }, 500);
    })
    .start();
}


console.log('Globe:', globe2);
console.log('Camera:', camera);

  // custom globe material
  const globeMaterial = globe.material;
  material.bumpScale = 10;
  new THREE.TextureLoader().load(
    "//unpkg.com/three-globe/example/img/earth-water.png",
    (texture) => {
      globeMaterial.specularMap = texture;
      globeMaterial.specular = new THREE.Color("grey");
      globeMaterial.shininess = 15;
    }
  );

  /*setTimeout(() => {
    // wait for scene to be populated (asynchronously)
    var dl = new THREE.DirectionalLight(0xffffff, 1);
    dl.position.set(1, 1, 1);
    //scene.add(dl); // change light position to see the specularMap's effect
  });
  // White directional light at half intensity shining from the top.
  const directionalLight = new THREE.DirectionalLight(0x909090, 1);
  directionalLight.position.set(-1, -1, -1);
  scene.add(directionalLight);
  var dl2 = new THREE.DirectionalLight(0xffffff, 1);
  dl2.position.set(0, 1, 1);
  //scene.add(dl2); // change light position to see the specularMap's effect
  var dl3 = new THREE.DirectionalLight(0xffffff, 1);
  dl3.position.set(3, 2, 1);
  //scene.add(dl3);
  const light2 = new THREE.AmbientLight(0x808080); // soft white light
  scene.add(light2);

  var light = new THREE.DirectionalLight(0xf0f0f0, 1);
  light.position.set(5, 3, 5);
  scene.add(light);*/
	  
// Create directional light and reduce its intensity
	  setTimeout(() => {
var dl = new THREE.DirectionalLight(0xffffff, 0.3); // Reduced intensity
dl.position.set(1, 1, 1);
//scene.add(dl); // Add the light to the scene
	  });
// White directional light at half intensity shining from the top, with reduced intensity
const directionalLight = new THREE.DirectionalLight(0x909090, 0.5); // Reduced intensity
directionalLight.position.set(-1, -1, -1);
scene.add(directionalLight);

var dl2 = new THREE.DirectionalLight(0xffffff, 0.5); // Reduced intensity
dl2.position.set(0, 1, 1);
//scene.add(dl2);

var dl3 = new THREE.DirectionalLight(0xffffff, 0.5); // Reduced intensity
dl3.position.set(3, 2, 1);
//scene.add(dl3);

// Ambient light for soft lighting, unchanged
const light2 = new THREE.AmbientLight(0x808080); // soft white light
scene.add(light2);

var light = new THREE.DirectionalLight(0xf0f0f0, 0.5); // Reduced intensity
light.position.set(5, 3, 5);
scene.add(light);

// Update intensity for directional lights dynamically if needed
directionalLight.intensity = 0.5;
dl2.intensity = 0.5;
dl3.intensity = 0.5;
    // Markers Data
  const markersData2 = [
    {
      //Africa
      id: 1,
      position: [5.1, 1.2, 1.5],
      iframeSrc: "https://rss.app/embed/v1/list/hKdSIKMe0o5AmG18",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"false"
    },
    // ... Add other markers here
    {
      //Europe
      id: 2,
      position: [5.1, 0.7, 1.8],
      iframeSrc: "https://rss.app/embed/v1/list/sum7m4TJWVJk8HMN",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //America
      id: 3,
      position: [5.1, 0.9, 0],
      iframeSrc: "https://rss.app/embed/v1/list/chAYVOo3llbQzNLo",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //South America
      id: 4,
      position: [5.1, 1.6, 0.4],
      iframeSrc: "https://rss.app/embed/v1/list/DP9kzxo2dohbbgST",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Middle East
      id: 5,
      position: [5.1, 1, 2.3],
      iframeSrc: "https://rss.app/embed/v1/list/JCYAnBzooyfhbDvO",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Asia
      id: 6,
      position: [5.1, 0.9, 3],
      iframeSrc: "https://rss.app/embed/v1/list/pUeauCbzsXuVe3eC",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Japan
      id: 7,
      position: [5.1, 0.9, 4],
      iframeSrc: "https://rss.app/embed/v1/list/d6hKxeycgIlya2NK",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      // Jamaica
      id: 8,
      position: [5.1, 1.2, 0.2],
      iframeSrc: "https://rss.app/embed/v1/list/qvlJz8EBa0yKiH2i",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //UK
      id: 9,
      position: [5.1, 0.6, 1.45],
      iframeSrc: "https://rss.app/embed/v1/list/VQIhB1FM0tC17q5Y",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
  ];
  const markersDataforCheapestAirbnbs = [
    {
      //Africa
      id: 1,
      position: [5.1, 1.2, 1.5],
      iframeSrc: "https://rss.app/embed/v1/list/hKdSIKMe0o5AmG18",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"false"
    },
    // ... Add other markers here
    {
      //Europe
      id: 2,
      position: [5.1, 0.7, 1.8],
      iframeSrc: "https://rss.app/embed/v1/list/sum7m4TJWVJk8HMN",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //America
      id: 3,
      position: [5.1, 0.9, 0],
      iframeSrc: "https://rss.app/embed/v1/list/chAYVOo3llbQzNLo",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //South America
      id: 4,
      position: [5.1, 1.6, 0.4],
      iframeSrc: "https://rss.app/embed/v1/list/DP9kzxo2dohbbgST",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Middle East
      id: 5,
      position: [5.1, 1, 2.3],
      iframeSrc: "https://rss.app/embed/v1/list/JCYAnBzooyfhbDvO",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Asia
      id: 6,
      position: [5.1, 0.9, 3],
      iframeSrc: "https://rss.app/embed/v1/list/pUeauCbzsXuVe3eC",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Japan
      id: 7,
      position: [5.1, 0.9, 4],
      iframeSrc: "https://rss.app/embed/v1/list/d6hKxeycgIlya2NK",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      // Jamaica
      id: 8,
      position: [5.1, 1.2, 0.2],
      iframeSrc: "https://rss.app/embed/v1/list/qvlJz8EBa0yKiH2i",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //UK
      id: 9,
      position: [5.1, 0.6, 1.45],
      iframeSrc: "https://rss.app/embed/v1/list/VQIhB1FM0tC17q5Y",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
  ];
	  const markersDataforMidPriceAirbnbs = [
    {
      //Africa
      id: 1,
      position: [5.1, 1.2, 1.5],
      iframeSrc: "https://rss.app/embed/v1/list/hKdSIKMe0o5AmG18",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"false"
    },
    // ... Add other markers here
    {
      //Europe
      id: 2,
      position: [5.1, 0.7, 1.8],
      iframeSrc: "https://rss.app/embed/v1/list/sum7m4TJWVJk8HMN",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //America
      id: 3,
      position: [5.1, 0.9, 0],
      iframeSrc: "https://rss.app/embed/v1/list/chAYVOo3llbQzNLo",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //South America
      id: 4,
      position: [5.1, 1.6, 0.4],
      iframeSrc: "https://rss.app/embed/v1/list/DP9kzxo2dohbbgST",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Middle East
      id: 5,
      position: [5.1, 1, 2.3],
      iframeSrc: "https://rss.app/embed/v1/list/JCYAnBzooyfhbDvO",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Asia
      id: 6,
      position: [5.1, 0.9, 3],
      iframeSrc: "https://rss.app/embed/v1/list/pUeauCbzsXuVe3eC",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Japan
      id: 7,
      position: [5.1, 0.9, 4],
      iframeSrc: "https://rss.app/embed/v1/list/d6hKxeycgIlya2NK",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      // Jamaica
      id: 8,
      position: [5.1, 1.2, 0.2],
      iframeSrc: "https://rss.app/embed/v1/list/qvlJz8EBa0yKiH2i",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //UK
      id: 9,
      position: [5.1, 0.6, 1.45],
      iframeSrc: "https://rss.app/embed/v1/list/VQIhB1FM0tC17q5Y",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
  ];
	  const markersDataforExpensiveAirbnbs = [
    {
      //Africa
      id: 1,
      position: [5.1, 1.2, 1.5],
      iframeSrc: "https://rss.app/embed/v1/list/hKdSIKMe0o5AmG18",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"false"
    },
    // ... Add other markers here
    {
      //Europe
      id: 2,
      position: [5.1, 0.7, 1.8],
      iframeSrc: "https://rss.app/embed/v1/list/sum7m4TJWVJk8HMN",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //America
      id: 3,
      position: [5.1, 0.9, 0],
      iframeSrc: "https://rss.app/embed/v1/list/chAYVOo3llbQzNLo",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //South America
      id: 4,
      position: [5.1, 1.6, 0.4],
      iframeSrc: "https://rss.app/embed/v1/list/DP9kzxo2dohbbgST",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Middle East
      id: 5,
      position: [5.1, 1, 2.3],
      iframeSrc: "https://rss.app/embed/v1/list/JCYAnBzooyfhbDvO",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Asia
      id: 6,
      position: [5.1, 0.9, 3],
      iframeSrc: "https://rss.app/embed/v1/list/pUeauCbzsXuVe3eC",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //Japan
      id: 7,
      position: [5.1, 0.9, 4],
      iframeSrc: "https://rss.app/embed/v1/list/d6hKxeycgIlya2NK",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      // Jamaica
      id: 8,
      position: [5.1, 1.2, 0.2],
      iframeSrc: "https://rss.app/embed/v1/list/qvlJz8EBa0yKiH2i",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
    {
      //UK
      id: 9,
      position: [5.1, 0.6, 1.45],
      iframeSrc: "https://rss.app/embed/v1/list/VQIhB1FM0tC17q5Y",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"eager",
      width:"275",
      height:"300",
      scrolling:"yes",
      allowfullscreen:"true"
    },
  ];
  // Marker Geometry and Material
  //const markerGeometry = new THREE.PlaneGeometry();
   /*const markerGeometry = new THREE.PlaneGeometry(5, 5); // Increase size for mobile
if (window.innerWidth <= 768) {
  markerGeometry.scale(1.25, 1.25, 1.25); // Scale markers for mobile
}*/


  
  // Creating Markers
  //const markerCount = markersData2.length;
  //const markers = new THREE.InstancedMesh(markerGeometry, markerMaterial2, markerCount);
  
  //const dummy = new THREE.Object3D();
  //const phaseArray = [];
  
  /*markersData2.forEach((data, index) => {
    //const [radius, phi, theta] = data.position;
    dummy.position.setFromSphericalCoords(radius, phi, theta);
    dummy.lookAt(dummy.position.clone().setLength(radius + 1));
    dummy.updateMatrix();
    markers.setMatrixAt(index, dummy.matrix);
    phaseArray.push(Math.random());
    data.worldPosition = dummy.position.clone();
  });
  
  markerGeometry.setAttribute('phase', new THREE.InstancedBufferAttribute(new Float32Array(phaseArray), 1));
  //scene.add(markers);*/
    // Labels Container
  const labelsContainer = document.getElementById('labels-container');
  let mouseActivityTimeout; // Timeout to resume autorotation after user interaction
  // Mouse Activity Event Listeners
function stopAutoRotateOnUserInteraction() {
    controls.autoRotate = false;

    // Clear any existing timeout
    clearTimeout(mouseActivityTimeout);

    // Resume autorotation after 5 seconds of inactivity (adjust as needed)
    mouseActivityTimeout = setTimeout(() => {
            controls.autoRotate = true;
    }, 2000); // 5 seconds of no mouse activity
}

// Stop autorotate on user interaction (mouse and touch)
//window.addEventListener('mousemove', stopAutoRotateOnUserInteraction);
window.addEventListener('mousedown', stopAutoRotateOnUserInteraction);
//window.addEventListener('mouseup', stopAutoRotateOnUserInteraction);
window.addEventListener('touchstart', stopAutoRotateOnUserInteraction);
window.addEventListener('touchend', stopAutoRotateOnUserInteraction);
  // Create Labels
markersData.forEach((data) => {
  // Create Label Div
  const labelDiv = document.createElement('div');
  labelDiv.className = 'marker-label';
  labelDiv.id = `label-${data.id}`;
// Set the z-index
labelDiv.style.zIndex = '22009'; // Adjust the value as needed
  // Close Button
  const closeButton = document.createElement('button');
  closeButton.className = 'close-button';
  closeButton.innerText = '';
  labelDiv.appendChild(closeButton);
  
  // Close Button Event Listener
  closeButton.addEventListener('click', (event) => {
    console.log('Close button clicked'); // Check if this appears in the console
    event.stopPropagation(); // Stop the event from propagating up the DOM
    labelDiv.classList.remove('active');
    
    // Resume globe autorotation when the label is closed
    controls.autoRotate = true;
    
    // Re-enable the OrbitControls
    controls.enabled = true;
  });

  // Content Div
  const contentDiv = document.createElement('div');
  contentDiv.className = 'content';
  labelDiv.appendChild(contentDiv);
// Set the z-index
contentDiv.style.zIndex = '22009'; // Adjust the value as needed
  // Append to Labels Container
  labelsContainer.appendChild(labelDiv);

  // CSS2DObject
  const labelObject = new CSS2DObject(labelDiv);
  labelObject.position.copy(data.worldPosition);
  scene.add(labelObject);

  // Store label object for interaction
  data.labelObject = labelObject;
  labelDiv.addEventListener('mousedown', (event) => {
    event.stopPropagation();
  });
  labelDiv.addEventListener('touchstart', (event) => {
    event.stopPropagation();
  });
});

// Raycaster for Interaction
const raycaster = new THREE.Raycaster();
const pointer = new THREE.Vector2();
	  
/*let activeLabel = null; // Keep track of the currently open iframe
	  
window.addEventListener('pointerdown', (event) => {
  pointer.x = (event.clientX / innerWidth) * 2 - 1;
  pointer.y = -(event.clientY / innerHeight) * 2 + 1;
  raycaster.setFromCamera(pointer, camera);

  const intersects = raycaster.intersectObject(markers).filter((m) => {
    return m.uv.subScalar(0.5).length() * 2 < 0.25;
  });

  if (intersects.length > 0) {
    const instanceId = intersects[0].instanceId;
    const data = markersData[instanceId];
	  
	  // Update Label Content
    const labelDiv = document.getElementById(`label-${data.id}`);
    const contentDiv = labelDiv.querySelector('.content');
	  
	  // Check if the iframe is related to the marker (specific iframe)
    if (!contentDiv.querySelector('iframe')) {
	  // Add loading spinner inside the content div
    contentDiv.innerHTML = `
    <div class="loading-spinner" style="pointer-events:none;"></div>
    <iframe src="${data.iframeSrc}" frameborder="0" width="275" height="249" scrolling="no" allowfullscreen="true" sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox" loading="eager"></iframe>
    `;

    const iframe = labelDiv.querySelector('iframe');
    const spinner = contentDiv.querySelector('.loading-spinner');
	   
	    // Show Label
    labelDiv.classList.add('active');
	    
	    iframe.addEventListener('load', () => {
	console.log('Iframe loaded');
	    
	// Hide loading spinner when iframe finishes loading
      spinner.style.display = 'none';
      iframe.style.pointerEvents = 'all'; // Enable iframe interaction after loading
       iframe.contentWindow.addEventListener('blur', () => {
	console.log('Iframe lost focus');
        controls.enabled = true; // Re-enable the controls when iframe loses focus
      });
		    // Close any previously active label
      if (activeLabel && activeLabel !== labelDiv) {
        activeLabel.classList.remove('active');
      }
		    // Set the new active label
      activeLabel = labelDiv;
	    
    });
	  // Show loading spinner
    //const loadingIcon = document.getElementById('loadingIcon');
    //loadingIcon.style.display = 'block';
	  
    // Add a listener to detect when the iframe loses focus and re-enable the controls
    console.log(iframe); // Check if the iframe element is being correctly selected
    }
  } */
// Close iframe when clicking outside of it
	  
    // Close iframe when clicking outside of it
   /* document.addEventListener('click', function(event) {
  if (!labelDiv.contains(event.target)) {
    // Check if the label is already active, toggle it off
    if (labelDiv.classList.contains('active')) {
      labelDiv.classList.remove('active');
      controls.autoRotate = true;
      controls.enabled = true;
    } else {
      // Re-enable the iframe on click
      labelDiv.classList.add('active');
      controls.autoRotate = false;
      controls.enabled = false;
    }
  }
});
/*        document.addEventListener('pointerdown', function(event) {
          if (!labelDiv.contains(event.target)) {
          labelDiv.classList.remove('active');
          controls.autoRotate = true;
          controls.enabled = true;
          activeLabel = null; // No active label after close
        }
      });

	    // Stop the globe's autorotation and disable OrbitControls
    controls.autoRotate = false;
    controls.enabled = false; // Disable the controls while interacting with the iframe

  }
}
});*/
	  // Define different markers data sets
const markersDataSets = {
    general: markersData,
  cheapest: markersDataforCheapestAirbnbs,
  midPrice: markersDataforMidPriceAirbnbs,
  expensive: markersDataforExpensiveAirbnbs,
};

let activeMarkersData = markersData; // Default to markersData
let activeLabel = null; // Keep track of open iframe
//let markers; // Declare it outside, so it is accessible globally.

function loadMarkers(selectedCategory) {
  // Remove existing markers from the scene
  //scene.remove(markers);
	console.log('Selected category:', selectedCategory);
  console.log('Available categories:', markersDataSets);
  console.log('Markers Data Sets:', markersDataSets);
// Set active markers data
  activeMarkersData = markersDataSets[selectedCategory];
  if (!activeMarkersData) {
    console.error(`No markers data found for category: ${selectedCategory}`);
    activeMarkersData = []; // Set it to an empty array to prevent further errors
  }
  // Create new markers for the selected category
  //const markerCount = activeMarkersData.length;
  //const markers = new THREE.InstancedMesh(markerGeometry, markerMaterial, markerCount);
  //const dummy = new THREE.Object3D();
//const dummy = new THREE.Object3D();
  activeMarkersData.forEach((data, index) => {
    const [radius, phi, theta] = data.position;
    dummy.position.setFromSphericalCoords(radius, phi, theta);
    dummy.lookAt(dummy.position.clone().setLength(radius + 1));
    dummy.updateMatrix();
    markers.setMatrixAt(index, dummy.matrix);
    data.worldPosition = dummy.position.clone();
  });

  //scene.add(markers);

  // Add interactivity to the new markers
  setupMarkerInteraction();
}
	  
// Set up marker click event
function setupMarkerInteraction() {
  window.addEventListener('pointerdown', (event) => {
    pointer.x = (event.clientX / innerWidth) * 2 - 1;
    pointer.y = -(event.clientY / innerHeight) * 2 + 1;
    raycaster.setFromCamera(pointer, camera);

    const intersects = raycaster.intersectObject(markers).filter((m) => {
      return m.uv.subScalar(0.5).length() * 2 < 0.25;
    });

    if (intersects.length > 0) {
      const instanceId = intersects[0].instanceId;
      const data = activeMarkersData[instanceId];

      // Check if this label is already active and close it
      if (activeLabel && activeLabel === document.getElementById(`label-${data.id}`)) {
        closeIframe(event); // Close if clicking on the same active label
        return;
      }

      // Otherwise, proceed to open the clicked marker
      openMarkerLabel(data);
    }
  });
}

function openMarkerLabel(data) {
  const labelDiv = document.getElementById(`label-${data.id}`);
  const contentDiv = labelDiv.querySelector('.content');
// Wait until the element is created in the DOM
setTimeout(() => {
    const saudiIframe = document.querySelector(".iframe-saudi");
    if (saudiIframe) {
      saudiIframe.innerHTML = `
        <a href="https://www.tkqlhce.com/click-101312981-16949818" target="_top">
          The earlier you book, the more you save  up to 25% savings on stays
        </a>
        <img src="https://www.tqlkg.com/image-101312981-16949818" width="1" height="1" border="0"/>
      `;
    } else {
      console.error("The iframe-saudi element does not exist yet!");
    }
  }, 500); // Adjust the timeout as needed to ensure the DOM is updated

  if (!contentDiv.querySelector('iframe')) {
    // Inject the inner HTML content
    contentDiv.innerHTML = `
      <div class="loading-spinner" style="pointer-events:none;"></div>
      <iframe 
        src="${data.iframeSrc}" 
        frameborder="0" 
        width="275" 
        height="249" 
        scrolling="yes" 
        allowfullscreen="true" 
        sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox" 
        loading="eager">
      </iframe>
      <button id="toggleAirbnbPrices-${data.id}" style="
        font-size: 10px; 
        letter-spacing: 1px; 
        position: absolute; 
        top: 330px; 
        right: 85px; 
        background: none; 
        border: none; 
        color: rgba(255, 255, 255, 0.35); 
        cursor: pointer;
        display: none;">
          
      </button>
      <select id="priceCategorySelect-${data.id}" style=
      "display:none;"
      "top: 350px !important;"
      "right:30px !important;"
      >
        <optgroup label="Region-Specific Categories">
          <option value="disabled">Sort by (Region)</option>
          <option value="popular">Most Popular (in Region)</option>
          <option value="cheapest">Cheapest</option>
          <option value="midPrice">Mid Price</option>
          <option value="expensive">Expensive</option>
        </optgroup>
      </select>
      <select id="airbnbSelector-${data.id}" style=
      "display:none;"
      "top: 350px !important;"
      "right:30px !important;"
      >
        <optgroup label="World Categories">
          <option value="disabled">Sort by (Across the World) </option>
          <option value="general">Most Popular (Across the World)</option>
          <option value="cheapest">Cheapest</option>
          <option value="midPrice">Mid Price</option>
          <option value="expensive">Most Expensive</option>
        </optgroup>
      </select>
    `;
// Get references to the toggle button and dropdowns
const toggleButton = document.getElementById(`toggleAirbnbPrices-${data.id}`);
    const priceCategorySelect = document.getElementById(`priceCategorySelect-${data.id}`);
    const airbnbSelector = document.getElementById(`airbnbSelector-${data.id}`);

    // Add click event to toggle both dropdowns
    toggleButton.addEventListener('click', function (event) {
      event.stopPropagation(); // Prevent click propagation to the document

      // Toggle dropdown visibility
      const priceSelectVisible = priceCategorySelect.style.display === 'block';
      const airbnbSelectVisible = airbnbSelector.style.display === 'block';

      priceCategorySelect.style.display = priceSelectVisible ? 'none' : 'block';
      airbnbSelector.style.display = airbnbSelectVisible ? 'none' : 'block';
    });

    // Close both dropdowns when clicking outside
    document.addEventListener('click', function (event) {
      if (
        priceCategorySelect &&
        !priceCategorySelect.contains(event.target) &&
        event.target !== toggleButton
      ) {
        priceCategorySelect.style.display = 'none';
      }
      if (
        airbnbSelector &&
        !airbnbSelector.contains(event.target) &&
        event.target !== toggleButton
      ) {
        airbnbSelector.style.display = 'none';
      }
    });
    const iframe = labelDiv.querySelector('iframe');
    const spinner = contentDiv.querySelector('.loading-spinner');

    iframe.addEventListener('load', () => {
      spinner.style.display = 'none';
      iframe.style.pointerEvents = 'all';
    });
  }

  labelDiv.classList.add('active');
  controls.autoRotate = false;
  controls.enabled = false;
  renderer.domElement.style.pointerEvents = 'none';

  // Close any previously active label
  if (activeLabel && activeLabel !== labelDiv) {
    activeLabel.classList.remove('active');
  }

  activeLabel = labelDiv;

  // Add global listener for closing
  document.addEventListener('pointerdown', closeIframe);
}

	// Function to close the active iframe if clicked outside
  function closeIframe(event) {
  if (activeLabel && !activeLabel.contains(event.target)) {
    activeLabel.classList.remove('active');
    controls.autoRotate = true;
    controls.enabled = true;
    renderer.domElement.style.pointerEvents = 'all'; // Re-enable interaction with the globe

    // Reset the active label, but keep it available for re-clicking
    activeLabel = null;
  }
}
	  // Add event listener for dropdown selection
document.getElementById('airbnbSelector').addEventListener('change', function() {
  const selectedCategory = this.value;
  loadMarkers(selectedCategory);
});

// Load markers for default category on page load
loadMarkers('general');

controls.minDistance = 15;
  controls.maxDistance = 30;
		    
	 /* let activeLabel = null; // Keep track of the currently open iframe

window.addEventListener('pointerdown', (event) => {
  pointer.x = (event.clientX / innerWidth) * 2 - 1;
  pointer.y = -(event.clientY / innerHeight) * 2 + 1;
  raycaster.setFromCamera(pointer, camera);

  const intersects = raycaster.intersectObject(markers).filter((m) => {
    return m.uv.subScalar(0.5).length() * 2 < 0.25;
  });

  if (intersects.length > 0) {
    const instanceId = intersects[0].instanceId;
    const data = markersData[instanceId];

    // Update Label Content
    const labelDiv = document.getElementById(`label-${data.id}`);
    const contentDiv = labelDiv.querySelector('.content');

    // Always update the content and attach the iframe, even if previously clicked
    contentDiv.innerHTML = `
      <div class="loading-spinner" style="pointer-events:none;"></div>
      <iframe src="${data.iframeSrc}" frameborder="0" width="275" height="249" scrolling="yes" allowfullscreen="true" sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox" loading="eager"></iframe>
    `;

    const iframe = labelDiv.querySelector('iframe');
    const spinner = contentDiv.querySelector('.loading-spinner');

    labelDiv.classList.add('active');
    controls.autoRotate = false;
    controls.enabled = false;

    // Disable pointer events on the globe while interacting with the iframe
    renderer.domElement.style.pointerEvents = 'none';

    iframe.addEventListener('load', () => {
      spinner.style.display = 'none';
      iframe.style.pointerEvents = 'all'; // Enable iframe interaction after loading

      // Close any previously active label
      if (activeLabel && activeLabel !== labelDiv) {
        activeLabel.classList.remove('active');
      }

      // Set the new active label
      activeLabel = labelDiv;
    });

    // Remove previous `pointerdown` listeners if any
    document.removeEventListener('pointerdown', closeIframe);

    // Add event listener to close iframe when clicking outside
    document.addEventListener('pointerdown', closeIframe);
  }
});

// Function to close the active iframe if clicked outside
function closeIframe(event) {
  if (activeLabel && !activeLabel.contains(event.target)) {
    activeLabel.classList.remove('active');
    controls.autoRotate = true;
    controls.enabled = true;
    renderer.domElement.style.pointerEvents = 'all'; // Re-enable interaction with the globe
    activeLabel = null; // Clear the active label
  }
}
}*/




	  // Loading spinner functionality
/*document.getElementById('labels-container').addEventListener('click', function() {
  const loadingIcon = document.getElementById('loadingIcon');
  
  // Show loading icon when iframe is clicked
  loadingIcon.style.display = 'block';
  
  // Hide the loading icon after a set timeout (3 seconds in this case)
  setTimeout(() => {
    loadingIcon.style.display = 'none';
  }, 3000); // Adjust time as needed
});*/



// Animation Loop
//const clock = new THREE.Clock();
// Animation loop that ensures the TWEEN library is updated
const clock = new THREE.Clock();
function animate() {
    requestAnimationFrame(animate);
    
    // Update tween animations
    TWEEN.update(); 
	
    // Update time uniform for any shaders if needed
    globalUniforms.time.value = clock.getElapsedTime();

    // Update controls
    if (controls.enabled) {
        controls.update();
    }

    // Render the scene
    renderer.render(scene, camera);
    labelRenderer.render(scene, camera); // If you're using labelRenderer
    if (waveMeshArr.length) {
      waveMeshArr.forEach((mesh) => {
    // Increment the scale value stored in userData
    mesh.userData['scale'] += 0.007;

    // Update the mesh's scale
    mesh.scale.set(
      mesh.userData['size'] * mesh.userData['scale'],
      mesh.userData['size'] * mesh.userData['scale'],
      mesh.userData['size'] * mesh.userData['scale']
    );

    // Adjust opacity based on scale
    if (mesh.userData['scale'] <= 1.5) {
      mesh.material.opacity = (mesh.userData['scale'] - 1) * 2; // Ensure opacity transitions from 0 to 1
    } else if (mesh.userData['scale'] > 1.5 && mesh.userData['scale'] <= 2) {
      mesh.material.opacity = 1 - (mesh.userData['scale'] - 1.5) * 2; // Ensure opacity transitions from 1 to 0
    } else {
      // Reset scale once it exceeds 2
      mesh.userData['scale'] = 1;
    }
  });
}

}
	  renderer.setSize(window.innerWidth, window.innerHeight);
window.addEventListener('resize', () => {
  renderer.setSize(window.innerWidth, window.innerHeight);
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
});


animate(); // Start the animation loop
/*function animate() {
  requestAnimationFrame(animate);
  TWEEN.update(); // Required to make the transition work
  // Update time uniform
  globalUniforms.time.value = clock.getElapsedTime();
	
  // Update controls
  if (controls.enabled) {
    controls.update();
  }

  // Render
  renderer.render(scene, camera);
  labelRenderer.render(scene, camera);
}

animate();*/

  </script>



<script>
  const overlayContainer = document.getElementById('overlayContainer');
  const dragHandle = overlayContainer.querySelector('.drag-handle');
  let isDragging = false;
  let startY;

  dragHandle.addEventListener('mousedown', (e) => {
    isDragging = true;
    startY = e.clientY;
    overlayContainer.style.transition = 'none'; // Disable transition during drag
    document.body.style.userSelect = 'none'; // Prevent text selection during drag
  });

  window.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    const dy = e.clientY - startY;
    startY = e.clientY;
    const newHeight = overlayContainer.offsetHeight - dy;
    overlayContainer.style.height = `${Math.max(40, Math.min(window.innerHeight - 100, newHeight))}px`;
  });

  window.addEventListener('mouseup', () => {
    isDragging = false;
    document.body.style.userSelect = ''; // Restore text selection
  });
</script>

</body>
</html>

